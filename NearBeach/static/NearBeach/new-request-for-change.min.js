"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[2854],{32:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});var s=a(641),l=a(33);const r={class:"card"},i={class:"card-body"},o={class:"row submit-row"},n={class:"col-md-12"},d=["disabled"];var u=a(1281),c=a(3751);const p={class:"row"},h={class:"col-md-4"},m={class:"form-group"},f={class:"col-md-4"},g={class:"form-group"},b={class:"row"},y={class:"col-md-4"},v={class:"form-group"},k={key:0,class:"error"};var L=a(1080),T=a(2190),M=a(2124),_=a(9639),C=a(3855),V=a(404);const R={name:"RfcDetails",setup:()=>({v$:(0,_.Ay)()}),components:{GroupPermissions:T.A,NSelect:L.A,ValidationRendering:V.A},emits:["update_values","update_validation"],props:{groupResults:{type:Array,default:()=>[]},userGroupPermissions:{type:Array,default:()=>[]}},data:()=>({displayGroupPermissionIssue:!1,groupModel:[],rfcChangeLeadFixList:[],rfcChangeLeadModel:"",rfcStatus:[{label:"Draft",value:1},{label:"Waiting for approval",value:2},{label:"Approved",value:3},{label:"Started",value:4},{label:"Finished",value:5},{label:"Rejected",value:6}],rfcType:[{label:"Emergency",value:4},{label:"High",value:3},{label:"Medium",value:2},{label:"Low",value:1}],rfcTypeModel:"",rfcVersionModel:"",searchTimeout:"",updatingLeadList:!1}),validations:{groupModel:{required:C.mw},rfcChangeLeadModel:{required:C.mw},rfcTypeModel:{required:C.mw},rfcVersionModel:{maxLength:(0,C.Ru)(25)}},computed:{...(0,M.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},methods:{getChangeLeadData(){if(this.updatingLeadList=!0,this.rfcChangeLeadModel="",0===this.groupModel.length)return this.rfcChangeLeadFixList=[],void(this.updatingLeadList=!1);const e=new FormData;this.groupModel.forEach((t=>{e.append("group_list",t)})),this.axios.post(`${this.rootUrl}object_data/lead_user_list/`,e).then((e=>{this.rfcChangeLeadFixList=[],e.data.forEach((e=>{const t={value:e.pk,label:`${e.fields.username} - ${e.fields.first_name} ${e.fields.last_name}`};this.rfcChangeLeadFixList.push(t)})),this.updatingLeadList=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Error getting change lead data",message:`Error getting change lead data. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},updateGroupModel(e){this.groupModel=e,this.displayGroupPermissionIssue=0===this.userGroupPermissions.filter((e=>{const t=this.groupModel.includes(e.group_id),a=e.object_permission_value>=3;return t&&a})).length,this.updateValues("groupModel",e),this.updateValidation(),this.getChangeLeadData()},updateValidation(){this.v$.$touch(),this.$emit("update_validation",{tab:"tab_1",value:!this.v$.$invalid&&!this.displayGroupPermissionIssue})},updateValues(e,t){this.$emit("update_values",{modelName:e,modelValue:t})}},watch:{rfcChangeLeadModel(){this.updateValues("rfcChangeLeadModel",this.rfcChangeLeadModel),this.updateValidation()},rfcStatus(){this.updateValues("rfcStatus",this.rfcStatus),this.updateValidation()},rfcType(){this.updateValues("rfcType",this.rfcType),this.updateValidation()},rfcTypeModel(){this.updateValues("rfcTypeModel",this.rfcTypeModel),this.updateValidation()},rfcVersionModel(){this.updateValues("rfcVersionModel",this.rfcVersionModel),this.updateValidation()}},mounted(){this.$nextTick((()=>{this.getChangeLeadData()})),this.v$.$touch()}};var S=a(6262);const $=(0,S.A)(R,[["render",function(e,t,a,l,r,i){const o=(0,s.g2)("validation-rendering"),n=(0,s.g2)("n-select"),d=(0,s.g2)("group-permissions");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Q3)(" Request for Change Types and Release Number "),(0,s.Lk)("div",p,[t[6]||(t[6]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("h2",null,"Type and Version"),(0,s.Lk)("p",{class:"text-instructions"}," Please specify how urgent this RFC's status really is. Optionally you can also specify the version or release number. ")],-1)),(0,s.Lk)("div",h,[(0,s.Lk)("div",m,[(0,s.Lk)("label",null,[t[4]||(t[4]=(0,s.eW)(" Request for Change Type: ")),(0,s.bF)(o,{"error-list":l.v$.rfcTypeModel.$errors},null,8,["error-list"])]),(0,s.bF)(n,{options:r.rfcType,value:r.rfcTypeModel,"onUpdate:value":t[0]||(t[0]=e=>r.rfcTypeModel=e)},null,8,["options","value"])])]),(0,s.Lk)("div",f,[(0,s.Lk)("div",g,[(0,s.Lk)("label",null,[t[5]||(t[5]=(0,s.eW)(" Version/Release Number ")),(0,s.bF)(o,{"error-list":l.v$.rfcVersionModel.$errors},null,8,["error-list"])]),(0,s.bo)((0,s.Lk)("input",{type:"text",maxlength:"25",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>r.rfcVersionModel=e)},null,512),[[c.vModelText,r.rfcVersionModel]])])])]),(0,s.Q3)(" Group Permissions "),t[9]||(t[9]=(0,s.Lk)("hr",null,null,-1)),(0,s.bF)(d,{"display-group-permission-issue":r.displayGroupPermissionIssue,"group-results":a.groupResults,destination:"request_for_change","is-dirty":l.v$.groupModel.$dirty,"user-group-permissions":a.userGroupPermissions,onUpdate_group_model:t[2]||(t[2]=e=>i.updateGroupModel(e))},null,8,["display-group-permission-issue","group-results","is-dirty","user-group-permissions"]),(0,s.Q3)(" RFC Change Lead User "),t[10]||(t[10]=(0,s.Lk)("hr",null,null,-1)),(0,s.Lk)("div",b,[t[8]||(t[8]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("h2",null,"Change LEAD:"),(0,s.Lk)("p",{class:"text-instructions"}," Please supply the LEAD who will be leading this Request for Change. ")],-1)),(0,s.Lk)("div",y,[(0,s.Lk)("div",v,[(0,s.Lk)("label",null,[t[7]||(t[7]=(0,s.eW)(" LEAD: ")),(0,s.bF)(o,{"error-list":l.v$.rfcChangeLeadModel.$errors},null,8,["error-list"]),r.updatingLeadList?((0,s.uX)(),(0,s.CE)("span",k," Updating List. ")):(0,s.Q3)("v-if",!0)]),(0,s.bF)(n,{options:r.rfcChangeLeadFixList,value:r.rfcChangeLeadModel,"onUpdate:value":t[3]||(t[3]=e=>r.rfcChangeLeadModel=e),disabled:r.updatingLeadList},null,8,["options","value","disabled"]),(0,s.Q3)(" TO DO FIX THIS ")])])])])}]]);var w=a(3721),U=a(4461),P=a(4640),F=a(665);const x={class:"rfc-wizard"},A={class:"rfc-wizard--tab-title"},D={name:"RfcWizard",components:{},props:{currentTab:{type:Number,default:0}},data:()=>({tabContents:["Descript","Detail","Risk","Implement","Back-out","Test Plan"]}),methods:{getClasses(e){const t="rfc-wizard--tab-circle";return parseInt(e)===this.currentTab?`${t} current`:parseInt(e)<this.currentTab?`${t} completed`:t},getStyle(){return`width: ${8.333+16.333*this.currentTab}%;`}}},I=(0,S.A)(D,[["render",function(e,t,a,r,i,o){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",{class:"rfc-wizard--loading-bar",style:(0,l.normalizeStyle)(o.getStyle())},null,4),(0,s.Lk)("div",x,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.tabContents,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"rfc-wizard--tab"},[(0,s.Lk)("div",{class:(0,l.normalizeClass)(o.getClasses(t))},[(0,s.Lk)("span",null,(0,l.toDisplayString)(t+1),1)],2),(0,s.Lk)("div",A,(0,l.toDisplayString)(e),1)])))),128))])],64)}]]);var E=a(9581),Q=a(5776);const N={name:"NewRequestForChange",components:{RfcBackoutPlan:P.A,RfcDescription:u.A,RfcDetails:$,RfcImplementationPlan:F.A,RfcRisk:w.A,RfcTestPlan:U.A,RfcWizard:I},props:{groupResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},staticUrl:{type:String,default:"/"},theme:{type:String,default:""},userGroupPermissions:{type:Array,default:()=>[]},uuid:{type:String,default:""}},emits:["onComplete"],data:()=>({currentTab:0,disableSubmitButton:!1,rfcData:{groupModel:[],rfcBackoutPlan:"",rfcChangeLeadModel:{},rfcImpactModel:{},rfcImplementationPlanModel:"",rfcPriorityModel:{},rfcRiskModel:{},rfcRiskSummaryModel:"",rfcSummaryModel:"",rfcTestPlanModel:"",rfcTitleModel:"",rfcTypeModel:{},rfcVersionModel:""},validationData:{tab_0:!1,tab_1:!1,tab_2:!1,tab_3:!1,tab_4:!1,tab_5:!1}}),methods:{useNBTheme:E.p,displayTab(e){return parseInt(e)===parseInt(this.currentTab)?"":"display:none;"},nextTab(){this.currentTab>=5||(!1!==this.validationData[`tab_${this.currentTab}`]?(this.currentTab=this.currentTab+1,window.scrollTo({top:0,behavior:"smooth"})):this.$store.dispatch("newToast",{header:"Please check your inputs",message:"Sorry, we are being told that some of the data is not passing validation. Please check",extra_classes:"bg-danger",delay:1500}))},previousTab(){this.currentTab<=0||(this.currentTab=this.currentTab-1)},submitRfc(){let e=!0;for(const t of Object.keys(this.validationData))e=e&&this.validationData[t];if(!1===e)return void this.$store.dispatch("newToast",{header:"Please check your inputs",message:"Sorry, we are being told that some of the data is not passing validation. Please check",extra_classes:"bg-danger",delay:1500});this.disableSubmitButton=!0;const t=new FormData,a=this.rfcData;t.set("rfc_title",a.rfcTitleModel),t.set("rfc_summary",(0,Q.X)(a.rfcSummaryModel)),t.set("rfc_type",a.rfcTypeModel),t.set("rfc_version_number",a.rfcVersionModel),t.set("rfc_lead",a.rfcChangeLeadModel),t.set("rfc_priority",a.rfcPriorityModel),t.set("rfc_risk",a.rfcRiskModel),t.set("rfc_impact",a.rfcImpactModel),t.set("rfc_risk_and_impact_analysis",(0,Q.X)(a.rfcRiskSummaryModel)),t.set("rfc_implementation_plan",(0,Q.X)(a.rfcImplementationPlanModel)),t.set("rfc_backout_plan",(0,Q.X)(a.rfcBackoutPlan)),t.set("rfc_test_plan",(0,Q.X)(a.rfcTestPlanModel)),a.groupModel.forEach((e=>{t.append("group_list",e)})),this.axios.post(`${this.rootUrl}new_request_for_change/save/`,t).then((e=>{window.location.href=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Can not submit RFC",message:`Sorry there was an error. Error -> ${e}`,extra_classes:"bg-danger",delay:0}),this.disableSubmitButton=!1}))},updateValidation(e){this.validationData[e.tab]=e.value},updateValues(e){this.rfcData[e.modelName]=e.modelValue}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl})}},X=(0,S.A)(N,[["render",function(e,t,a,u,c,p){const h=(0,s.g2)("rfc-wizard"),m=(0,s.g2)("rfc-description"),f=(0,s.g2)("rfc-details"),g=(0,s.g2)("rfc-risk"),b=(0,s.g2)("rfc-implementation-plan"),y=(0,s.g2)("rfc-backout-plan"),v=(0,s.g2)("rfc-test-plan"),k=(0,s.g2)("n-config-provider");return(0,s.uX)(),(0,s.Wv)(k,{theme:p.useNBTheme(a.theme)},{default:(0,s.k6)((()=>[(0,s.Lk)("div",r,[(0,s.Lk)("div",i,[t[15]||(t[15]=(0,s.Lk)("h1",null,"New Request for Change",-1)),t[16]||(t[16]=(0,s.Lk)("hr",null,null,-1)),(0,s.bF)(h,{"current-tab":e.currentTab},null,8,["current-tab"]),(0,s.Q3)(" DESCRIPTION "),(0,s.bF)(m,{uuid:a.uuid,onUpdate_values:t[0]||(t[0]=e=>p.updateValues(e)),onUpdate_validation:t[1]||(t[1]=e=>p.updateValidation(e)),"static-url":a.staticUrl,style:(0,l.normalizeStyle)(p.displayTab(0))},null,8,["uuid","static-url","style"]),(0,s.Q3)(" Details "),(0,s.bF)(f,{uuid:a.uuid,"group-results":a.groupResults,"user-group-permissions":a.userGroupPermissions,onUpdate_validation:t[2]||(t[2]=e=>p.updateValidation(e)),onUpdate_values:t[3]||(t[3]=e=>p.updateValues(e)),style:(0,l.normalizeStyle)(p.displayTab(1))},null,8,["uuid","group-results","user-group-permissions","style"]),(0,s.Q3)(" Risk "),(0,s.bF)(g,{uuid:a.uuid,onUpdate_values:t[4]||(t[4]=e=>p.updateValues(e)),onUpdate_validation:t[5]||(t[5]=e=>p.updateValidation(e)),style:(0,l.normalizeStyle)(p.displayTab(2))},null,8,["uuid","style"]),(0,s.Q3)(" Implementation Plan "),(0,s.bF)(b,{uuid:a.uuid,onUpdate_values:t[6]||(t[6]=e=>p.updateValues(e)),onUpdate_validation:t[7]||(t[7]=e=>p.updateValidation(e)),style:(0,l.normalizeStyle)(p.displayTab(3))},null,8,["uuid","style"]),(0,s.Q3)(" Backout Plan "),(0,s.bF)(y,{uuid:a.uuid,onUpdate_values:t[8]||(t[8]=e=>p.updateValues(e)),onUpdate_validation:t[9]||(t[9]=e=>p.updateValidation(e)),style:(0,l.normalizeStyle)(p.displayTab(4))},null,8,["uuid","style"]),(0,s.Q3)(" Test Plan "),(0,s.bF)(v,{uuid:a.uuid,onUpdate_values:t[10]||(t[10]=e=>p.updateValues(e)),onUpdate_validation:t[11]||(t[11]=e=>p.updateValidation(e)),style:(0,l.normalizeStyle)(p.displayTab(5))},null,8,["uuid","style"]),(0,s.Q3)(" NAVIGATIONS"),t[17]||(t[17]=(0,s.Lk)("hr",null,null,-1)),(0,s.Lk)("div",o,[(0,s.Lk)("div",n,[(0,s.Q3)(" PREVIOUS "),0!==e.currentTab?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"btn btn-primary",onClick:t[12]||(t[12]=(...e)=>p.previousTab&&p.previousTab(...e))}," Previous ")):(0,s.Q3)("v-if",!0),(0,s.Q3)(" NEXT "),5!==e.currentTab?((0,s.uX)(),(0,s.CE)("button",{key:1,class:"btn btn-primary save-changes",onClick:t[13]||(t[13]=(...e)=>p.nextTab&&p.nextTab(...e))}," Next ")):(0,s.Q3)("v-if",!0),(0,s.Q3)(" SUMBIT"),5===e.currentTab?((0,s.uX)(),(0,s.CE)("button",{key:2,class:"btn btn-primary save-changes",onClick:t[14]||(t[14]=(...e)=>p.submitRfc&&p.submitRfc(...e)),disabled:e.disableSubmitButton}," Create new Request for Change ",8,d)):(0,s.Q3)("v-if",!0)])])])])])),_:1},8,["theme"])}]])},1281:(e,t,a)=>{a.d(t,{A:()=>b});var s=a(641),l=a(3751);const r={class:"row"},i={class:"col-md-8",style:{"min-height":"610px"}},o={class:"form-group"},n=["src"];var d=a(9639),u=a(3855),c=a(404),p=a(8838),h=a(2124),m=a(9184),f=a(2595);const g={name:"RfcDescription",setup:()=>({v$:(0,d.Ay)()}),components:{editor:p.A,ValidationRendering:c.A},emits:["update_validation","update_values"],props:{isReadOnly:{type:Boolean,default:!1},rfcResults:{type:Array,default:()=>[]},uuid:{type:String,default:""}},data:()=>({rfcSummaryModel:"",rfcTitleModel:""}),computed:{...(0,h.L8)({contentCss:"getContentCss",skin:"getSkin",staticUrl:"getStaticUrl"})},validations:{rfcSummaryModel:{required:u.mw,maxLength:(0,u.Ru)(63e4)},rfcTitleModel:{required:u.mw,maxLength:(0,u.Ru)(250)}},methods:{handleUploadImage(e,t){return""===this.uuid?(0,f.A)(e,t):(0,m.j)(e,t)},updateValidation(){this.v$.$touch(),this.$emit("update_validation",{tab:"tab_0",value:!this.v$.$invalid})},updateValues(e,t){this.$emit("update_values",{modelName:e,modelValue:t})}},watch:{rfcSummaryModel(){this.updateValues("rfcSummaryModel",this.rfcSummaryModel),this.updateValidation()},rfcTitleModel(){this.updateValues("rfcTitleModel",this.rfcTitleModel),this.updateValidation()}},mounted(){this.rfcResults.length>0&&(this.rfcSummaryModel=this.rfcResults[0].fields.rfc_summary,this.rfcTitleModel=this.rfcResults[0].fields.rfc_title),this.v$.$touch()}},b=(0,a(6262).A)(g,[["render",function(e,t,a,d,u,c){const p=(0,s.g2)("validation-rendering"),h=(0,s.g2)("editor");return(0,s.uX)(),(0,s.CE)("div",r,[t[6]||(t[6]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("h2",null,"Description"),(0,s.Lk)("p",{class:"text-instructions"}," Place a detailed description here. This should cover what your Request For Change (RFC) will entail and why it should be implemented within the time frames specified below. ")],-1)),(0,s.Lk)("div",i,[(0,s.Lk)("div",o,[(0,s.Lk)("label",null,[t[2]||(t[2]=(0,s.eW)(" Request for Change Title: ")),(0,s.bF)(p,{"error-list":d.v$.rfcTitleModel.$errors},null,8,["error-list"])]),(0,s.bo)((0,s.Lk)("input",{type:"text",maxlength:"255",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=t=>e.rfcTitleModel=t)},null,512),[[l.vModelText,e.rfcTitleModel]])]),t[4]||(t[4]=(0,s.Lk)("br",null,null,-1)),(0,s.Q3)(" RFC SUMMARY "),(0,s.Lk)("label",null,[t[3]||(t[3]=(0,s.eW)(" Request for Change Summary: ")),(0,s.bF)(p,{"error-list":d.v$.rfcSummaryModel.$errors},null,8,["error-list"])]),t[5]||(t[5]=(0,s.Lk)("br",null,null,-1)),(0,s.Lk)("img",{src:`${e.staticUrl}NearBeach/images/placeholder/body_text.svg`,class:"loader-image",alt:"loading image for Tinymce"},null,8,n),(0,s.bF)(h,{"license-key":"gpl",init:{license_key:"gpl",file_picker_types:"image",height:500,images_upload_handler:c.handleUploadImage,menubar:!1,paste_data_images:!0,plugins:["lists","image","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`,relative_urls:!1},disabled:a.isReadOnly,modelValue:e.rfcSummaryModel,"onUpdate:modelValue":t[1]||(t[1]=t=>e.rfcSummaryModel=t)},null,8,["init","disabled","modelValue"])])])}]])}}]);