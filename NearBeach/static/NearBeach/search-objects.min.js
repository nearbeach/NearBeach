"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1373,2920],{246:(e,s,t)=>{t.d(s,{y:()=>l});var r=t(6285),a=t(953);function l(e){const s=(0,a.BA)(e);return""===s||null==s?"":r.c9.fromISO(s).toLocaleString(r.c9.DATETIME_MED)}},302:(e,s,t)=>{t.d(s,{A:()=>m});var r=t(641),a=t(33);const l={class:"object-card-list"},i={class:"object-card--detail"},n=["href"],o={class:"object-card--detail--link"},u={class:"object-card--detail--description"},c={class:"object-card--status"},h=["href"],d={class:"object-card--status--status"},p={class:"small-text"};var b=t(2124);const g={name:"RenderObjectCard",methods:{useNiceDatetime:t(246).y},props:{destination:{type:String,default:""},importVariables:{type:Object,default:()=>({header:"",prefix:"",id:0,title:"",status:""})},searchResults:{type:Array,default:()=>[]}},computed:{...(0,b.L8)({rootUrl:"getRootUrl"})}},m=(0,t(6262).A)(g,[["render",function(e,s,t,b,g,m){return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("h2",null,(0,a.toDisplayString)(t.importVariables.header),1),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.searchResults,(s=>((0,r.uX)(),(0,r.CE)("div",{class:"object-card",key:s.pk},[(0,r.Lk)("div",i,[(0,r.Lk)("a",{href:`${e.rootUrl}${t.destination}_information/${s[t.importVariables.id]}/`},[(0,r.Lk)("div",o,(0,a.toDisplayString)(t.importVariables.prefix)+(0,a.toDisplayString)(s[t.importVariables.id]),1),(0,r.Lk)("div",u,(0,a.toDisplayString)(s[t.importVariables.title]),1)],8,n)]),(0,r.Lk)("div",c,[(0,r.Lk)("a",{href:`${e.rootUrl}${t.destination}_information/${s[t.importVariables.id]}/`},[(0,r.Lk)("div",d,(0,a.toDisplayString)(s[t.importVariables.status]),1),(0,r.Lk)("p",p,(0,a.toDisplayString)(m.useNiceDatetime(s[t.importVariables.end_date])),1)],8,h)])])))),128))])}]])},1223:(e,s,t)=>{t.r(s),t.d(s,{default:()=>d});var r=t(641),a=t(33);const l={class:"card search-card"},i={class:"card-body"},n=["aria-label"],o={class:"pagination justify-content-center"},u=["onClick"],c={key:1,class:"page-link"},h={name:"ListSearchResults",components:{RenderObjectCard:t(302).A},emits:["get_search_results"],props:{currentPage:{type:Number,default:0},destination:{type:String,default:""},importVariables:{type:Object,default:()=>({header:"",prefix:"",id:0,title:"",status:""})},numberOfPages:{type:Number,default:0},searchResults:{type:Array,default:()=>[]}},methods:{changePage(e){this.$emit("get_search_results",{array_of_objects:[this.destination],destination_page:e})},getClasses(e){return parseInt(e)===this.currentPage?"page-item active":"page-item"}}},d=(0,t(6262).A)(h,[["render",function(e,s,t,h,d,p){const b=(0,r.g2)("render-object-card");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",i,[(0,r.Lk)("h2",null,(0,a.toDisplayString)(t.importVariables.header)+" Search Results",1),s[0]||(s[0]=(0,r.Lk)("hr",null,null,-1)),(0,r.bF)(b,{"search-results":t.searchResults,"import-variables":t.importVariables,destination:t.destination},null,8,["search-results","import-variables","destination"]),t.numberOfPages>1?((0,r.uX)(),(0,r.CE)("nav",{key:0,"aria-label":`Pagination for ${t.importVariables.header}`},[(0,r.Lk)("ul",o,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.numberOfPages,(e=>((0,r.uX)(),(0,r.CE)("li",{key:e,class:(0,a.normalizeClass)(p.getClasses(e))},[parseInt(e)!==parseInt(t.currentPage)?((0,r.uX)(),(0,r.CE)("a",{key:0,class:"page-link",href:"javascript:void(0)",onClick:s=>p.changePage(e)},(0,a.toDisplayString)(e),9,u)):((0,r.uX)(),(0,r.CE)("span",c,(0,a.toDisplayString)(e),1))],2)))),128))])],8,n)):(0,r.Q3)("v-if",!0)])])}]])},3214:(e,s,t)=>{t.r(s),t.d(s,{default:()=>b});var r=t(641),a=t(3751);const l={class:"card"},i={class:"card-body"},n={class:"form-row"},o={class:"form-group"},u={class:"form-group"},c={key:0,class:"form-group"},h={key:5,class:"alert alert-warning"},d={key:6,class:"alert alert-info"},p={name:"SearchObjects",components:{ListSearchResults:t(1223).default},props:{isSuperuser:{type:Boolean,default:!1},rootUrl:{type:String,default:"/"},searchInput:{type:String,required:!1,default:""}},data(){return{allObjects:["request_for_change","requirement","project","task","kanban_board"],includeAllGroupsModel:!1,includeClosedObjectsModel:!1,isCurrentlySearching:!0,kanbanVariables:{header:"Kanban",prefix:"Kb",id:"id",title:"title",status:"status"},projectVariables:{header:"Projects",prefix:"Pro",id:"id",title:"title",status:"status"},requestForChangeVariables:{header:"Request for Change",prefix:"Rfc",id:"id",title:"title",status:"status"},requirementVariables:{header:"Requirements",prefix:"Req",id:"id",title:"title",status:"status"},searchModel:this.searchInput,searchResults:{request_for_change:[],requirement:[],project:[],task:[],kanban_board:[]},searchTimeout:"",taskVariables:{header:"Tasks",prefix:"Task",id:"id",title:"title",status:"status"}}},methods:{getSearchResults(e){this.isCurrentlySearching=!0;const s=new FormData;s.set("search",this.searchModel),s.set("include_closed",this.includeClosedObjectsModel),s.set("include_all_groups",this.includeAllGroupsModel),s.set("destination_page",e.destination_page),e.array_of_objects.forEach((e=>{s.append("array_of_objects",e)})),this.axios.post(`${this.rootUrl}search/data/`,s).then((e=>{this.allObjects.forEach((s=>{void 0!==e.data[s]&&(this.searchResults[s]=e.data[s],this.searchResults[`${s}_current_page`]=e.data[`${s}_current_page`],this.searchResults[`${s}_number_of_pages`]=e.data[`${s}_number_of_pages`])})),this.isCurrentlySearching=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to get search results",message:`Sorry, we failed to get your search results. Error -> ${e}`,extra_classes:"bg-danger",delay:0}),this.isCurrentlySearching=!1}))},showNoResults(){const e=this.searchResults.requirement.length+this.searchResults.project.length+this.searchResults.task.length+this.searchResults.kanban_board.length+this.searchResults.request_for_change.length===0,s=!this.isCurrentlySearching;return e&&s}},watch:{includeAllGroupsModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})},includeClosedObjectsModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})},searchModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((()=>{this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})}),500)}},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})}},b=(0,t(6262).A)(p,[["render",function(e,s,t,p,b,g){const m=(0,r.g2)("list-search-results");return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.Lk)("div",l,[(0,r.Lk)("div",i,[(0,r.Q3)(" HEADING "),s[11]||(s[11]=(0,r.Lk)("h1",null,"Search",-1)),s[12]||(s[12]=(0,r.Lk)("hr",null,null,-1)),(0,r.Q3)(" SEARCH FIELD "),(0,r.Lk)("div",n,[(0,r.Lk)("div",o,[s[8]||(s[8]=(0,r.Lk)("label",null,"Search:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control search-organisation","onUpdate:modelValue":s[0]||(s[0]=e=>b.searchModel=e),maxlength:"250"},null,512),[[a.vModelText,b.searchModel]])]),(0,r.Lk)("div",u,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox",id:"inlcudeClosedObjects","onUpdate:modelValue":s[1]||(s[1]=e=>b.includeClosedObjectsModel=e)},null,512),[[a.vModelCheckbox,b.includeClosedObjectsModel]]),s[9]||(s[9]=(0,r.Lk)("label",{for:"inlcudeClosedObjects"}," Include Closed Objects",-1))]),t.isSuperuser?((0,r.uX)(),(0,r.CE)("div",c,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox",id:"includeAllGroups","onUpdate:modelValue":s[2]||(s[2]=e=>b.includeAllGroupsModel=e)},null,512),[[a.vModelCheckbox,b.includeAllGroupsModel]]),s[10]||(s[10]=(0,r.Lk)("label",{for:"includeAllGroups"}," Include All Groups",-1))])):(0,r.Q3)("v-if",!0)])])]),s[13]||(s[13]=(0,r.Lk)("br",null,null,-1)),(0,r.Q3)(" REQUEST FOR CHANGE RESULTS "),b.searchResults.request_for_change.length>0?((0,r.uX)(),(0,r.Wv)(m,{key:0,currentPage:b.searchResults.request_for_change_current_page,"search-results":b.searchResults.request_for_change,"import-variables":b.requestForChangeVariables,"number-of-pages":b.searchResults.request_for_change_number_of_pages,onGet_search_results:s[3]||(s[3]=e=>g.getSearchResults(e)),destination:"rfc"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,r.Q3)("v-if",!0),(0,r.Q3)(" REQUIREMENTS RESULTS "),b.searchResults.requirement.length>0?((0,r.uX)(),(0,r.Wv)(m,{key:1,currentPage:b.searchResults.requirement_current_page,"search-results":b.searchResults.requirement,"import-variables":b.requirementVariables,"number-of-pages":b.searchResults.requirement_number_of_pages,onGet_search_results:s[4]||(s[4]=e=>g.getSearchResults(e)),destination:"requirement"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,r.Q3)("v-if",!0),(0,r.Q3)(" PROJECT RESULTS "),b.searchResults.project.length>0?((0,r.uX)(),(0,r.Wv)(m,{key:2,currentPage:b.searchResults.project_current_page,"search-results":b.searchResults.project,"import-variables":b.projectVariables,"number-of-pages":b.searchResults.project_number_of_pages,onGet_search_results:s[5]||(s[5]=e=>g.getSearchResults(e)),destination:"project"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,r.Q3)("v-if",!0),(0,r.Q3)(" TASK RESULTS "),b.searchResults.task.length>0?((0,r.uX)(),(0,r.Wv)(m,{key:3,currentPage:b.searchResults.task_current_page,"search-results":b.searchResults.task,"import-variables":b.taskVariables,"number-of-pages":b.searchResults.task_number_of_pages,onGet_search_results:s[6]||(s[6]=e=>g.getSearchResults(e)),destination:"task"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,r.Q3)("v-if",!0),(0,r.Q3)(" KANBAN RESULTS "),b.searchResults.kanban_board.length>0?((0,r.uX)(),(0,r.Wv)(m,{key:4,currentPage:b.searchResults.kanban_board_current_page,"search-results":b.searchResults.kanban_board,"import-variables":b.kanbanVariables,"number-of-pages":b.searchResults.kanban_board_number_of_pages,onGet_search_results:s[7]||(s[7]=e=>g.getSearchResults(e)),destination:"kanban"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,r.Q3)("v-if",!0),(0,r.Q3)(" WHEN THERE ARE NO RESULTS "),g.showNoResults()?((0,r.uX)(),(0,r.CE)("div",h," Sorry - but there are no results for this search term. Please try searching for a different search term. ")):(0,r.Q3)("v-if",!0),b.isCurrentlySearching?((0,r.uX)(),(0,r.CE)("div",d," Please wait. Searching for results. ")):(0,r.Q3)("v-if",!0)])}]])},6262:(e,s)=>{s.A=(e,s)=>{const t=e.__vccOpts||e;for(const[e,r]of s)t[e]=r;return t}}}]);