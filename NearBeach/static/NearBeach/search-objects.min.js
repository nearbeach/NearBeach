"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1373,2920],{246:(e,t,s)=>{s.d(t,{y:()=>i});var a=s(6285),r=s(953);function i(e){const t=(0,r.BA)(e);return""===t||null==t?"":a.c9.fromISO(t).toLocaleString(a.c9.DATETIME_MED)}},3781:(e,t,s)=>{function a(e,t){return 0===t?[]:t<=7?Array.from({length:t},((e,t)=>({destinationPage:t+1,text:`${t+1}`}))):e<=4?[{destinationPage:1,text:"1"},{destinationPage:2,text:"2"},{destinationPage:3,text:"3"},{destinationPage:4,text:"4"},{destinationPage:5,text:"5"},{destinationPage:6,text:">"},{destinationPage:t,text:">>"}]:e>t-4?[{destinationPage:1,text:"<<"},{destinationPage:t-5,text:"<"},{destinationPage:t-4,text:""+(t-4)},{destinationPage:t-3,text:""+(t-3)},{destinationPage:t-2,text:""+(t-2)},{destinationPage:t-1,text:""+(t-1)},{destinationPage:t,text:`${t}`}]:[{destinationPage:1,text:"<<"},{destinationPage:e-2,text:"<"},{destinationPage:e-1,text:""+(e-1)},{destinationPage:e,text:`${e}`},{destinationPage:e+1,text:`${e+1}`},{destinationPage:e+2,text:">"},{destinationPage:t,text:">>"}]}s.d(t,{k:()=>a})},6262:(e,t)=>{t.A=(e,t)=>{const s=e.__vccOpts||e;for(const[e,a]of t)s[e]=a;return s}},7423:(e,t,s)=>{s.d(t,{A:()=>_});var a=s(641),r=s(33);const i={class:"object-card-list"},l={key:0},n={class:"object-card--detail"},o=["href","target"],c={class:"object-card--detail--link"},u={class:"object-card--detail--description"},d={class:"object-card--status"},h=["href","target"],g={class:"object-card--status--status"},p={class:"small-text"},b={key:2,class:"object-card"};var f=s(2124);const m={name:"RenderObjectCard",methods:{useNiceDatetime:s(246).y,tempTranslate:e=>"kanban_board"===e?"kanban":e},props:{destination:{type:String,default:""},importVariables:{type:Object,default:()=>({header:"",prefix:"",id:0,title:"",status:""})},searchResults:{type:Array,default:()=>[]},target:{type:String,default:""}},computed:{...(0,f.L8)({rootUrl:"getRootUrl"})}},_=(0,s(6262).A)(m,[["render",function(e,t,s,f,m,_){return(0,a.uX)(),(0,a.CE)("div",i,[""!==s.importVariables.header?((0,a.uX)(),(0,a.CE)("h2",l,(0,r.toDisplayString)(s.importVariables.header),1)):(0,a.Q3)("v-if",!0),s.searchResults.length>0?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:1},(0,a.pI)(s.searchResults,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"object-card",key:t.pk},[(0,a.Lk)("div",n,[(0,a.Lk)("a",{href:`${e.rootUrl}${_.tempTranslate(s.destination)}_information/${t[s.importVariables.id]}/`,target:s.target},[(0,a.Lk)("div",c,(0,r.toDisplayString)(s.importVariables.prefix)+(0,r.toDisplayString)(t[s.importVariables.id]),1),(0,a.Lk)("div",u,(0,r.toDisplayString)(t[s.importVariables.title]),1)],8,o)]),(0,a.Lk)("div",d,[(0,a.Lk)("a",{href:`${e.rootUrl}${s.destination}_information/${t[s.importVariables.id]}/`,target:s.target},[(0,a.Lk)("div",g,(0,r.toDisplayString)(t[s.importVariables.status]),1),(0,a.Lk)("p",p,(0,r.toDisplayString)(_.useNiceDatetime(t[s.importVariables.end_date])),1)],8,h)])])))),128)):(0,a.Q3)("v-if",!0),(0,a.Q3)(" Loading state "),0===s.searchResults.length?((0,a.uX)(),(0,a.CE)("div",b,t[0]||(t[0]=[(0,a.Fv)('<div class="object-card--detail"><p class="card-text placeholder-glow"><span class="placeholder col-1"></span><span class="placeholder col-12"></span></p></div><div class="object-card--status"></div>',2)]))):(0,a.Q3)("v-if",!0)])}]])},7549:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var a=s(641),r=s(3751);const i={class:"card"},l={class:"card-body"},n={class:"form-row"},o={class:"form-group"},c={class:"form-group"},u={key:0,class:"form-group"},d={key:5,class:"alert alert-warning"},h={name:"SearchObjects",components:{ListSearchResults:s(9258).default},props:{isSuperuser:{type:Boolean,default:!1},rootUrl:{type:String,default:"/"},searchInput:{type:String,required:!1,default:""}},data(){return{allObjects:["request_for_change","requirement","project","task","kanban_board"],includeAllGroupsModel:!1,includeClosedObjectsModel:!1,isCurrentlySearching:!0,kanbanVariables:{header:"",prefix:"Kb",id:"id",title:"title",status:"status"},projectVariables:{header:"",prefix:"Pro",id:"id",title:"title",status:"status"},requestForChangeVariables:{header:"",prefix:"Rfc",id:"id",title:"title",status:"status"},requirementVariables:{header:"",prefix:"Req",id:"id",title:"title",status:"status"},searchModel:this.searchInput,searchResults:{request_for_change:[],requirement:[],project:[],task:[],kanban_board:[]},searchTimeout:"",taskVariables:{header:"Tasks",prefix:"Task",id:"id",title:"title",status:"status"}}},methods:{getSearchResults(e){this.isCurrentlySearching=!0;const t=new FormData;t.set("search",this.searchModel),t.set("include_closed",this.includeClosedObjectsModel),t.set("include_all_groups",this.includeAllGroupsModel),t.set("destination_page",e.destination_page),e.array_of_objects.forEach((e=>{t.append("array_of_objects",e)})),this.axios.post(`${this.rootUrl}search/data/`,t).then((e=>{this.allObjects.forEach((t=>{void 0!==e.data[t]&&(this.searchResults[t]=e.data[t],this.searchResults[`${t}_current_page`]=e.data[`${t}_current_page`],this.searchResults[`${t}_number_of_pages`]=e.data[`${t}_number_of_pages`])})),this.isCurrentlySearching=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to get search results",message:`Sorry, we failed to get your search results. Error -> ${e}`,extra_classes:"bg-danger",delay:0}),this.isCurrentlySearching=!1}))},showNoResults(){const e=this.searchResults.requirement.length+this.searchResults.project.length+this.searchResults.task.length+this.searchResults.kanban_board.length+this.searchResults.request_for_change.length===0,t=!this.isCurrentlySearching;return e&&t}},watch:{includeAllGroupsModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})},includeClosedObjectsModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})},searchModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((()=>{this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})}),500)}},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.getSearchResults({array_of_objects:this.allObjects,destination_page:1})}},g=(0,s(6262).A)(h,[["render",function(e,t,s,h,g,p){const b=(0,a.g2)("list-search-results");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",i,[(0,a.Lk)("div",l,[(0,a.Q3)(" HEADING "),t[11]||(t[11]=(0,a.Lk)("h1",null,"Search",-1)),t[12]||(t[12]=(0,a.Lk)("hr",null,null,-1)),(0,a.Q3)(" SEARCH FIELD "),(0,a.Lk)("div",n,[(0,a.Lk)("div",o,[t[8]||(t[8]=(0,a.Lk)("label",null,"Search:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control search-organisation","onUpdate:modelValue":t[0]||(t[0]=e=>g.searchModel=e),maxlength:"250"},null,512),[[r.vModelText,g.searchModel]])]),(0,a.Lk)("div",c,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",id:"inlcudeClosedObjects","onUpdate:modelValue":t[1]||(t[1]=e=>g.includeClosedObjectsModel=e)},null,512),[[r.vModelCheckbox,g.includeClosedObjectsModel]]),t[9]||(t[9]=(0,a.Lk)("label",{for:"inlcudeClosedObjects"}," Include Closed Objects",-1))]),s.isSuperuser?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",id:"includeAllGroups","onUpdate:modelValue":t[2]||(t[2]=e=>g.includeAllGroupsModel=e)},null,512),[[r.vModelCheckbox,g.includeAllGroupsModel]]),t[10]||(t[10]=(0,a.Lk)("label",{for:"includeAllGroups"}," Include All Groups",-1))])):(0,a.Q3)("v-if",!0)])])]),t[13]||(t[13]=(0,a.Lk)("br",null,null,-1)),(0,a.Q3)(" REQUEST FOR CHANGE RESULTS "),g.searchResults.request_for_change.length>0?((0,a.uX)(),(0,a.Wv)(b,{key:0,currentPage:g.searchResults.request_for_change_current_page,"search-results":g.searchResults.request_for_change,"import-variables":g.requestForChangeVariables,"number-of-pages":g.searchResults.request_for_change_number_of_pages,onGet_search_results:t[3]||(t[3]=e=>p.getSearchResults(e)),destination:"rfc"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" REQUIREMENTS RESULTS "),g.searchResults.requirement.length>0?((0,a.uX)(),(0,a.Wv)(b,{key:1,currentPage:g.searchResults.requirement_current_page,"search-results":g.searchResults.requirement,"import-variables":g.requirementVariables,"number-of-pages":g.searchResults.requirement_number_of_pages,onGet_search_results:t[4]||(t[4]=e=>p.getSearchResults(e)),destination:"requirement"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" PROJECT RESULTS "),g.searchResults.project.length>0?((0,a.uX)(),(0,a.Wv)(b,{key:2,currentPage:g.searchResults.project_current_page,"search-results":g.searchResults.project,"import-variables":g.projectVariables,"number-of-pages":g.searchResults.project_number_of_pages,onGet_search_results:t[5]||(t[5]=e=>p.getSearchResults(e)),destination:"project"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" TASK RESULTS "),g.searchResults.task.length>0?((0,a.uX)(),(0,a.Wv)(b,{key:3,currentPage:g.searchResults.task_current_page,"search-results":g.searchResults.task,"import-variables":g.taskVariables,"number-of-pages":g.searchResults.task_number_of_pages,onGet_search_results:t[6]||(t[6]=e=>p.getSearchResults(e)),destination:"task"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" KANBAN RESULTS "),g.searchResults.kanban_board.length>0?((0,a.uX)(),(0,a.Wv)(b,{key:4,currentPage:g.searchResults.kanban_board_current_page,"search-results":g.searchResults.kanban_board,"import-variables":g.kanbanVariables,"number-of-pages":g.searchResults.kanban_board_number_of_pages,onGet_search_results:t[7]||(t[7]=e=>p.getSearchResults(e)),destination:"kanban_board"},null,8,["currentPage","search-results","import-variables","number-of-pages"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" WHEN THERE ARE NO RESULTS "),p.showNoResults()?((0,a.uX)(),(0,a.CE)("div",d," Sorry - but there are no results for this search term. Please try searching for a different search term. ")):(0,a.Q3)("v-if",!0)])}]])},9258:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var a=s(641),r=s(33);const i={class:"card-header"},l={class:"card-body"},n={class:"card-footer"},o=["aria-label"],c={class:"pagination justify-content-center m-0"},u=["onClick"],d={key:1,class:"page-link"};var h=s(7423),g=s(3781);const p={name:"ListSearchResults",components:{RenderObjectCard:h.A},emits:["get_search_results"],props:{currentPage:{type:Number,default:0},destination:{type:String,default:""},importVariables:{type:Object,default:()=>({header:"",prefix:"",id:0,title:"",status:""})},numberOfPages:{type:Number,default:0},searchResults:{type:Array,default:()=>[]}},watch:{searchResults:{handler(e){this.localSearchResults=e,this.cardClass="",this.setOfPages=(0,g.k)(this.currentPage,this.numberOfPages)},deep:!0}},data(){return{cardClass:"",localSearchResults:this.searchResults,setOfPages:[]}},methods:{getSetOfPages:g.k,changePage(e){this.cardClass=`height: ${this.$refs.searchCard.offsetHeight}px`,this.localSearchResults=[];const t="rfc"===this.destination?"request_for_change":this.destination;this.$emit("get_search_results",{array_of_objects:[t],destination_page:e}),this.setOfPages=this.getSetOfPages(e,this.numberOfPages)},getClasses(e){return parseInt(e)===this.currentPage?"page-item active":"page-item"}},mounted(){this.setOfPages=(0,g.k)(1,this.numberOfPages)}},b=(0,s(6262).A)(p,[["render",function(e,t,s,h,g,p){const b=(0,a.g2)("render-object-card");return(0,a.uX)(),(0,a.CE)("div",{class:"card search-card",style:(0,r.normalizeStyle)(g.cardClass),ref:"searchCard"},[(0,a.Lk)("div",i,[(0,a.Lk)("h2",null,(0,r.toDisplayString)(s.importVariables.header)+" Search Results",1)]),(0,a.Lk)("div",l,[(0,a.bF)(b,{"search-results":g.localSearchResults,"import-variables":s.importVariables,destination:s.destination},null,8,["search-results","import-variables","destination"])]),(0,a.Lk)("div",n,[g.setOfPages.length>1?((0,a.uX)(),(0,a.CE)("nav",{key:0,"aria-label":`Pagination for ${s.importVariables.header}`},[(0,a.Lk)("ul",c,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(g.setOfPages,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.destinationPage,class:(0,r.normalizeClass)(p.getClasses(e.destinationPage))},[parseInt(e.destinationPage)!==parseInt(s.currentPage)?((0,a.uX)(),(0,a.CE)("a",{key:0,class:"page-link",href:"javascript:void(0)",onClick:t=>p.changePage(e.destinationPage)},(0,r.toDisplayString)(e.text),9,u)):((0,a.uX)(),(0,a.CE)("span",d,(0,r.toDisplayString)(e.text),1))],2)))),128))])],8,o)):(0,a.Q3)("v-if",!0)])],4)}]])}}]);