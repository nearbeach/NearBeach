"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[9448],{3233:(e,t,o)=>{o.d(t,{A:()=>w});var n=o(641),i=o(33);const r={class:"customer-list"},s=["src"],a={class:"customer-card--details"},l={class:"customer-card--name"},c=["href"],d={class:"customer-card--email"},u={key:0,class:"customer-card--remove"};var m=o(9336);const p={class:"modal fade",id:"confirmCustomerRemoveModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmCustomerRemove","aria-hidden":"true"},f={class:"modal-dialog"},b={class:"modal-content"},g={class:"modal-body"},h={class:"customer-card--details"},v={class:"customer-card--name"},y=["href"],C={class:"customer-card--email"},k={class:"modal-footer"};var L=o(2124);const _={name:"ConfirmCustomerRemoval",emits:["remove_customer"],props:{customerObject:{type:Object,default:()=>({customer_id:0,customer_email:"",customer_first_name:"",customer_last_name:"",customer_profile_picture:""})}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{closeModal(){document.getElementById("confirmCustomerRemoveButton").click()},removeCustomer(){const e=new FormData;e.set("customer_id",this.customerObject.customer_id);let t=`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_customer/`;"organisation"===this.destination&&(t=`${this.rootUrl}customer_information/${this.locationId}/delete/`),this.axios.post(t,e).then((()=>{this.$emit("remove_customer",this.customerObject.customer_id)})).catch((e=>{this.$store.dispatch("newToast",{header:"Can't remove customer",message:`Sorry, could not remove customer. Error -> ${e}`,extra_classes:"bg-warning text-dark",delay:0})})),this.closeModal()}}};var D=o(6262);const S=(0,D.A)(_,[["render",function(e,t,o,r,s,a){return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",f,[(0,n.Lk)("div",b,[t[2]||(t[2]=(0,n.Lk)("div",{class:"modal-header"},[(0,n.Lk)("h5",{class:"modal-title",id:"confirmCustomerRemove"}," Please confirm Customer Removal "),(0,n.Q3)(" TASK INFORMATION "),(0,n.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmCustomerRemoveButton"})],-1)),(0,n.Lk)("div",g,[(0,n.Lk)("div",h,[(0,n.Lk)("div",v,[(0,n.Lk)("a",{href:`${e.rootUrl}customer_information/${o.customerObject.customer_id}/`,target:"_blank",rel:"noopener noreferrer"},(0,i.toDisplayString)(o.customerObject.customer_first_name)+" "+(0,i.toDisplayString)(o.customerObject.customer_last_name),9,y)]),(0,n.Lk)("div",C,(0,i.toDisplayString)(o.customerObject.customer_email),1)])]),(0,n.Lk)("div",k,[(0,n.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>a.closeModal&&a.closeModal(...e))}," No "),(0,n.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>a.removeCustomer&&a.removeCustomer(...e))}," Yes ")])])])])}]]);var j=o(3980);const O={name:"CustomersListModule",components:{CarbonEmail:j.G2,CarbonTrashCan:j.dA,ConfirmCustomerRemoval:S},props:{customerResults:{type:Array,default:()=>[]}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"}),defaultCustomerImage(){return`${this.staticUrl}/NearBeach/images/placeholder/people_tax.svg`}},data:()=>({customerObject:{customer_id:0,customer_email:"",customer_first_name:"",customer_last_name:"",customer_profile_picture:""}}),emits:["remove_customer"],methods:{confirmRemoveCustomer(e){const t=this.customerResults.filter((t=>parseInt(t.pk)===parseInt(e)));1===t.length?(this.customerObject=t.map((e=>({customer_id:e.pk,customer_email:e.fields.customer_email,customer_first_name:e.fields.customer_first_name,customer_last_name:e.fields.customer_last_name,customer_profile_picture:e.fields.customer_profile_picture})))[0],new m.aF(document.getElementById("confirmCustomerRemoveModal")).show()):this.$store.dispatch("newToast",{header:"Error Deleting Customer",message:"Could not select the correct ID of the customer. Something went wrong",extra_classes:"bg-danger",delay:0})},getCustomerImage(e){const t=e.fields.customer_profile_picture;return""===t||null===t?this.defaultCustomerImage:`${this.rootUrl}private/${t}`},removeCustomer(e){this.$emit("remove_customer",e)}}},w=(0,D.A)(O,[["render",function(e,t,o,m,p,f){const b=(0,n.g2)("carbon-email"),g=(0,n.g2)("carbon-trash-can"),h=(0,n.g2)("confirm-customer-removal");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",r,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.customerResults,(t=>((0,n.uX)(),(0,n.CE)("div",{key:t.pk,class:"customer-card"},[(0,n.Q3)(" CUSOMER PROFILE "),(0,n.Lk)("img",{src:f.getCustomerImage(t),alt:"default profile picture"},null,8,s),(0,n.Q3)(" CUSTOMER DETAILS "),(0,n.Lk)("div",a,[(0,n.Lk)("div",l,[(0,n.Lk)("a",{href:`${e.rootUrl}customer_information/${t.pk}/`},(0,i.toDisplayString)(t.fields.customer_first_name)+" "+(0,i.toDisplayString)(t.fields.customer_last_name),9,c)]),(0,n.Lk)("div",d,[(0,n.bF)(b),(0,n.eW)(" "+(0,i.toDisplayString)(t.fields.customer_email),1)])]),e.userLevel>=2?((0,n.uX)(),(0,n.CE)("div",u,[(0,n.bF)(g,{onClick:e=>f.confirmRemoveCustomer(t.pk)},null,8,["onClick"])])):(0,n.Q3)("v-if",!0)])))),128))]),(0,n.bF)(h,{"customer-object":p.customerObject,onRemove_customer:t[0]||(t[0]=e=>f.removeCustomer(e))},null,8,["customer-object"])],64)}]])},4186:(e,t,o)=>{o.d(t,{A:()=>h});var n=o(641),i=o(33),r=o(3751);const s={class:"modal fade",id:"confirmDeleteObjectModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmDeleteObject","aria-hidden":"true"},a={class:"modal-dialog modal-lg"},l={class:"modal-content"},c={class:"modal-header"},d={class:"modal-title",id:"confirmDeleteObject"},u={class:"modal-body"},m={class:"mt-2"},p={class:"form-group mt-2"},f={class:"modal-footer justify-content-between"},b=["disabled"],g={name:"ConfirmDeleteObject",data:()=>({confirmTitle:"",isButtonDisabled:!0}),computed:{...(0,o(2124).L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",title:"getTitle"})},watch:{confirmTitle(){this.isButtonDisabled=this.confirmTitle.toLowerCase()!==this.title.toLowerCase()}},methods:{closeModal(){this.confirmTitle="",document.getElementById("confirmDeleteObjectButton").click()},deleteObject(){this.$store.dispatch("newToast",{header:"Deleting Object",message:"Deleting Object, please wait",extra_classes:"bg-warning",delay:0,unique_type:"delete_object"}),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/delete/`).then((()=>{window.location.href=this.rootUrl})).catch((e=>{this.$store.dispatch("newToast",{header:"Error deleting Object",message:`Could not delete the ${this.destination}. Error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"delete_object"})}))}}},h=(0,o(6262).A)(g,[["render",function(e,t,o,g,h,v){return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",a,[(0,n.Lk)("div",l,[(0,n.Lk)("div",c,[(0,n.Lk)("h5",d," Please confirm "+(0,i.toDisplayString)(e.destination)+" deletion ",1),(0,n.Q3)(" TASK INFORMATION "),t[3]||(t[3]=(0,n.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmDeleteObjectButton"},null,-1))]),(0,n.Lk)("div",u,[(0,n.eW)(" Can you please confirm the title of the "+(0,i.toDisplayString)(e.destination)+" you are deleting. ",1),t[6]||(t[6]=(0,n.Lk)("br",null,null,-1)),(0,n.Lk)("div",m,[t[4]||(t[4]=(0,n.Lk)("strong",null,"Title: ",-1)),(0,n.eW)((0,i.toDisplayString)(e.title),1)]),(0,n.Lk)("div",p,[t[5]||(t[5]=(0,n.Lk)("label",null,"Confirm Title: ",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>h.confirmTitle=e),class:"form-control",onpaste:"return false",ondrop:"return false",autocomplete:"off"},null,512),[[r.vModelText,h.confirmTitle]])])]),(0,n.Lk)("div",f,[(0,n.Lk)("button",{type:"button",class:"btn btn-primary btn-sm",onClick:t[1]||(t[1]=(...e)=>v.closeModal&&v.closeModal(...e))}," No - Keep "+(0,i.toDisplayString)(e.destination),1),(0,n.Lk)("button",{type:"button",class:"btn btn-danger btn-sm",onClick:t[2]||(t[2]=(...e)=>v.deleteObject&&v.deleteObject(...e)),disabled:h.isButtonDisabled}," Yes - Delete "+(0,i.toDisplayString)(e.destination),9,b)])])])])}]])},4325:(e,t,o)=>{o.d(t,{A:()=>c});var n=o(641),i=o(33);const r={class:"delete-object"};var s=o(2124),a=o(9336);const l={name:"DeleteObject",components:{ConfirmDeleteObject:o(4186).A},computed:{...(0,s.L8)({destination:"getDestination",rootUrl:"getRootUrl"})},methods:{confirmDeleteObject(){new a.aF(document.getElementById("confirmDeleteObjectModal")).show()}}},c=(0,o(6262).A)(l,[["render",function(e,t,o,s,a,l){const c=(0,n.g2)("confirm-delete-object");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",r,[t[1]||(t[1]=(0,n.Lk)("h2",null,"Delete Object",-1)),(0,n.Lk)("p",null," WARNING! This will delete the follow "+(0,i.toDisplayString)(e.destination)+" from the system. This can not be undone. ",1),(0,n.Lk)("button",{class:"btn btn-outline-dark",onClick:t[0]||(t[0]=(...e)=>l.confirmDeleteObject&&l.confirmDeleteObject(...e))}," DELETE "+(0,i.toDisplayString)(e.destination),1)]),(0,n.bF)(c)],64)}]])},5738:(e,t,o)=>{o.d(t,{A:()=>p});var n=o(641),i=o(33);const r={class:"text-instructions"},s={key:0},a={class:"row submit-row"},l={class:"col-md-12"};var c=o(9336),d=o(5665),u=o(2124);const m={name:"NotesModule",components:{ListNotes:d.A},computed:{...(0,u.L8)({destination:"getDestination",locationId:"getLocationId",userLevel:"getUserLevel",rootUrl:"getRootUrl"}),...(0,u.L8)(["getUserExtraPermission"]),hasNotePermission(){return this.getUserExtraPermission(`${this.destination}_note`)}},methods:{createNewNote(){new c.aF(document.getElementById("newNoteModal")).show()},getNoteHistoryResults(){let e="note_list";"organisation"===this.destination&&(e="organisation_note_list"),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/${e}/`).then((e=>{this.$store.commit({type:"initNoteList",noteList:e.data})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Note History",message:`Can not retrieve the note history. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.$nextTick((()=>{this.getNoteHistoryResults()}))}},p=(0,o(6262).A)(m,[["render",function(e,t,o,c,d,u){const m=(0,n.g2)("list-notes");return(0,n.uX)(),(0,n.CE)("div",null,[t[1]||(t[1]=(0,n.Lk)("h2",null," Note History ",-1)),(0,n.Lk)("p",r," The following are saved notes against this "+(0,i.toDisplayString)(e.destination)+". Add notes by clicking on the button below. ",1),(0,n.bF)(m,{destination:e.destination},null,8,["destination"]),(0,n.Q3)(" ADD NOTE HISTORY "),e.userLevel>1||u.hasNotePermission?((0,n.uX)(),(0,n.CE)("hr",s)):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",a,[(0,n.Lk)("div",l,[e.userLevel>1||u.hasNotePermission?((0,n.uX)(),(0,n.CE)("button",{key:0,class:"btn btn-primary save-changes",onClick:t[0]||(t[0]=(...e)=>u.createNewNote&&u.createNewNote(...e))}," Add Note to "+(0,i.toDisplayString)(e.destination),1)):(0,n.Q3)("v-if",!0)])])])}]])},8838:(e,t,o)=>{o.d(t,{A:()=>h});var n,i=o(641),r=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],s=function(e){return-1!==r.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},a=0,l=function(e){var t=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++a+String(t)},c=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},d=function(){return{listeners:[],scriptId:l("tiny-script"),scriptLoaded:!1}},u=(n=d(),{load:function(e,t,o){n.scriptLoaded?o():(n.listeners.push(o),e.getElementById(n.scriptId)||function(e,t,o){var i=t.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=e,i.src=o;var r=function(){i.removeEventListener("load",r),n.listeners.forEach((function(e){return e()})),n.scriptLoaded=!0};i.addEventListener("load",r),t.head&&t.head.appendChild(i)}(n.scriptId,e,t))},reinitialize:function(){n=d()}}),m=function(){var e="undefined"!=typeof window?window:o.g;return e&&e.tinymce?e.tinymce:null},p={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},f=o(953),b=function(){return b=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b.apply(this,arguments)},g={selector:void 0,target:void 0};const h=(0,i.pM)({props:p,setup:function(e,t){var o=e.init?b(b({},e.init),g):b({},g),n=(0,f.QW)(e),r=n.disabled,a=n.modelValue,d=n.tagName,p=(0,f.KR)(null),h=null,v=e.id||l("tiny-vue"),y=e.init&&e.init.inline||e.inline,C=!!t.attrs["onUpdate:modelValue"],k=!0,L=e.initialValue?e.initialValue:"",_="",D=function(){var n,r,l,d=(n=k,C?function(){return(null==a?void 0:a.value)?a.value:""}:function(){return n?L:_}),u=b(b({},o),{readonly:e.disabled,target:p.value,plugins:(r=o.plugins,l=e.plugins,c(r).concat(c(l))),toolbar:e.toolbar||o.toolbar,inline:y,license_key:e.licenseKey,setup:function(n){h=n,n.on("init",(function(o){return function(e,t,o,n,r,a){n.setContent(a()),o.attrs["onUpdate:modelValue"]&&function(e,t,o,n){var r=e.modelEvents?e.modelEvents:null,s=Array.isArray(r)?r.join(" "):r;(0,i.wB)(n,(function(t,n){o&&"string"==typeof t&&t!==n&&t!==o.getContent({format:e.outputFormat})&&o.setContent(t)})),o.on(s||"change input undo redo",(function(){t.emit("update:modelValue",o.getContent({format:e.outputFormat}))}))}(t,o,n,r),function(e,t,o){Object.keys(t).filter(s).forEach((function(n){var i=t[n];"function"==typeof i&&("onInit"===n?i(e,o):o.on(n.substring(2),(function(e){return i(e,o)})))}))}(e,o.attrs,n)}(o,e,t,n,a,d)})),"function"==typeof o.setup&&o.setup(n)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(p.value)&&(p.value.style.visibility=""),m().init(u),k=!1};return(0,i.wB)(r,(function(e){var t;null!==h&&("function"==typeof(null===(t=h.mode)||void 0===t?void 0:t.set)?h.mode.set(e?"readonly":"design"):h.setMode(e?"readonly":"design"))})),(0,i.wB)(d,(function(e){var t;C||(_=h.getContent()),null===(t=m())||void 0===t||t.remove(h),(0,i.dY)((function(){return D()}))})),(0,i.sV)((function(){if(null!==m())D();else if(p.value&&p.value.ownerDocument){var t=e.cloudChannel?e.cloudChannel:"7",o=e.apiKey?e.apiKey:"no-api-key",n=null==e.tinymceScriptSrc?"https://cdn.tiny.cloud/1/".concat(o,"/tinymce/").concat(t,"/tinymce.min.js"):e.tinymceScriptSrc;u.load(p.value.ownerDocument,n,D)}})),(0,i.xo)((function(){null!==m()&&m().remove(h)})),y||((0,i.n)((function(){k||D()})),(0,i.Y4)((function(){var e;C||(_=h.getContent()),null===(e=m())||void 0===e||e.remove(h)}))),t.expose({rerender:function(e){var t;_=h.getContent(),null===(t=m())||void 0===t||t.remove(h),o=b(b(b({},o),e),g),(0,i.dY)((function(){return D()}))},getEditor:function(){return h}}),function(){return y?function(e,t,o,n){return e(n||"div",{id:t,ref:o})}(i.h,v,p,e.tagName):(0,i.h)("textarea",{id:v,visibility:"hidden",ref:p})}}})},9344:(e,t,o)=>{o.d(t,{A:()=>g});var n=o(641),i=o(33);const r={class:"object-card-list"},s={class:"object-card--detail"},a=["href","target"],l={class:"object-card--detail--link"},c={class:"object-card--detail--description"},d={class:"object-card--status"},u=["href","target"],m={class:"object-card--status--status"},p={class:"small-text"};var f=o(2124);const b={name:"RenderObjectCard",methods:{useNiceDatetime:o(246).y},props:{destination:{type:String,default:""},importVariables:{type:Object,default:()=>({header:"",prefix:"",id:0,title:"",status:""})},searchResults:{type:Array,default:()=>[]},target:{type:String,default:""}},computed:{...(0,f.L8)({rootUrl:"getRootUrl"})}},g=(0,o(6262).A)(b,[["render",function(e,t,o,f,b,g){return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("h2",null,(0,i.toDisplayString)(o.importVariables.header),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.searchResults,(t=>((0,n.uX)(),(0,n.CE)("div",{class:"object-card",key:t.pk},[(0,n.Lk)("div",s,[(0,n.Lk)("a",{href:`${e.rootUrl}${o.destination}_information/${t[o.importVariables.id]}/`,target:o.target},[(0,n.Lk)("div",l,(0,i.toDisplayString)(o.importVariables.prefix)+(0,i.toDisplayString)(t[o.importVariables.id]),1),(0,n.Lk)("div",c,(0,i.toDisplayString)(t[o.importVariables.title]),1)],8,a)]),(0,n.Lk)("div",d,[(0,n.Lk)("a",{href:`${e.rootUrl}${o.destination}_information/${t[o.importVariables.id]}/`,target:o.target},[(0,n.Lk)("div",m,(0,i.toDisplayString)(t[o.importVariables.status]),1),(0,n.Lk)("p",p,(0,i.toDisplayString)(g.useNiceDatetime(t[o.importVariables.end_date])),1)],8,u)])])))),128))])}]])}}]);