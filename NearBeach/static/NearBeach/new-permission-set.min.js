"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[614],{404:(e,i,a)=>{a.d(i,{A:()=>n});var s=a(641),t=a(33);const o={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},n=(0,a(6262).A)(o,[["render",function(e,i,a,o,n,r){return(0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.errorList,(e=>((0,s.uX)(),(0,s.CE)("span",{class:"error",key:e.$uid},(0,t.toDisplayString)(e.$message),1)))),128)}]])},4058:(e,i,a)=>{a.d(i,{A:()=>p});var s=a(641),t=a(33);const o=["src"],n={class:"organisation-name"},r=["href"],l={class:"organisation-link"},d=["href"],c={class:"organisation-email"},m=["href"];var u=a(2124),g=a(3980);const h={name:"ListOrganisations",components:{CarbonEmail:g.G2,CarbonLink:g.wX},props:{organisationResults:{type:Array,default:()=>[]}},computed:{...(0,u.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},methods:{getProfilePicture(e){const i=e.fields.organisation_profile_picture;return""===i||null===i?`${this.staticUrl}NearBeach/images/placeholder/product_tour.svg`:`${this.rootUrl}private/${i}`}}},p=(0,a(6262).A)(h,[["render",function(e,i,a,u,g,h){const p=(0,s.g2)("carbon-link"),k=(0,s.g2)("carbon-email");return(0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.organisationResults,(a=>((0,s.uX)(),(0,s.CE)("div",{key:a.id,class:"organisation-details"},[(0,s.Lk)("img",{src:h.getProfilePicture(a),alt:"Stakeholder Logo",class:"organisation-image"},null,8,o),(0,s.Lk)("div",n,[(0,s.Lk)("a",{href:`${e.rootUrl}organisation_information/${a.pk}/`},(0,t.toDisplayString)(a.fields.organisation_name),9,r)]),(0,s.Lk)("div",l,[(0,s.bF)(p),i[0]||(i[0]=(0,s.eW)(" Website: ")),(0,s.Lk)("a",{href:a.fields.organisation_website,target:"_blank",rel:"noopener noreferrer"},(0,t.toDisplayString)(a.fields.organisation_website),9,d)]),(0,s.Lk)("div",c,[(0,s.bF)(k),i[1]||(i[1]=(0,s.eW)(" Email: ")),(0,s.Lk)("a",{href:`mailto:${a.fields.organisation_email}`},(0,t.toDisplayString)(a.fields.organisation_email),9,m)])])))),128)}]])},9491:(e,i,a)=>{a.r(i),a.d(i,{default:()=>f});var s=a(641),t=a(3751);const o={class:"card"},n={class:"card-body"},r={class:"row"},l={class:"col-md-8"},d={key:0,class:"error"},c={key:1,class:"error"},m={class:"row submit-row"},u={class:"col-md-12"},g=["disabled"];var h=a(9639),p=a(3855),k=a(404),b=a(9581);const v={name:"NewPermissionSet",setup:()=>({v$:(0,h.Ay)()}),components:{ValidationRendering:k.A},props:{rootUrl:{type:String,default:"/"},theme:{type:String,default:""}},data:()=>({checkingPermissionSetName:!1,permissionSetNameModel:"",searchTimeout:"",uniquePermissionSetName:!0}),validations:{permissionSetNameModel:{required:p.mw}},watch:{permissionSetNameModel(){this.checkingPermissionSetName=!0,""!==this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((()=>{this.checkPermissionSetName()}),500)}},computed:{isSubmitDisabled(){return!this.uniquePermissionSetName||this.checkingPermissionSetName||0===this.permissionSetNameModel.length}},methods:{useNBTheme:b.p,addNewPermissionSet(){if(this.v$.$touch(),this.v$.$invalid||!this.uniquePermissionSetName)return void this.$store.dispatch("newToast",{header:"Please check all fields",message:"Failed validation. Please check all fields are validated",extra_classes:"bg-danger",delay:0});const e=new FormData;e.set("permission_set_name",this.permissionSetNameModel),this.axios.post(`${this.rootUrl}new_permission_set/save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Error adding permission set",message:`Sorry, we could not save the permission set. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},checkPermissionSetName(){const e=new FormData;e.set("search",this.permissionSetNameModel),this.axios.post(`${this.rootUrl}permission_set_information/check_permission_set_name/`,e).then((e=>{this.uniquePermissionSetName=0===e.data.length,this.checkingPermissionSetName=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to check Permission Set Name",message:`Sorry, could not check the permission set name. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}}},f=(0,a(6262).A)(v,[["render",function(e,i,a,h,p,k){const b=(0,s.g2)("validation-rendering"),v=(0,s.g2)("n-config-provider");return(0,s.uX)(),(0,s.Wv)(v,{theme:k.useNBTheme(a.theme)},{default:(0,s.k6)((()=>[(0,s.Lk)("div",o,[(0,s.Lk)("div",n,[i[4]||(i[4]=(0,s.Lk)("h1",null,"New Permission Set",-1)),i[5]||(i[5]=(0,s.Lk)("hr",null,null,-1)),(0,s.Lk)("div",r,[i[3]||(i[3]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"New Permission Set"),(0,s.Lk)("p",{class:"text-instructions"}," Please enter in a unique permission set name. Please note - all values are default permission level of 0. ")],-1)),(0,s.Lk)("div",l,[(0,s.Lk)("label",null,[i[2]||(i[2]=(0,s.eW)(" Permission Set Name ")),(0,s.bF)(b,{"error-list":h.v$.permissionSetNameModel.$errors},null,8,["error-list"]),p.uniquePermissionSetName?(0,s.Q3)("v-if",!0):((0,s.uX)(),(0,s.CE)("span",d," Please select a unique permission set name ")),p.checkingPermissionSetName?((0,s.uX)(),(0,s.CE)("span",c," Please wait. Checking Name ")):(0,s.Q3)("v-if",!0)]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=e=>p.permissionSetNameModel=e),class:"form-control"},null,512),[[t.vModelText,p.permissionSetNameModel]])])]),(0,s.Q3)(" Submit Button "),i[6]||(i[6]=(0,s.Lk)("hr",null,null,-1)),(0,s.Lk)("div",m,[(0,s.Lk)("div",u,[(0,s.Lk)("button",{class:"btn btn-primary save-changes",onClick:i[1]||(i[1]=(...e)=>k.addNewPermissionSet&&k.addNewPermissionSet(...e)),disabled:k.isSubmitDisabled}," Create new Permission Set ",8,g)])])])])])),_:1},8,["theme"])}]])},9581:(e,i,a)=>{a.d(i,{p:()=>o});var s=a(953),t=a(166);function o(e){return"dark"===(0,s.BA)(e)?t.a:null}},9840:(e,i,a)=>{a.r(i),a.d(i,{default:()=>P});var s=a(641),t=a(3751);const o={class:"card"},n={class:"card-body"},r={class:"row"},l={class:"col-md-8"},d={class:"form-group"},c={for:"id_organisation_name"},m={class:"row"},u={class:"form-group col-md-6"},g={for:"id_organisation_website"},h={class:"form-group col-md-6"},p={for:"id_organisation_email"},k={key:0,class:"row submit-row"},b={class:"col-md-12"},v={key:1},f={key:2,class:"row"},S={class:"col-md-8"},L={key:3,class:"row submit-row"},N={class:"col-md-12"},w=["disabled"];var y=a(4058),_=a(9639),O=a(3855),$=a(404);const E={name:"NewOrganisation",setup:()=>({v$:(0,_.Ay)()}),components:{ListOrganisations:y.A,ValidationRendering:$.A},props:{rootUrl:{type:String,default:"/"}},data:()=>({disableSubmitButton:!1,duplicateOrganisations:[],organisationNameModel:"",organisationWebsiteModel:"",organisationEmailModel:""}),watch:{organisationNameModel(){this.duplicateOrganisations=[]},organisationWebsiteModel(){this.duplicateOrganisations=[]},organisationEmailModel(){this.duplicateOrganisations=[]}},methods:{addOrganisation(){this.v$.$touch(),this.v$.$invalid?this.$store.dispatch("newToast",{header:"Please check validation",message:"Sorry, but can you please fix all validation issues.",extra_classes:"bg-warning text-dark",delay:0}):this.axios.post(`${this.rootUrl}organisation_duplicates/`,this.dataToSend()).then((e=>{0===e.data.length&&this.uploadOrganisationData(),this.duplicateOrganisations=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Error adding organisation",message:`Sorry, we could not add the organisation. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},dataToSend(){const e=new FormData;return e.set("organisation_name",this.organisationNameModel),e.set("organisation_website",this.organisationWebsiteModel),e.set("organisation_email",this.organisationEmailModel),e},uploadOrganisationData(){this.disableSubmitButton=!0,this.axios.post("save/",this.dataToSend()).then((e=>{window.location.href=`${this.rootUrl}organisation_information/${e.data[0].pk}/`})).catch((e=>{this.$store.dispatch("newToast",{header:"Error uploading organisation data",message:`Sorry, we could not upload the organisation data. Error -> ${e}`,extra_classes:"bg-danger",delay:0}),this.disableSubmitButton=!1}))}},validations:{organisationNameModel:{required:O.mw,maxLength:(0,O.Ru)(255)},organisationWebsiteModel:{required:O.mw,url:O.OZ},organisationEmailModel:{required:O.mw,email:O.Rp}}},P=(0,a(6262).A)(E,[["render",function(e,i,a,y,_,O){const $=(0,s.g2)("validation-rendering"),E=(0,s.g2)("list-organisations");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("div",n,[(0,s.Q3)(" TITLE "),i[11]||(i[11]=(0,s.Lk)("h1",null,"New Organisation",-1)),i[12]||(i[12]=(0,s.Lk)("hr",null,null,-1)),(0,s.Q3)(" FIELDS SECTION "),(0,s.Lk)("div",r,[i[9]||(i[9]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Description"),(0,s.Lk)("p",{class:"text-instructions"}," Please fill out all the required fields. Please only use a generic email for the organisation email field. e.g. support@companyxyz.com ")],-1)),(0,s.Lk)("div",l,[(0,s.Q3)(" ORGANISATION NAME "),(0,s.Lk)("div",d,[(0,s.Lk)("label",c,[i[5]||(i[5]=(0,s.eW)(" Organisation Name: ")),(0,s.bF)($,{"error-list":y.v$.organisationNameModel.$errors},null,8,["error-list"])]),(0,s.bo)((0,s.Lk)("input",{id:"id_organisation_name",name:"organisation_name",type:"text",class:"form-control","onUpdate:modelValue":i[0]||(i[0]=e=>_.organisationNameModel=e)},null,512),[[t.vModelText,_.organisationNameModel]])]),i[8]||(i[8]=(0,s.Lk)("br",null,null,-1)),(0,s.Lk)("div",m,[(0,s.Q3)(" ORGANISATION WEBSITE "),(0,s.Lk)("div",u,[(0,s.Lk)("label",g,[i[6]||(i[6]=(0,s.eW)(" Organisation Website: ")),(0,s.bF)($,{"error-list":y.v$.organisationWebsiteModel.$errors},null,8,["error-list"])]),(0,s.bo)((0,s.Lk)("input",{id:"id_organisation_website",name:"organisation_website",type:"url",class:"form-control","onUpdate:modelValue":i[1]||(i[1]=e=>_.organisationWebsiteModel=e)},null,512),[[t.vModelText,_.organisationWebsiteModel]])]),(0,s.Q3)(" ORGANISATION EMAIL "),(0,s.Lk)("div",h,[(0,s.Lk)("label",p,[i[7]||(i[7]=(0,s.eW)(" Organisation Email: ")),(0,s.bF)($,{"error-list":y.v$.organisationEmailModel.$errors},null,8,["error-list"])]),(0,s.bo)((0,s.Lk)("input",{id:"id_organisation_email",name:"organisation_email",type:"email",class:"form-control","onUpdate:modelValue":i[2]||(i[2]=e=>_.organisationEmailModel=e)},null,512),[[t.vModelText,_.organisationEmailModel]])])])])]),i[13]||(i[13]=(0,s.Lk)("hr",null,null,-1)),(0,s.Q3)(" SUBMIT ORGANISATION BUTTON "),0==_.duplicateOrganisations.length?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("div",b,[(0,s.Lk)("button",{class:"btn btn-primary save-changes",onClick:i[3]||(i[3]=(...e)=>O.addOrganisation&&O.addOrganisation(...e))}," Add Organisation ")])])):(0,s.Q3)("v-if",!0),_.duplicateOrganisations.length>0?((0,s.uX)(),(0,s.CE)("h2",v," Potential Duplication ")):(0,s.Q3)("v-if",!0),_.duplicateOrganisations.length>0?((0,s.uX)(),(0,s.CE)("div",f,[(0,s.Q3)(" PLEASE READ "),i[10]||(i[10]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Please Read"),(0,s.Lk)("p",{class:"text-instructions"},' The server has found potential duplications. Please review the following Organisations. If you would like to create the organisation, please scroll to the bottom of the page and hit "Submit Organisation". If the organisation you are looking for is already created. Click on the name and you will be taken to the Organisation\'s Information page. '),(0,s.Lk)("strong",null,"Alternatively"),(0,s.Lk)("p",{class:"text-instructions"}," You can also change the information above and resubmit. ")],-1)),(0,s.Q3)(" DUPLICATE ORGANISATION LIST "),(0,s.Lk)("div",S,[(0,s.bF)(E,{"organisation-results":_.duplicateOrganisations,"root-url":a.rootUrl},null,8,["organisation-results","root-url"])])])):(0,s.Q3)("v-if",!0),(0,s.Q3)(" STILL SUBMIT ORGANISATION "),_.duplicateOrganisations.length>0?((0,s.uX)(),(0,s.CE)("div",L,[(0,s.Lk)("div",N,[(0,s.Lk)("button",{class:"btn btn-primary save-changes",onClick:i[4]||(i[4]=(...e)=>O.uploadOrganisationData&&O.uploadOrganisationData(...e)),disabled:_.disableSubmitButton}," Submit Organisation ",8,w)])])):(0,s.Q3)("v-if",!0)])])}]])}}]);