"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[4641],{4641:(e,t,s)=>{s.d(t,{A:()=>ve});var o=s(641),a=s(33);const r={class:"text-instructions"},i={key:0,class:"alert alert-info"},d={key:1,class:"alert alert-dark"},l={key:2,class:"group-card-list"},n={class:"group-card--details"},u={key:0,class:"group-card--remove"},c={key:0,class:"group-card"},p={class:"row submit-row"},m={class:"col-md-12"},g={class:"text-instructions"},h={key:3,class:"row submit-row"},b={class:"col-md-12"};var L=s(2243),k=s(2321),v=s(9336);const U={class:"modal fade",id:"addGroupModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},y={class:"modal-dialog modal-lg"},f={class:"modal-content"},G={class:"modal-header"},_={class:"modal-body"},C={key:0,class:"row"},A={class:"col-md-4"},D={class:"text-instructions"},j={class:"text-instructions"},w={class:"col-md-8"},S={key:1,class:"row"},I={class:"col-md-6 no-search"},$=["src"],E={class:"modal-footer"},x=["disabled"];var F=s(1080),M=s(2124);const T={name:"AddGroupWizard",components:{Icon:k.In,NSelect:F.A},computed:{...(0,M.L8)({destination:"getDestination",locationId:"getLocationId",potentialGroupList:"getPotentialGroupList",rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},watch:{potentialGroupList(e){void 0!==e&&(this.groupFixList=e.map((e=>({value:e.group_id,label:e.group_name}))))}},mixins:[L.A],data:()=>({groupFixList:[],groupModel:[]}),methods:{addGroup(){this.$store.commit("updateAddingGroupStatus",{addingGroupStatus:!0});const e=new FormData;this.groupModel.forEach((t=>{e.append("group_list",t)})),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_group/`,e).then((e=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list}),this.$store.commit("updateAddingGroupStatus",{addingGroupStatus:!1}),this.groupModel=[],document.getElementById("addGroupCloseButton").click()})).catch((e=>{this.$store.dispatch("newToast",{header:`Error adding group to ${this.destination}`,message:`Sorry, we could not add the group to the ${this.destination}. Error -> ${e}`,extra_classes:"bd-danger",delay:0})}))}}};var X=s(6262);const B=(0,X.A)(T,[["render",function(e,t,s,r,i,d){const l=(0,o.g2)("Icon"),n=(0,o.g2)("n-select");return(0,o.uX)(),(0,o.CE)("div",U,[(0,o.Lk)("div",y,[(0,o.Lk)("div",f,[(0,o.Lk)("div",G,[(0,o.Lk)("h2",null,[(0,o.bF)(l,{icon:e.icons.groupPresentation},null,8,["icon"]),t[2]||(t[2]=(0,o.eW)(" Add Group Wizard "))]),t[3]||(t[3]=(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addGroupCloseButton"},[(0,o.Lk)("span",{"aria-hidden":"true"})],-1))]),(0,o.Lk)("div",_,[i.groupFixList.length>0?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",A,[t[4]||(t[4]=(0,o.Lk)("strong",null,"Add Groups",-1)),(0,o.Lk)("p",D," Use the following multiple select to select which groups you want to add to this "+(0,a.toDisplayString)(e.destination)+". ",1),(0,o.Lk)("p",j," Please note: A user's group has to be added to the "+(0,a.toDisplayString)(e.destination)+" before the user can be added. ",1)]),(0,o.Lk)("div",w,[(0,o.bF)(n,{options:i.groupFixList,value:i.groupModel,"onUpdate:value":t[0]||(t[0]=e=>i.groupModel=e),multiple:""},null,8,["options","value"])])])):((0,o.uX)(),(0,o.CE)("div",S,[t[5]||(t[5]=(0,o.Lk)("div",{class:"col-md-6"},[(0,o.Lk)("strong",null,"Sorry - no results"),(0,o.Lk)("p",{class:"text-instructions"}," This could be because "),(0,o.Lk)("ul",{class:"text-instructions"},[(0,o.Lk)("li",null,"There are no more groups left to add")])],-1)),(0,o.Lk)("div",I,[(0,o.Lk)("img",{src:`${e.staticUrl}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,$)])]))]),(0,o.Lk)("div",E,[t[6]||(t[6]=(0,o.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0==i.groupModel.length,onClick:t[1]||(t[1]=(...e)=>d.addGroup&&d.addGroup(...e))}," Add Group(s) ",8,x)])])])])}]]),R={class:"modal fade",id:"addUserModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},N={class:"modal-dialog modal-lg"},O={class:"modal-content"},Q={class:"modal-header"},P={class:"modal-body"},W={key:0,class:"row"},z={class:"col-md-4"},K={class:"text-instructions"},q={class:"text-instructions"},Y={class:"col-md-8"},H={key:1,class:"row"},J={class:"col-md-6"},V={class:"text-instructions"},Z={class:"col-md-6 no-search"},ee=["src"],te={class:"modal-footer"},se=["disabled"],oe={name:"AddUserWizard",components:{Icon:k.In,NSelect:F.A},mixins:[L.A],computed:{...(0,M.L8)({destination:"getDestination",locationId:"getLocationId",potentialUserList:"getPotentialUserList",rootUrl:"getRootUrl",staticURL:"getStaticUrl",userLevel:"getUserLevel"})},data:()=>({userFixList:[],userModel:[]}),watch:{potentialUserList(e){void 0!==e&&(this.userFixList=e.map((e=>({value:e.id,label:`${e.username}: ${e.first_name} ${e.last_name}`}))))}},methods:{addUser(){this.$store.commit("updateAddingUserStatus",{addingUserStatus:!0});const e=new FormData;this.userModel.forEach((t=>{e.append("user_list",t)})),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_user/`,e).then((e=>{document.getElementById("addUserCloseButton").click(),this.userModel=[],this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list}),this.$store.commit("updateAddingUserStatus",{addingUserStatus:!1})})).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to add user",message:`Failed to add user. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}}},ae=(0,X.A)(oe,[["render",function(e,t,s,r,i,d){const l=(0,o.g2)("Icon"),n=(0,o.g2)("n-select");return(0,o.uX)(),(0,o.CE)("div",R,[(0,o.Lk)("div",N,[(0,o.Lk)("div",O,[(0,o.Lk)("div",Q,[(0,o.Lk)("h2",null,[(0,o.bF)(l,{icon:e.icons.userIcon},null,8,["icon"]),t[2]||(t[2]=(0,o.eW)(" Add User Wizard "))]),t[3]||(t[3]=(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addUserCloseButton"},[(0,o.Lk)("span",{"aria-hidden":"true"})],-1))]),(0,o.Lk)("div",P,[i.userFixList.length>0?((0,o.uX)(),(0,o.CE)("div",W,[(0,o.Lk)("div",z,[t[4]||(t[4]=(0,o.Lk)("strong",null,"Add Users",-1)),(0,o.Lk)("p",K," Use the following multiple select to select which users you want to add to this "+(0,a.toDisplayString)(e.destination)+". ",1),(0,o.Lk)("p",q," Please note: A user's group has to be added to the "+(0,a.toDisplayString)(e.destination)+" before the user can be added. ",1)]),(0,o.Lk)("div",Y,[(0,o.bF)(n,{options:i.userFixList,value:i.userModel,"onUpdate:value":t[0]||(t[0]=e=>i.userModel=e),multiple:""},null,8,["options","value"])])])):((0,o.uX)(),(0,o.CE)("div",H,[(0,o.Lk)("div",J,[t[6]||(t[6]=(0,o.Lk)("strong",null,"Sorry - no results",-1)),t[7]||(t[7]=(0,o.Lk)("p",{class:"text-instructions"}," This could be because ",-1)),(0,o.Lk)("ul",V,[t[5]||(t[5]=(0,o.Lk)("li",null,"There are no more users left to add",-1)),(0,o.Lk)("li",null," The user you are after is in a group not current added to this "+(0,a.toDisplayString)(e.destination),1)])]),(0,o.Lk)("div",Z,[(0,o.Lk)("img",{src:`${e.staticURL}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,ee)])]))]),(0,o.Lk)("div",te,[t[8]||(t[8]=(0,o.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0===i.userModel.length,onClick:t[1]||(t[1]=(...e)=>d.addUser&&d.addUser(...e))}," Add User(s) ",8,se)])])])])}]]),re={class:"modal fade",id:"confirmGroupDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmGroupDelete","aria-hidden":"true"},ie={class:"modal-dialog"},de={class:"modal-content"},le={class:"modal-footer"},ne={name:"ConfirmGroupDelete",props:{groupId:{type:Number,default:0}},computed:{...(0,M.L8)({destination:"getDestination",locationId:"getLocationId",objectGroupList:"getObjectGroupList",rootUrl:"getRootUrl"})},methods:{deleteGroup(){this.$store.commit("updateGroupsAndUsers",{objectGroupList:this.objectGroupList.filter((e=>e.group_id!==this.groupId))});const e=new FormData;e.set("group_id",`${this.groupId}`),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_group/`,e).then((e=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error removing group from object",message:`We encounted an error moving the group from the object. Error -> ${e}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmGroupDeleteButton").click()}}},ue=(0,X.A)(ne,[["render",function(e,t,s,a,r,i){return(0,o.uX)(),(0,o.CE)("div",re,[(0,o.Lk)("div",ie,[(0,o.Lk)("div",de,[t[2]||(t[2]=(0,o.Lk)("div",{class:"modal-header"},[(0,o.Lk)("h5",{class:"modal-title",id:"confirmGroupDelete"}," Please confirm Group Deletion "),(0,o.Q3)(" TASK INFORMATION "),(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmGroupDeleteButton"})],-1)),t[3]||(t[3]=(0,o.Lk)("div",{class:"modal-body"}," Are you sure you want to delete the Group from the object? ",-1)),(0,o.Lk)("div",le,[(0,o.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>i.closeModal&&i.closeModal(...e))}," No "),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>i.deleteGroup&&i.deleteGroup(...e))}," Yes ")])])])])}]]),ce={class:"modal fade",id:"confirmUserDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmUserDelete","aria-hidden":"true"},pe={class:"modal-dialog"},me={class:"modal-content"},ge={class:"modal-footer"},he={name:"ConfirmUserDelete",props:{username:{type:String,default:""}},computed:{...(0,M.L8)({destination:"getDestination",locationId:"getLocationId",objectUserList:"getObjectUserList",rootUrl:"getRootUrl"})},methods:{deleteUser(){this.$store.commit("updateGroupsAndUsers",{objectUserList:this.objectUserList.filter((e=>e.username!==this.username))});const e=new FormData;e.set("username",this.username),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_user/`,e).then((e=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error removing user from object",message:`We encounted an error moving the user from the object. Error -> ${e}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmUserDeleteButton").click()}}},be=(0,X.A)(he,[["render",function(e,t,s,a,r,i){return(0,o.uX)(),(0,o.CE)("div",ce,[(0,o.Lk)("div",pe,[(0,o.Lk)("div",me,[t[2]||(t[2]=(0,o.Lk)("div",{class:"modal-header"},[(0,o.Lk)("h5",{class:"modal-title",id:"confirmUserDelete"}," Please confirm User Deletion "),(0,o.Q3)(" TASK INFORMATION "),(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmUserDeleteButton"})],-1)),t[3]||(t[3]=(0,o.Lk)("div",{class:"modal-body"}," Are you sure you want to delete the User from the object? ",-1)),(0,o.Lk)("div",ge,[(0,o.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>i.closeModal&&i.closeModal(...e))}," No "),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>i.deleteUser&&i.deleteUser(...e))}," Yes ")])])])])}]]);var Le=s(8072);const ke={name:"GroupsAndUsersModule",components:{AddGroupWizard:B,AddUserWizard:ae,ConfirmGroupDelete:ue,ConfirmUserDelete:be,Icon:k.In,RenderUserCardList:Le.A},props:{isReadOnly:{type:Boolean,default:!1}},data:()=>({deleteGroupId:0,deleteUsername:"",destinationTitle:"",loadingData:!0}),computed:{...(0,M.L8)({addingGroupStatus:"getAddingGroupStatus",addingUserStatus:"getAddingUserStatus",destination:"getDestination",locationId:"getLocationId",objectGroupList:"getObjectGroupList",objectUserList:"getObjectUserList",rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"})},mixins:[L.A],methods:{addNewGroup(){new v.aF(document.getElementById("addGroupModal")).show()},addNewUser(){new v.aF(document.getElementById("addUserModal")).show()},getGroupAndUserData(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/group_and_user_data/`).then((e=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:e.data.object_group_list,objectUserList:e.data.object_user_list,potentialGroupList:e.data.potential_group_list,potentialUserList:e.data.potential_user_list}),this.loadingData=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Error fetching group and user data",message:`Sorry we could not get any group or user data. Error -> ${e}`,extra_classes:"bd-danger",delay:0})}))},removeGroup(e){this.deleteGroupId=e,new v.aF(document.getElementById("confirmGroupDeleteModal")).show()},removeUser(e){this.deleteUsername=e,new v.aF(document.getElementById("confirmUserDeleteModal")).show()}},mounted(){this.$nextTick((()=>{if(0===this.locationId)return void setTimeout((()=>{this.getGroupAndUserData()}),500);this.getGroupAndUserData();let e=this.destination;e=e.replaceAll("_"," "),this.destinationTitle=e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))}))}},ve=(0,X.A)(ke,[["render",function(e,t,s,L,k,v){const U=(0,o.g2)("Icon"),y=(0,o.g2)("render-user-card-list"),f=(0,o.g2)("add-group-wizard"),G=(0,o.g2)("add-user-wizard"),_=(0,o.g2)("confirm-group-delete"),C=(0,o.g2)("confirm-user-delete");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Q3)(" GROUPS "),(0,o.Lk)("h2",null,[(0,o.bF)(U,{icon:e.icons.groupPresentation},null,8,["icon"]),t[2]||(t[2]=(0,o.eW)(" Groups "))]),(0,o.Lk)("p",r," The following list are all the Groups connected to this "+(0,a.toDisplayString)(k.destinationTitle)+". Users will have to be included in these groups to be added to this "+(0,a.toDisplayString)(k.destinationTitle),1),k.loadingData?((0,o.uX)(),(0,o.CE)("div",i," Currently loading group data. ")):0!==e.objectGroupList.length||e.addingGroupStatus?((0,o.uX)(),(0,o.CE)("div",l,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.objectGroupList,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.group_id,class:"group-card"},[(0,o.Lk)("div",n,(0,a.toDisplayString)(t.group_name),1),e.userLevel>=3&&e.objectGroupList.length>1?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(U,{icon:e.icons.trashCan,onClick:e=>v.removeGroup(t.group_id)},null,8,["icon","onClick"])])):(0,o.Q3)("v-if",!0)])))),128)),e.addingGroupStatus?((0,o.uX)(),(0,o.CE)("div",c,t[3]||(t[3]=[(0,o.Lk)("div",{class:"group-card--details"},"++ Adding New Group ++",-1)]))):(0,o.Q3)("v-if",!0)])):((0,o.uX)(),(0,o.CE)("div",d," Sorry - there are no groups active. ")),t[5]||(t[5]=(0,o.Lk)("div",{class:"spacer"},null,-1)),(0,o.Q3)(" ADD GROUP "),(0,o.Q3)(" TO DO - limit it to certain users "),(0,o.Lk)("div",p,[(0,o.Lk)("div",m,[e.userLevel>1&&!s.isReadOnly?((0,o.uX)(),(0,o.CE)("a",{key:0,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[0]||(t[0]=(...e)=>v.addNewGroup&&v.addNewGroup(...e))},"Add Group to "+(0,a.toDisplayString)(k.destinationTitle),1)):(0,o.Q3)("v-if",!0)])]),t[6]||(t[6]=(0,o.Lk)("hr",null,null,-1)),(0,o.Q3)(" USERS "),(0,o.Lk)("h2",null,[(0,o.bF)(U,{icon:e.icons.userIcon},null,8,["icon"]),t[4]||(t[4]=(0,o.eW)(" Users "))]),(0,o.Lk)("p",g," The following are a list of users who are connected to this "+(0,a.toDisplayString)(k.destinationTitle)+". Please note - users have to be a part of the groups list above. ",1),(0,o.bF)(y,{"adding-user-status":e.addingUserStatus,"loading-data":k.loadingData,"object-user-list":e.objectUserList,onRemove_user:v.removeUser},null,8,["adding-user-status","loading-data","object-user-list","onRemove_user"]),t[7]||(t[7]=(0,o.Lk)("div",{class:"spacer"},null,-1)),(0,o.Q3)(" TO DO - limit it to certain users "),e.userLevel>1&&!s.isReadOnly?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("div",b,[(0,o.Lk)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[1]||(t[1]=(...e)=>v.addNewUser&&v.addNewUser(...e))},"Add User to "+(0,a.toDisplayString)(k.destinationTitle),1)])])):(0,o.Q3)("v-if",!0),(0,o.Q3)(" MODALS "),(0,o.bF)(f),(0,o.bF)(G),(0,o.bF)(_,{"group-id":k.deleteGroupId},null,8,["group-id"]),(0,o.bF)(C,{username:k.deleteUsername},null,8,["username"])])}]])},8072:(e,t,s)=>{s.d(t,{A:()=>k});var o=s(641),a=s(33);const r={key:0,class:"alert alert-info"},i={key:1,class:"alert alert-dark"},d={key:2,class:"user-card-list"},l=["src"],n={class:"user-card--details"},u={class:"user-card--name"},c={class:"user-card--email"},p={key:0,class:"user-card--remove"},m={key:0,class:"user-card"};var g=s(2124),h=s(2321),b=s(2243);const L={name:"RenderUserCardList",components:{Icon:h.In},props:{addingUserStatus:{type:Boolean,default:!1},loadingData:{type:Boolean,default:!1},objectUserList:{type:Array,default:()=>[]}},mixins:[b.A],computed:{...(0,g.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"})},methods:{profilePicture(e){return null!==e&&""!==e?`${this.rootUrl}private/${e}/`:`${this.staticUrl}NearBeach/images/placeholder/people_tax.svg`},removeUser(e){this.$emit("remove_user",e)}}},k=(0,s(6262).A)(L,[["render",function(e,t,s,g,h,b){const L=(0,o.g2)("Icon");return s.loadingData?((0,o.uX)(),(0,o.CE)("div",r," Currently loading User Data. ")):0!==s.objectUserList.length||s.addingUserStatus?((0,o.uX)(),(0,o.CE)("div",d,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.objectUserList,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.username,class:"user-card"},[(0,o.Lk)("img",{src:b.profilePicture(t.profile_picture),alt:"default profile",class:"user-card--profile"},null,8,l),(0,o.Lk)("div",n,[(0,o.Lk)("div",u,(0,a.toDisplayString)(t.first_name)+" "+(0,a.toDisplayString)(t.last_name),1),(0,o.Lk)("div",c,(0,a.toDisplayString)(t.email),1)]),e.userLevel>=3?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.bF)(L,{icon:e.icons.trashCan,onClick:e=>b.removeUser(t.username)},null,8,["icon","onClick"])])):(0,o.Q3)("v-if",!0)])))),128)),s.addingUserStatus?((0,o.uX)(),(0,o.CE)("div",m,t[0]||(t[0]=[(0,o.Lk)("div",{class:"user-card--details"},"++ Adding User(s) ++",-1)]))):(0,o.Q3)("v-if",!0)])):((0,o.uX)(),(0,o.CE)("div",i," Sorry, there are no users currently assigned to this object. "))}]])}}]);