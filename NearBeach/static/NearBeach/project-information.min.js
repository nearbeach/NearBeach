"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[7355],{8838:(e,t,o)=>{o.d(t,{A:()=>v});var n,a=o(641),r=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],s=function(e){return-1!==r.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},i=0,l=function(e){var t=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++i+String(t)},d=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},c=function(){return{listeners:[],scriptId:l("tiny-script"),scriptLoaded:!1}},u=(n=c(),{load:function(e,t,o){n.scriptLoaded?o():(n.listeners.push(o),e.getElementById(n.scriptId)||function(e,t,o){var a=t.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=e,a.src=o;var r=function(){a.removeEventListener("load",r),n.listeners.forEach((function(e){return e()})),n.scriptLoaded=!0};a.addEventListener("load",r),t.head&&t.head.appendChild(a)}(n.scriptId,e,t))},reinitialize:function(){n=c()}}),p=function(){var e="undefined"!=typeof window?window:o.g;return e&&e.tinymce?e.tinymce:null},m={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},h=o(953),g=function(){return g=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var a in t=arguments[o])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},g.apply(this,arguments)},f={selector:void 0,target:void 0};const v=(0,a.pM)({props:m,setup:function(e,t){var o=e.init?g(g({},e.init),f):g({},f),n=(0,h.QW)(e),r=n.disabled,i=n.modelValue,c=n.tagName,m=(0,h.KR)(null),v=null,y=e.id||l("tiny-vue"),k=e.init&&e.init.inline||e.inline,S=!!t.attrs["onUpdate:modelValue"],b=!0,D=e.initialValue?e.initialValue:"",j="",M=function(){var n,r,l,c=(n=b,S?function(){return(null==i?void 0:i.value)?i.value:""}:function(){return n?D:j}),u=g(g({},o),{readonly:e.disabled,target:m.value,plugins:(r=o.plugins,l=e.plugins,d(r).concat(d(l))),toolbar:e.toolbar||o.toolbar,inline:k,license_key:e.licenseKey,setup:function(n){v=n,n.on("init",(function(o){return function(e,t,o,n,r,i){n.setContent(i()),o.attrs["onUpdate:modelValue"]&&function(e,t,o,n){var r=e.modelEvents?e.modelEvents:null,s=Array.isArray(r)?r.join(" "):r;(0,a.wB)(n,(function(t,n){o&&"string"==typeof t&&t!==n&&t!==o.getContent({format:e.outputFormat})&&o.setContent(t)})),o.on(s||"change input undo redo",(function(){t.emit("update:modelValue",o.getContent({format:e.outputFormat}))}))}(t,o,n,r),function(e,t,o){Object.keys(t).filter(s).forEach((function(n){var a=t[n];"function"==typeof a&&("onInit"===n?a(e,o):o.on(n.substring(2),(function(e){return a(e,o)})))}))}(e,o.attrs,n)}(o,e,t,n,i,c)})),"function"==typeof o.setup&&o.setup(n)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(m.value)&&(m.value.style.visibility=""),p().init(u),b=!1};return(0,a.wB)(r,(function(e){var t;null!==v&&("function"==typeof(null===(t=v.mode)||void 0===t?void 0:t.set)?v.mode.set(e?"readonly":"design"):v.setMode(e?"readonly":"design"))})),(0,a.wB)(c,(function(e){var t;S||(j=v.getContent()),null===(t=p())||void 0===t||t.remove(v),(0,a.dY)((function(){return M()}))})),(0,a.sV)((function(){if(null!==p())M();else if(m.value&&m.value.ownerDocument){var t=e.cloudChannel?e.cloudChannel:"7",o=e.apiKey?e.apiKey:"no-api-key",n=null==e.tinymceScriptSrc?"https://cdn.tiny.cloud/1/".concat(o,"/tinymce/").concat(t,"/tinymce.min.js"):e.tinymceScriptSrc;u.load(m.value.ownerDocument,n,M)}})),(0,a.xo)((function(){null!==p()&&p().remove(v)})),k||((0,a.n)((function(){b||M()})),(0,a.Y4)((function(){var e;S||(j=v.getContent()),null===(e=p())||void 0===e||e.remove(v)}))),t.expose({rerender:function(e){var t;j=v.getContent(),null===(t=p())||void 0===t||t.remove(v),o=g(g(g({},o),e),f),(0,a.dY)((function(){return M()}))},getEditor:function(){return v}}),function(){return k?function(e,t,o,n){return e(n||"div",{id:t,ref:o})}(a.h,y,m,e.tagName):(0,a.h)("textarea",{id:y,visibility:"hidden",ref:m})}}})},5318:(e,t,o)=>{o.d(t,{A:()=>y});var n=o(641),a=o(33);const r={class:"row"},s={class:"col-md-4"},i={class:"text-instructions"},l={class:"col-md-4"},d={class:"form-group"},c={class:"col-md-4"},u={class:"form-group"};var p=o(8105),m=o(9639),h=o(3855),g=o(404),f=o(2124);const v={name:"BetweenDates",setup:()=>({v$:(0,m.Ay)()}),components:{NDatePicker:p.A,ValidationRendering:g.A},emits:["update_dates"],props:{destination:{type:String,default:""},endDateModel:{type:Number,default:()=>{const e=new Date;return e.setHours(16),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.getTime()}},isReadOnly:{type:Boolean,default:!1},startDateModel:{type:Number,default:()=>{const e=new Date;return e.setHours(9),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.getTime()}}},computed:{...(0,f.L8)({userLevel:"getUserLevel"})},validations:{localEndDateModel:{required:h.mw},localStartDateModel:{required:h.mw}},data(){return{localEndDateModel:this.endDateModel,localStartDateModel:this.startDateModel}},methods:{emitDates(){this.$emit("update_dates",{start_date:this.localStartDateModel,end_date:this.localEndDateModel})}},watch:{localEndDateModel(){this.localEndDateModel<this.localStartDateModel&&(this.localStartDateModel=this.localEndDateModel-864e5),this.emitDates()},localStartDateModel(){this.localStartDateModel>this.localEndDateModel&&(this.localEndDateModel=this.localStartDateModel+864e5),this.emitDates()}},mounted(){this.emitDates()}},y=(0,o(6262).A)(v,[["render",function(e,t,o,p,m,h){const g=(0,n.g2)("validation-rendering"),f=(0,n.g2)("n-date-picker");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Lk)("div",s,[t[2]||(t[2]=(0,n.Lk)("strong",null,"Between Dates",-1)),(0,n.Lk)("p",i," Choose the start and end date of the "+(0,a.toDisplayString)(o.destination)+". Please note the end date can not be earlier than the start date. They can be equal. ",1)]),(0,n.Lk)("div",l,[(0,n.Lk)("div",d,[(0,n.Lk)("label",null,[(0,n.eW)((0,a.toDisplayString)(o.destination)+" Start Date: ",1),(0,n.bF)(g,{"error-list":p.v$.localStartDateModel.$errors},null,8,["error-list"])]),(0,n.bF)(f,{type:"datetime",value:m.localStartDateModel,"onUpdate:value":t[0]||(t[0]=e=>m.localStartDateModel=e),disabled:e.userLevel<=1||o.isReadOnly},null,8,["value","disabled"])])]),(0,n.Lk)("div",c,[(0,n.Lk)("div",u,[(0,n.Lk)("label",null,[(0,n.eW)((0,a.toDisplayString)(o.destination)+" End Date: ",1),(0,n.bF)(g,{"error-list":p.v$.localEndDateModel.$errors},null,8,["error-list"])]),(0,n.bF)(f,{type:"datetime",value:m.localEndDateModel,"onUpdate:value":t[1]||(t[1]=e=>m.localEndDateModel=e),disabled:e.userLevel<=1||o.isReadOnly},null,8,["value","disabled"])])])])}]])},891:(e,t,o)=>{o.d(t,{A:()=>v});var n=o(641),a=o(33);const r={class:"row"},s={class:"col-md-8 organisation-details"},i=["src"],l={class:"organisation-name"},d=["href"],c={class:"organisation-link"},u=["href"],p={class:"organisation-email"},m=["href"];var h=o(2124),g=o(3980);const f={name:"StakeholderInformation",components:{CarbonEmail:g.G2,CarbonLink:g.wX},props:{defaultStakeholderImage:{type:String,default:""},organisationResults:{type:Array,default:()=>[]}},data(){return{stakeholderModel:this.organisationResults[0].fields}},computed:{...(0,h.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"}),getStakeholderImage(){const e=this.stakeholderModel.organisation_profile_picture;return""===e||null===e?this.defaultStakeholderImage:`${this.rootUrl}private/${e}`}}},v=(0,o(6262).A)(f,[["render",function(e,t,o,h,g,f){const v=(0,n.g2)("carbon-link"),y=(0,n.g2)("carbon-email");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.Q3)(" Description "),t[2]||(t[2]=(0,n.Lk)("div",{class:"col-md-4"},[(0,n.Lk)("h2",null,"Stakeholder")],-1)),(0,n.Lk)("div",s,[(0,n.Lk)("img",{src:f.getStakeholderImage,alt:"Stakeholder Logo",class:"organisation-image"},null,8,i),(0,n.Lk)("div",l,[(0,n.Lk)("a",{href:`${e.rootUrl}organisation_information/${o.organisationResults[0].pk}/`},(0,a.toDisplayString)(g.stakeholderModel.organisation_name),9,d)]),(0,n.Lk)("div",c,[(0,n.bF)(v),t[0]||(t[0]=(0,n.eW)(" Website: ")),(0,n.Lk)("a",{href:g.stakeholderModel.organisation_website,target:"_blank",rel:"noopener noreferrer"},(0,a.toDisplayString)(g.stakeholderModel.organisation_website),9,u)]),(0,n.Lk)("div",p,[(0,n.bF)(y),t[1]||(t[1]=(0,n.eW)(" Email: ")),(0,n.Lk)("a",{href:`mailto:${g.stakeholderModel.organisation_email}`},(0,a.toDisplayString)(g.stakeholderModel.organisation_email),9,m)])])])}]])},1798:(e,t,o)=>{o.r(t),o.d(t,{default:()=>E});var n=o(641),a=o(3751);const r={class:"card"},s={class:"card-body project-border"},i={key:0,class:"alert alert-info"},l={class:"row"},d={class:"col-md-8",style:{"min-height":"610px"}},c={class:"form-group"},u=["disabled"],p=["src"],m={class:"row"},h={class:"col-md-4"},g={key:1},f={key:2,class:"row submit-row"},v={class:"col-md-12"};var y=o(1080),k=o(5318),S=o(891),b=o(8838),D=o(2124),j=o(9639),M=o(3855),L=o(404),C=o(9581),w=o(2595);const _={name:"ProjectInformation",setup:()=>({v$:(0,j.Ay)()}),components:{BetweenDates:k.A,editor:b.A,NSelect:y.A,StakeholderInformation:S.A,ValidationRendering:L.A},props:{defaultStakeholderImage:{type:String,default:""},organisationResults:{type:Array,default:()=>[]},projectIsClosed:{type:Boolean,default:!1},projectResults:{type:Array,default:()=>[]},statusOptions:{type:Array,default:()=>[]},theme:{type:String,default:""},userLevel:{type:Number,default:1}},computed:{...(0,D.L8)({contentCss:"getContentCss",rootUrl:"getRootUrl",skin:"getSkin",staticUrl:"getStaticUrl"})},watch:{async projectStatusModel(){this.projectIsClosed&&(this.checkStatusIsClosed()||(await this.updateProject(),window.location.reload()))}},data(){return{isReadOnly:!1,projectDescriptionModel:this.projectResults[0].fields.project_description,projectEndDateModel:new Date(this.projectResults[0].fields.project_end_date),projectNameModel:this.projectResults[0].fields.project_name,projectStartDateModel:new Date(this.projectResults[0].fields.project_start_date),projectStatusModel:this.projectResults[0].fields.project_status}},validations:{projectDescriptionModel:{required:M.mw,maxLength:(0,M.Ru)(63e4)},projectEndDateModel:{required:M.mw},projectNameModel:{maxLength:(0,M.Ru)(255),required:M.mw},projectStartDateModel:{required:M.mw}},methods:{useUploadImage:w.A,useNBTheme:C.p,checkStatusIsClosed(){const e=this.statusOptions.filter((e=>parseInt(e.value)===parseInt(this.projectStatusModel)));return 0===e.length||"Closed"===e[0].project_higher_order_status},setReadOnly(){(this.checkStatusIsClosed()||this.userLevel<=1)&&(this.isReadOnly=!0)},updateDates(e){this.projectEndDateModel=new Date(e.end_date),this.projectStartDateModel=new Date(e.start_date)},async updateProject(){if(!await this.v$.$validate())return;const e=new FormData;e.set("project_description",this.projectDescriptionModel),e.set("project_end_date",this.projectEndDateModel.toISOString()),e.set("project_name",this.projectNameModel),e.set("project_start_date",this.projectStartDateModel.toISOString()),e.set("project_status",this.projectStatusModel),this.$store.dispatch("newToast",{header:"Project Currently Saving",message:"Please wait whilst we save the project",extra_classes:"bg-warning text-dark",unique_type:"save",delay:0}),this.axios.post(`${this.rootUrl}project_information/${this.projectResults[0].pk}/save/`,e).then((()=>{this.$store.dispatch("newToast",{header:"Project Saved",message:"Project Saved",extra_classes:"bg-success",unique_type:"save"}),this.checkStatusIsClosed()&&window.location.reload()})).catch((e=>{this.$store.dispatch("newToast",{header:"Project Could not save",message:`There was an error saving the project. Error -> ${e}`,extra_classes:"bg-danger",unique_type:"save",delay:0})}))}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.setReadOnly()}},E=(0,o(6262).A)(_,[["render",function(e,t,o,y,k,S){const b=(0,n.g2)("validation-rendering"),D=(0,n.g2)("editor"),j=(0,n.g2)("n-select"),M=(0,n.g2)("stakeholder-information"),L=(0,n.g2)("between-dates"),C=(0,n.g2)("n-config-provider");return(0,n.uX)(),(0,n.Wv)(C,{theme:S.useNBTheme(o.theme)},{default:(0,n.k6)((()=>[(0,n.Lk)("div",r,[(0,n.Lk)("div",s,[t[11]||(t[11]=(0,n.Lk)("h1",null,"Project Information",-1)),t[12]||(t[12]=(0,n.Lk)("hr",null,null,-1)),o.projectIsClosed?((0,n.uX)(),(0,n.CE)("div",i," Project is currently closed ")):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",l,[(0,n.Q3)(" DESCRIPTION "),t[9]||(t[9]=(0,n.Lk)("div",{class:"col-md-4"},[(0,n.Lk)("h2",null,"Description"),(0,n.Lk)("p",{class:"text-instructions"},' Edit the project information and then click the "Update Project" button at the bottom of the page ')],-1)),(0,n.Q3)(" PROJECT FORM "),(0,n.Lk)("div",d,[(0,n.Q3)(" PROJECT NAME "),(0,n.Lk)("div",c,[(0,n.Lk)("label",null,[t[5]||(t[5]=(0,n.eW)("Project Name ")),(0,n.bF)(b,{"error-list":y.v$.projectNameModel.$errors},null,8,["error-list"])]),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>k.projectNameModel=e),class:"form-control",disabled:k.isReadOnly},null,8,u),[[a.vModelText,k.projectNameModel]])]),t[7]||(t[7]=(0,n.Lk)("br",null,null,-1)),(0,n.Q3)(" PROJECT DESCRIPTION "),(0,n.Lk)("label",null,[t[6]||(t[6]=(0,n.eW)(" Project Description: ")),(0,n.bF)(b,{"error-list":y.v$.projectDescriptionModel.$errors},null,8,["error-list"])]),t[8]||(t[8]=(0,n.Lk)("br",null,null,-1)),(0,n.Lk)("img",{src:`${e.staticUrl}NearBeach/images/placeholder/body_text.svg`,class:"loader-image",alt:"loading image for Tinymce"},null,8,p),(0,n.bF)(D,{"license-key":"gpl",init:{license_key:"gpl",file_picker_types:"image",height:500,images_upload_handler:S.useUploadImage,menubar:!1,paste_data_images:!0,plugins:["lists","image","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`,relative_urls:!1},disabled:k.isReadOnly,modelValue:k.projectDescriptionModel,"onUpdate:modelValue":t[1]||(t[1]=e=>k.projectDescriptionModel=e)},null,8,["init","disabled","modelValue"])])]),(0,n.Q3)(" PROJECT STATUS "),t[13]||(t[13]=(0,n.Lk)("hr",null,null,-1)),(0,n.Lk)("div",m,[t[10]||(t[10]=(0,n.Lk)("div",{class:"col-md-4"},[(0,n.Lk)("strong",null,"Project Status"),(0,n.Lk)("p",{class:"text-instructions"}," Please update the project's task to reflect it's current status. Then click on the \"Update Project\" button to save the change. ")],-1)),(0,n.Lk)("div",h,[(0,n.bF)(j,{options:o.statusOptions,disabled:o.userLevel<=1,value:k.projectStatusModel,"onUpdate:value":t[2]||(t[2]=e=>k.projectStatusModel=e)},null,8,["options","disabled","value"])])]),(0,n.Q3)(" STAKEHOLDER ORGANISATION "),t[14]||(t[14]=(0,n.Lk)("hr",null,null,-1)),(0,n.bF)(M,{"organisation-results":o.organisationResults,"default-stakeholder-image":o.defaultStakeholderImage},null,8,["organisation-results","default-stakeholder-image"]),(0,n.Q3)(" START DATE & END DATE "),t[15]||(t[15]=(0,n.Lk)("hr",null,null,-1)),(0,n.bF)(L,{destination:"project",onUpdate_dates:t[3]||(t[3]=e=>S.updateDates(e)),"is-read-only":k.isReadOnly,"end-date-model":k.projectEndDateModel.getTime(),"start-date-model":k.projectStartDateModel.getTime()},null,8,["is-read-only","end-date-model","start-date-model"]),(0,n.Q3)(" Submit and Close Button "),k.isReadOnly?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("hr",g)),k.isReadOnly?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",f,[(0,n.Lk)("div",v,[(0,n.Q3)(" Update Project "),(0,n.Lk)("button",{class:"btn btn-primary save-changes",onClick:t[4]||(t[4]=(...e)=>S.updateProject&&S.updateProject(...e))}," Update Project ")])]))])])])),_:1},8,["theme"])}]])},404:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(641),a=o(33);const r={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},s=(0,o(6262).A)(r,[["render",function(e,t,o,r,s,i){return(0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.errorList,(e=>((0,n.uX)(),(0,n.CE)("span",{class:"error",key:e.$uid},(0,a.toDisplayString)(e.$message),1)))),128)}]])},9581:(e,t,o)=>{o.d(t,{p:()=>r});var n=o(953),a=o(7413);function r(e){return"dark"===(0,n.BA)(e)?a.a:null}},2595:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(953);function a(e,t){const o=(0,n.BA)(e),a=this.$store.getters.getRootUrl;let r=this.$store.getters.getDestination,s=this.$store.getters.getLocationId;"kanban_board"===r&&(r="kanban_card",s=this.$store.getters.getCardId);const i=new FormData;i.set("document",o.blob(),o.filename()),i.set("document_description",o.filename());const l={onUploadProgress:e=>{t(parseFloat(e.loaded)/parseFloat(e.total))}};return this.axios.post(`${a}documentation/${r}/${s}/upload/`,i,l).then((e=>`/private/${e.data[0].document_key_id}`)).catch((e=>(this.$store.dispatch("newToast",{header:"Failed to upload image",message:`Sorry, could not upload image. Error -> ${e}`,extra_classes:"bg-danger",delay:0}),"")))}}}]);