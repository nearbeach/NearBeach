"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[8346],{8435:(e,t,o)=>{o.r(t),o.d(t,{default:()=>q});var r=o(6252),s=o(9963);const l={class:"card"},i={class:"card-body"},a=(0,r._)("h1",null,"Customer Information",-1),n=(0,r._)("br",null,null,-1),u=["href"],d=(0,r._)("hr",null,null,-1),c={class:"row"},m=(0,r._)("div",{class:"col-md-4"},[(0,r._)("strong",null,"Please Note"),(0,r._)("p",{class:"text-instructions"}," Please fill out the following details. If the customer is not assigned an organisation, NearBeach will treat this customer as a freelancer. ")],-1),h={class:"col-md-8"},p={class:"row customer-profile-image"},g=["src"],f=(0,r._)("div",{class:"spacer-extra"},null,-1),_={class:"row"},k={class:"form-group col-sm-3"},v={class:"form-group col-sm-4"},M={class:"form-group col-sm-5"},I=(0,r._)("hr",null,null,-1),w=(0,r._)("br",null,null,-1),Z={key:1},y={key:2,class:"row submit-row"},U={class:"col-md-12"};o(3138);var S=o(9729),E=o(2001),L=o(4344),P=o(5145),$=o(5705),N=o(760),T=o(7939),R=o(3058),C=o(624),b=o(8416),F=o(106);const x=o(9669),D={name:"CustomerInformation",setup:()=>({v$:(0,$.ZP)()}),components:{NButton:S.ZP,NSelect:E.Z,NUpload:L.Z,StakeholderInformation:P.Z,ValidationRendering:T.Z},props:{customerResults:{type:Array,default:()=>[]},defaultStakeholderImage:{type:String,default:""},organisationResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},staticUrl:{type:String,default:"/"},theme:{type:String,default:""},titleList:{type:Array,default:()=>[]},userLevel:{type:Number,default:0}},data(){return{customerEmailModel:this.customerResults[0].fields.customer_email,customerFirstNameModel:this.customerResults[0].fields.customer_first_name,customerLastNameModel:this.customerResults[0].fields.customer_last_name,customerTitleModel:this.customerResults[0].fields.customer_title,profilePicture:`${this.staticUrl}/NearBeach/images/placeholder/product_tour.svg`,titleFixList:[]}},mixins:[R.Z,C.Z,F.Z,b.Z],validations:{customerEmailModel:{required:N.C1,email:N.Do},customerFirstNameModel:{required:N.C1},customerLastNameModel:{required:N.C1},customerTitleModel:{required:N.C1}},methods:{setProfilePicture(){let e=this.customerResults[0].fields.customer_profile_picture;this.profilePicture=null!=e&&""!==e?`/private${this.rootUrl}${this.customerResults[0].fields.customer_profile_picture}`:`${this.staticUrl}/NearBeach/images/placeholder/product_tour.svg`},updateCustomer(){const e=new FormData;e.set("customer_email",this.customerEmailModel),e.set("customer_first_name",this.customerFirstNameModel),e.set("customer_last_name",this.customerLastNameModel),e.set("customer_title",this.customerTitleModel),this.showLoadingModal("Customer Information"),x.post(`${this.rootUrl}customer_information/${this.customerResults[0].pk}/save/`,e).then((e=>{this.closeLoadingModal(),this.updateProfilePicture()})).catch((e=>{this.showErrorModal(e,"customer",this.customerResults[0].pk)}))},updateProfilePicture(){x.post(`${this.rootUrl}customer_information/${this.customerResults[0].pk}/get_profile_picture/`,{}).then((e=>{this.profilePicture=e.data})).catch((()=>{this.profilePicture=`${this.staticUrl}/NearBeach/images/placeholder/product_tour.svg`}))}},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.titleFixList=this.titleList.map((e=>({value:e.pk,label:e.fields.title}))),this.setProfilePicture()}},q=(0,o(3744).Z)(D,[["render",function(e,t,o,S,E,L){const P=(0,r.up)("n-button"),$=(0,r.up)("n-upload"),N=(0,r.up)("validation-rendering"),T=(0,r.up)("n-select"),R=(0,r.up)("stakeholder-information"),C=(0,r.up)("n-config-provider");return(0,r.wg)(),(0,r.j4)(C,{theme:e.getTheme(o.theme)},{default:(0,r.w5)((()=>[(0,r._)("div",l,[(0,r._)("div",i,[(0,r.kq)(" TITLE "),a,n,(0,r._)("a",{href:`${o.rootUrl}search/customer/`},"Go back to customer search",8,u),d,(0,r.kq)(" FIELDS SECTION "),(0,r._)("div",c,[m,(0,r._)("div",h,[(0,r._)("div",p,[(0,r.kq)(" PROFILE IMAGE "),(0,r._)("img",{src:E.profilePicture,alt:"User Profile Picture",class:"customer-profile-image"},null,8,g),o.userLevel>1?((0,r.wg)(),(0,r.j4)($,{key:0,action:`${o.rootUrl}customer_information/${o.customerResults[0].pk}/update_profile/`,headers:{"X-CSRFTOKEN":e.getToken("csrftoken")},data:{},onError:t[0]||(t[0]=t=>e.showErrorModal("Profile Picture was not updated","Profile Picture","")),onFinish:L.updateProfilePicture},{default:(0,r.w5)((()=>[(0,r.Wm)(P,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Update Profile Picture")])),_:1})])),_:1},8,["action","headers","onFinish"])):(0,r.kq)("v-if",!0)]),f,(0,r.kq)(" CUSTOMER INFORMATION "),(0,r._)("div",_,[(0,r._)("div",k,[(0,r._)("label",null,[(0,r.Uk)(" Title: "),(0,r.Wm)(N,{"error-list":S.v$.customerTitleModel.$errors},null,8,["error-list"])]),(0,r.Wm)(T,{options:E.titleFixList,value:E.customerTitleModel,"onUpdate:value":t[1]||(t[1]=e=>E.customerTitleModel=e)},null,8,["options","value"])]),(0,r._)("div",v,[(0,r._)("label",null,[(0,r.Uk)(" First Name: "),(0,r.Wm)(N,{"error-list":S.v$.customerFirstNameModel.$errors},null,8,["error-list"])]),(0,r.wy)((0,r._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>E.customerFirstNameModel=e)},null,512),[[s.vModelText,E.customerFirstNameModel]])]),(0,r._)("div",M,[(0,r._)("label",null,[(0,r.Uk)(" Last Name: "),(0,r.Wm)(N,{"error-list":S.v$.customerLastNameModel.$errors},null,8,["error-list"])]),(0,r.wy)((0,r._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>E.customerLastNameModel=e)},null,512),[[s.vModelText,E.customerLastNameModel]])])])])]),(0,r.kq)(" STAKEHOLDER ORGANISATION "),I,o.organisationResults.length>0?((0,r.wg)(),(0,r.j4)(R,{key:0,"organisation-results":o.organisationResults,"default-stakeholder-image":o.defaultStakeholderImage},null,8,["organisation-results","default-stakeholder-image"])):(0,r.kq)("v-if",!0),w,(0,r.kq)(" NEED TO APPLY PERMISSIONS "),(0,r.kq)(" Submit Button "),o.userLevel>1?((0,r.wg)(),(0,r.iD)("hr",Z)):(0,r.kq)("v-if",!0),o.userLevel>1?((0,r.wg)(),(0,r.iD)("div",y,[(0,r._)("div",U,[(0,r._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[4]||(t[4]=(...e)=>L.updateCustomer&&L.updateCustomer(...e))},"Update Customer")])])):(0,r.kq)("v-if",!0)])])])),_:1},8,["theme"])}]])},5145:(e,t,o)=>{o.d(t,{Z:()=>v});var r=o(6252),s=o(3577);const l={class:"row"},i=(0,r._)("div",{class:"col-md-4"},[(0,r._)("h2",null,"Stakeholder")],-1),a={class:"col-md-8 organisation-details"},n=["src"],u={class:"organisation-name"},d=["href"],c={class:"organisation-link"},m=["href"],h={class:"organisation-email"},p=["href"];var g=o(6542),f=o(5808),_=o(989);const k={name:"StakeholderInformation",components:{Icon:g.JO},props:{defaultStakeholderImage:{type:String,default:""},organisationResults:{type:Array,default:()=>[]}},data(){return{stakeholderModel:this.organisationResults[0].fields}},mixins:[f.Z],computed:{...(0,_.Se)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"}),getStakeholderImage(){const e=this.stakeholderModel.organisation_profile_picture;return""===e||null===e?this.defaultStakeholderImage:`${this.rootUrl}private/${e}`}}},v=(0,o(3744).Z)(k,[["render",function(e,t,o,g,f,_){const k=(0,r.up)("Icon");return(0,r.wg)(),(0,r.iD)("div",l,[(0,r.kq)(" Description "),i,(0,r._)("div",a,[(0,r._)("img",{src:_.getStakeholderImage,alt:"Stakeholder Logo",class:"organisation-image"},null,8,n),(0,r._)("div",u,[(0,r._)("a",{href:`${e.rootUrl}organisation_information/${o.organisationResults[0].pk}/`},(0,s.toDisplayString)(f.stakeholderModel.organisation_name),9,d)]),(0,r._)("div",c,[(0,r.Wm)(k,{icon:e.icons.linkOut},null,8,["icon"]),(0,r.Uk)(" Website: "),(0,r._)("a",{href:f.stakeholderModel.organisation_website,target:"_blank",rel:"noopener noreferrer"},(0,s.toDisplayString)(f.stakeholderModel.organisation_website),9,m)]),(0,r._)("div",h,[(0,r.Wm)(k,{icon:e.icons.mailIcon},null,8,["icon"]),(0,r.Uk)(" Email: "),(0,r._)("a",{href:`mailto:${f.stakeholderModel.organisation_email}`},(0,s.toDisplayString)(f.stakeholderModel.organisation_email),9,p)])])])}]])},7939:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(6252),s=o(3577);const l={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},i=(0,o(3744).Z)(l,[["render",function(e,t,o,l,i,a){return(0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.errorList,(e=>((0,r.wg)(),(0,r.iD)("span",{class:"error",key:e.$uid},(0,s.toDisplayString)(e.$message),1)))),128)}]])},3058:(e,t,o)=>{o.d(t,{Z:()=>s});var r=o(3138);const s={methods:{showErrorModal(e,t,o){const s=document.getElementById("loadingModal");if(null===s)return;new r.u_(s).hide();const l=document.getElementById("errorModalContent");if(void 0===l)return;if(l.innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${t}-${o}<hr>${e}`,null===document.getElementById("errorModal"))return;const i=new r.u_(i);i.show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new r.u_(document.getElementById("errorModal")).show()}}}},624:(e,t,o)=>{o.d(t,{Z:()=>s});var r=o(8458);const s={data:()=>({darkTheme:r.$}),methods:{getTheme:e=>"dark"===e?r.$:null}}},106:(e,t,o)=>{o.d(t,{Z:()=>r});const r={methods:{getToken(e){const t=new RegExp(`${e}=([^;]+)`).exec(document.cookie);return null!==t?encodeURIComponent(t[1]):null}}}},5808:(e,t,o)=>{o.d(t,{Z:()=>L});var r=o(3985),s=o(5555),l=o(1826),i=o(6443),a=o(1327),n=o(8521),u=o(1056),d=o(4324),c=o(9672),m=o(9867),h=o(1239),p=o(5004),g=o(1321),f=o(1216),_=o(5550),k=o(7702),v=o(7903),M=o(2606),I=o(3843),w=o(2393),Z=o(3360),y=o(9714),U=o(1323),S=o(2610),E=o(5968);const L={data:()=>({icons:{arrowUp:r.Z,bugIcon:s.Z,bxBriefcase:l.Z,cardChecklist:i.Z,clipboardIcon:a.Z,documentPdf:n.Z,documentText:u.Z,folderIcon:d.Z,groupPresentation:c.Z,imageIcon:m.Z,infoCircle:h.Z,linkIcon:p.Z,linkIcon2:g.Z,linkOut:f.Z,mailIcon:_.Z,microsoftExcel:k.Z,microsoftPowerpoint:v.Z,microsoftWord:M.Z,noteAdd:I.Z,objectStorage:w.Z,passwordIcon:Z.Z,trashCan:y.Z,userIcon:U.Z,usersIcon:S.Z,xCircle:E.Z}})}},8416:(e,t,o)=>{o.d(t,{Z:()=>s});var r=o(3138);const s={methods:{closeLoadingModal(){const e=new r.u_(document.getElementById("loadingModal"));document.getElementById("loadingModalContent").innerHTML="UPDATED SUCCESSFULLY",setTimeout((()=>{e.hide()}),1e3)},showLoadingModal(e){new r.u_(document.getElementById("loadingModal")).show(),document.getElementById("loadingModalContent").innerHTML=`Updating your ${e} details`}}}}}]);