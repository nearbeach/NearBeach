"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[6537],{6818:(e,t,o)=>{o.r(t),o.d(t,{default:()=>O});var l=o(641),s=o(3751);const r={class:"card"},a={class:"card card-body"},i={class:"row"},n={class:"col-md-8"},d={class:"row"},c={class:"col-md-8",style:{"min-height":"610px"}},u={class:"form-group"},p=["src"],h={class:"row"},b={class:"col-md-8"},m={key:0,class:"alert alert-warning"};var g=o(8838),y=o(3913),k=o(1080),f=o(5607),j=o(2407),_=o(4406),M=o(555),v=o(9827),A=o(379),L=o(9639),D=o(3855),T=o(404),R=o(2124);const w={name:"NewScheduledObject",setup:()=>({v$:(0,L.Ay)()}),components:{StakeholderInformation:o(8716).A,BetweenDates:f.A,editor:g.A,GetStakeholders:j.A,GroupPermissions:_.A,NConfigProvider:y.A,NSelect:k.A,SchedulerFrequency:M.A,ValidationRendering:T.A},props:{defaultStakeholderImage:{type:String,default:""},groupResults:{type:Array,default:()=>[]},objectTemplateResults:{type:Array,default:()=>[]},organisationResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},scheduledObjectId:{type:Number,default:0},scheduledObjectResults:{type:Object,default:()=>({schedule_object_id:0,object_template_id:0,end_date:null,frequency:"Set Day of the Week",frequency_attribute:null,is_active:!0,number_of_repeats:-1})},staticUrl:{type:String,default:"/"},templateGroupResults:{type:Array,default:()=>[]},theme:{type:String,default:"light"},userGroupAndLevel:{type:Array,default:()=>[]},userGroupResults:{type:Array,default:()=>[]}},data(){return{groupModel:{},groupModelValidation:!0,displayGroupPermissionIssue:!1,objectDescriptionModel:this.objectTemplateResults[0].object_template_json.object_description,objectEndDateModel:new Date(this.objectTemplateResults[0].object_template_json.object_end_date),objectGroupModel:this.templateGroupResults,objectStartDateModel:new Date(this.objectTemplateResults[0].object_template_json.object_start_date),objectTitleModel:this.objectTemplateResults[0].object_template_json.object_title,objectTypeModel:this.objectTemplateResults[0].object_template_type,objectTypeOptions:[{value:0,label:"Project"},{value:1,label:"Task"}],daysBeforeModel:0,dayModel:this.getDayModel(),endDateConditionModel:this.getEndDateConditionModel(),endDateModel:this.getEndDateModel(),isFormValid:!1,numberOfRepeats:0,schedulerFrequencyModel:this.scheduledObjectResults.frequency,singleDayModel:"monday",startDateModel:new Date(this.scheduledObjectResults.start_date).getTime()}},computed:{...(0,R.L8)({contentCss:"getContentCss",skin:"getSkin"})},validations:{groupModel:{required:D.mw},objectDescriptionModel:{required:D.mw},objectGroupModel:{required:D.mw},objectTitleModel:{required:D.mw},objectTypeModel:{required:D.mw}},mixins:[v.A,A.A],methods:{calculateUserLevel(e){if(0===e.length)return 0;const t=e.reduce(((e,t)=>e&&e.project_permission>t.project_permission?e:t)).project_permission,o=e.reduce(((e,t)=>e&&e.task_permission>t.task_permission?e:t)).task_permission;return o>t?o:t},checkObjectGroupModel(){this.displayGroupPermissionIssue=0===this.userGroupResults.filter((e=>this.objectGroupModel.includes(e.group_id))).length;const e=this.userGroupAndLevel.filter((e=>this.objectGroupModel.includes(e.group_id)));this.groupModelValidation=this.calculateUserLevel(e)>=3,this.groupModelValidation||this.$store.dispatch("newToast",{header:"No CREATE permission for groups",message:"Please note - for the current groups selected, you do not have create permissions. Please add in a group you have create permission with.",extra_classes:"bg-danger",delay:5e3,unique_type:"group-model-validation"})},getEndDateConditionModel(){return this.scheduledObjectResults.number_of_repeats>=0?"number-of-repeats":null!==this.scheduledObjectResults.end_date?"end-date":"no-end-date"},getDayModel(){return void 0===this.scheduledObjectResults.frequency_attribute||void 0===this.scheduledObjectResults.frequency_attribute.days_of_the_week?[]:(console.log("DATA: ",this.scheduledObjectResults.frequency_attribute.days_of_the_week),this.scheduledObjectResults.frequency_attribute.days_of_the_week)},getEndDateModel(){return null===this.scheduledObjectResults.end_date?0:this.scheduledObjectResults.end_date},updateDates(e){this.objectStartDateModel=new Date(e.start_date),this.objectEndDateModel=new Date(e.end_date)},updateSchedulerFrequency(e){this.daysBeforeModel=e.daysBeforeModel,this.dayModel=e.dayModel,this.endDateConditionModel=e.endDateConditionModel,this.endDateModel=e.endDateModel,this.isFormValid=e.isFormValid,this.numberOfRepeats=e.numberOfRepeats,this.schedulerFrequencyModel=e.schedulerFrequencyModel,this.singleDayModel=e.singleDayModel,this.startDateModel=e.startDateModel}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl});const e=this.calculateUserLevel(this.userGroupAndLevel);this.$store.commit({type:"updateUserLevel",userLevel:e})}},O=(0,o(6262).A)(w,[["render",function(e,t,o,g,y,k){const f=(0,l.g2)("validation-rendering"),j=(0,l.g2)("n-select"),_=(0,l.g2)("editor"),M=(0,l.g2)("stakeholder-information"),v=(0,l.g2)("between-dates"),A=(0,l.g2)("scheduler-frequency"),L=(0,l.g2)("n-config-provider");return(0,l.uX)(),(0,l.Wv)(L,{theme:e.getTheme(o.theme)},{default:(0,l.k6)((()=>[(0,l.Lk)("div",r,[(0,l.Lk)("div",a,[t[15]||(t[15]=(0,l.Lk)("h1",null,"Scheduled Object Information",-1)),t[16]||(t[16]=(0,l.Lk)("hr",null,null,-1)),(0,l.Lk)("div",i,[t[6]||(t[6]=(0,l.Lk)("div",{class:"col-md-4"},[(0,l.Lk)("h2",null,"Object Type"),(0,l.Lk)("p",{class:"text-instructions"}," Please select if the object will be either a Project or Task. ")],-1)),(0,l.Lk)("div",n,[(0,l.Lk)("label",null,[t[5]||(t[5]=(0,l.eW)(" Object Type ")),(0,l.bF)(f,{"error-list":g.v$.objectTypeModel.$errors},null,8,["error-list"])]),(0,l.bF)(j,{value:y.objectTypeModel,"onUpdate:value":t[0]||(t[0]=e=>y.objectTypeModel=e),options:y.objectTypeOptions},null,8,["value","options"])])]),(0,l.Q3)(" OBJECT DESCRIPTION"),t[17]||(t[17]=(0,l.Lk)("hr",null,null,-1)),(0,l.Lk)("div",d,[t[11]||(t[11]=(0,l.Lk)("div",{class:"col-md-4"},[(0,l.Lk)("h2",null,"Description"),(0,l.Lk)("p",{class:"text-instructions"}," Please supply a suitable Title and Description for your object. This will be created exactly each time the object is created. ")],-1)),(0,l.Lk)("div",c,[(0,l.Lk)("div",u,[(0,l.Lk)("label",null,[t[7]||(t[7]=(0,l.eW)("Object Title ")),(0,l.bF)(f,{"error-list":g.v$.objectTitleModel.$errors},null,8,["error-list"])]),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>y.objectTitleModel=e),class:"form-control"},null,512),[[s.vModelText,y.objectTitleModel]])]),t[9]||(t[9]=(0,l.Lk)("br",null,null,-1)),(0,l.Q3)(" OBJECT DESCRIPTION "),(0,l.Lk)("label",null,[t[8]||(t[8]=(0,l.eW)(" Object Description: ")),(0,l.bF)(f,{"error-list":g.v$.objectDescriptionModel.$errors},null,8,["error-list"])]),t[10]||(t[10]=(0,l.Lk)("br",null,null,-1)),(0,l.Lk)("img",{src:`${o.staticUrl}NearBeach/images/placeholder/body_text.svg`,class:"loader-image",alt:"loading image for Tinymce"},null,8,p),(0,l.bF)(_,{init:{file_picker_types:"image",height:500,images_upload_handler:e.newObjectUploadImage,menubar:!1,paste_data_images:!0,plugins:["lists","image","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`},modelValue:y.objectDescriptionModel,"onUpdate:modelValue":t[2]||(t[2]=e=>y.objectDescriptionModel=e)},null,8,["init","modelValue"])])]),(0,l.Q3)(" STAKEHOLDER ORGANISATION "),t[18]||(t[18]=(0,l.Lk)("hr",null,null,-1)),(0,l.bF)(M,{"organisation-results":o.organisationResults,"default-stakeholder-image":o.defaultStakeholderImage},null,8,["organisation-results","default-stakeholder-image"]),(0,l.Q3)(" START DATE & END DATE "),t[19]||(t[19]=(0,l.Lk)("hr",null,null,-1)),(0,l.bF)(v,{destination:"object","end-date-model":y.objectEndDateModel.getTime(),"start-date-model":y.objectStartDateModel.getTime(),onUpdate_dates:t[3]||(t[3]=e=>k.updateDates(e))},null,8,["end-date-model","start-date-model"]),(0,l.Q3)(" Group Permissions "),t[20]||(t[20]=(0,l.Lk)("hr",null,null,-1)),(0,l.Lk)("div",h,[t[14]||(t[14]=(0,l.Lk)("div",{class:"col-md-4"},[(0,l.Lk)("h2",null,"Group Permissions"),(0,l.Lk)("p",{class:"text-instructions"}," Add or remove groups from this scheduled object. Adding a group will allow users from that group to access the constructed object. "),(0,l.Lk)("p",{class:"text-instructions"}," Users who do not have access to this scheduled object, won't be able to edit/view this object, nor it's constructed object. ")],-1)),(0,l.Lk)("div",b,[(0,l.Lk)("label",null,[t[12]||(t[12]=(0,l.eW)(" Group List ")),(0,l.bF)(f,{"error-list":g.v$.objectGroupModel.$errors},null,8,["error-list"])]),(0,l.bF)(j,{options:o.groupResults,label:"group",value:y.objectGroupModel,"onUpdate:value":t[4]||(t[4]=e=>y.objectGroupModel=e),onUpdateValue:k.checkObjectGroupModel,multiple:""},null,8,["options","value","onUpdateValue"]),(0,l.Q3)("\t\t\t\t\t\t ALERT FOR WHEN USER GROUPS ARE NOT INCLUDED "),t[13]||(t[13]=(0,l.Lk)("br",null,null,-1)),y.displayGroupPermissionIssue?((0,l.uX)(),(0,l.CE)("div",m," None of your user groups were included. You will not have permissions to create this object. Please select one of your groups ")):(0,l.Q3)("v-if",!0)])]),(0,l.Q3)(" Scheduler Frequency "),t[21]||(t[21]=(0,l.Lk)("hr",null,null,-1)),(0,l.bF)(A,{"days-before":y.daysBeforeModel,day:y.dayModel,"end-date-condition":y.endDateConditionModel,"end-date":y.endDateModel,"number-of-repeats":y.numberOfRepeats,"scheduler-frequency":y.schedulerFrequencyModel,"single-day":y.singleDayModel,"start-date":y.startDateModel,onUpdate_scheduler_frequency:k.updateSchedulerFrequency},null,8,["days-before","day","end-date-condition","end-date","number-of-repeats","scheduler-frequency","single-day","start-date","onUpdate_scheduler_frequency"]),(0,l.Q3)(" Submit Button "),t[22]||(t[22]=(0,l.Lk)("hr",null,null,-1)),t[23]||(t[23]=(0,l.Lk)("div",{class:"row submit-row"},[(0,l.Lk)("div",{class:"col-md-12"}," ADD CODE - BUTTONS ")],-1))])])])),_:1},8,["theme"])}]])},8716:(e,t,o)=>{o.d(t,{A:()=>k});var l=o(641),s=o(33);const r={class:"row"},a={class:"col-md-8 organisation-details"},i=["src"],n={class:"organisation-name"},d=["href"],c={class:"organisation-link"},u=["href"],p={class:"organisation-email"},h=["href"];var b=o(2321),m=o(2243),g=o(2124);const y={name:"StakeholderInformation",components:{Icon:b.In},props:{defaultStakeholderImage:{type:String,default:""},organisationResults:{type:Array,default:()=>[]}},data(){return{stakeholderModel:this.organisationResults[0].fields}},mixins:[m.A],computed:{...(0,g.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"}),getStakeholderImage(){const e=this.stakeholderModel.organisation_profile_picture;return""===e||null===e?this.defaultStakeholderImage:`${this.rootUrl}private/${e}`}}},k=(0,o(6262).A)(y,[["render",function(e,t,o,b,m,g){const y=(0,l.g2)("Icon");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Q3)(" Description "),t[2]||(t[2]=(0,l.Lk)("div",{class:"col-md-4"},[(0,l.Lk)("h2",null,"Stakeholder")],-1)),(0,l.Lk)("div",a,[(0,l.Lk)("img",{src:g.getStakeholderImage,alt:"Stakeholder Logo",class:"organisation-image"},null,8,i),(0,l.Lk)("div",n,[(0,l.Lk)("a",{href:`${e.rootUrl}organisation_information/${o.organisationResults[0].pk}/`},(0,s.toDisplayString)(m.stakeholderModel.organisation_name),9,d)]),(0,l.Lk)("div",c,[(0,l.bF)(y,{icon:e.icons.linkOut},null,8,["icon"]),t[0]||(t[0]=(0,l.eW)(" Website: ")),(0,l.Lk)("a",{href:m.stakeholderModel.organisation_website,target:"_blank",rel:"noopener noreferrer"},(0,s.toDisplayString)(m.stakeholderModel.organisation_website),9,u)]),(0,l.Lk)("div",p,[(0,l.bF)(y,{icon:e.icons.mailIcon},null,8,["icon"]),t[1]||(t[1]=(0,l.eW)(" Email: ")),(0,l.Lk)("a",{href:`mailto:${m.stakeholderModel.organisation_email}`},(0,s.toDisplayString)(m.stakeholderModel.organisation_email),9,h)])])])}]])},2243:(e,t,o)=>{o.d(t,{A:()=>R});var l=o(8998),s=o(102),r=o(9394),a=o(2438),i=o(9605),n=o(3438),d=o(5666),c=o(6375),u=o(1647),p=o(7066),h=o(4397),b=o(4603),m=o(7432),g=o(1758),y=o(8959),k=o(9587),f=o(9675),j=o(386),_=o(6120),M=o(8086),v=o(5617),A=o(6325),L=o(6500),D=o(5707),T=o(1511);const R={data:()=>({icons:{arrowUp:l.A,bugIcon:s.A,bxBriefcase:r.A,cardChecklist:a.A,clipboardIcon:i.A,documentPdf:n.A,documentText:d.A,folderIcon:c.A,groupPresentation:u.A,imageIcon:p.A,infoCircle:h.A,linkIcon:b.A,linkIcon2:m.A,linkOut:g.A,mailIcon:y.A,microsoftExcel:k.A,microsoftPowerpoint:f.A,microsoftWord:j.A,noteAdd:_.A,objectStorage:M.A,passwordIcon:v.A,trashCan:A.A,userIcon:L.A,usersIcon:D.A,xCircle:T.A}})}}}]);