"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[8475],{2307:(e,s,t)=>{t.r(s),t.d(s,{default:()=>H});var a=t(641),o=t(33);const r={class:"card"},i={class:"card-body"},l={key:0},d={key:1},n={class:"row"},u={class:"col-md-4"},c={text:"text-instructions"},m={class:"col-md-8"},p={class:"table"},h={style:{"text-align":"center"}},g=["checked","data-group","data-permission-set","data-user"],k={class:"remove-link"},b={class:"row"},L={class:"col-md-12"};var v=t(9336);const _={class:"modal fade",id:"addUserModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"addUserModalLabel","aria-hidden":"true"},y={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},f={class:"modal-content"},S={class:"modal-body"},w={key:0,class:"row"},U={class:"col-md-4"},C={class:"text-instructions"},D={class:"col-md-8"},M={key:1},x={key:2,class:"row"},E={class:"col-md-8"},P={key:3},A={key:4,class:"row"},R={class:"col-md-8"},T={class:"modal-footer"},I=["disabled"];var $=t(1080),F=t(2124);const B={name:"AdminAddUser",components:{NSelect:$.A},props:{destination:{type:String,default:""},locationId:{type:Number,default:0}},data:()=>({groupModel:[],groupResults:[],permissionSetModel:[],permissionSetResults:[],userModel:[],userResults:[]}),computed:{...(0,F.L8)({rootUrl:"getRootUrl",userLevel:"getUserLevel"}),disableAddButton(){return(Number.isInteger(this.userModel)?1:0)+(this.groupModel.length>0?1:0)+(this.permissionSetModel.length>0?1:0)!=3}},methods:{addButtonText(){return"user"===this.destination?"Add Group":"Add User"},addUser(){const e=new FormData;e.set("username",this.userModel),this.groupModel.forEach((s=>{e.append("group",s)})),this.permissionSetModel.forEach((s=>{e.append("permission_set",s)})),this.axios.post(`${this.rootUrl}admin_add_user/`,e).then((()=>{window.location.reload(!0)})).catch((e=>{this.$store.dispatch("newToast",{header:"Error adding user",message:`Sorry, we could not add user. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},getData(){const e=new FormData;this.axios.post(`${this.rootUrl}object_data/admin_add_user/`,e).then((e=>{switch(this.groupResults=e.data.group_results.map((e=>({label:e.group_name,value:e.group_id}))),this.permissionSetResults=e.data.permission_set_results.map((e=>({label:e.permission_set_name,value:e.permission_set_id}))),this.userResults=e.data.user_results.map((e=>({label:`${e.id}: ${e.first_name} ${e.last_name}`,value:e.id}))),this.destination){case"group":this.groupModel=[this.locationId];break;case"permission_set":this.permissionSetModel=[this.locationId];break;case"user":this.userModel=this.locationId}})).catch((e=>{this.$store.dispatch("newToast",{header:"Error obtaining data",message:`Sorry, we could not obtain the required data. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.getData()}};var X=t(6262);const G=(0,X.A)(B,[["render",function(e,s,t,r,i,l){const d=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",_,[(0,a.Lk)("div",y,[(0,a.Lk)("div",f,[s[11]||(s[11]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"addUserModalLabel"}," Add User "),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,a.Lk)("div",S,[(0,a.Q3)(" Search Users "),"user"!==t.destination?((0,a.uX)(),(0,a.CE)("div",w,[(0,a.Lk)("div",U,[s[4]||(s[4]=(0,a.Lk)("strong",null,"Search Users",-1)),(0,a.Lk)("p",C," Please use the select to find the user you would like to add to this "+(0,o.toDisplayString)(t.destination),1)]),(0,a.Lk)("div",D,[s[5]||(s[5]=(0,a.Lk)("label",null,"Search User",-1)),(0,a.bF)(d,{options:i.userResults,value:i.userModel,"onUpdate:value":s[0]||(s[0]=e=>i.userModel=e),filterable:""},null,8,["options","value"])])])):(0,a.Q3)("v-if",!0),"user"!==t.destination?((0,a.uX)(),(0,a.CE)("hr",M)):(0,a.Q3)("v-if",!0),(0,a.Q3)(" Search Groups "),"group"!==t.destination?((0,a.uX)(),(0,a.CE)("div",x,[s[7]||(s[7]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Search Groups"),(0,a.Lk)("p",{class:"text-instructions"}," Please use the select to find the group you would like to add to this user to. ")],-1)),(0,a.Lk)("div",E,[s[6]||(s[6]=(0,a.Lk)("label",null,"Search Groups",-1)),(0,a.bF)(d,{options:i.groupResults,value:i.groupModel,"onUpdate:value":s[1]||(s[1]=e=>i.groupModel=e),class:"form-control",multiple:"",filterable:""},null,8,["options","value"])])])):(0,a.Q3)("v-if",!0),"group"!==t.destination?((0,a.uX)(),(0,a.CE)("hr",P)):(0,a.Q3)("v-if",!0),(0,a.Q3)(" Search Permission Sets "),"permission_set"!==t.destination?((0,a.uX)(),(0,a.CE)("div",A,[s[9]||(s[9]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Search Permission Sets"),(0,a.Lk)("p",{class:"text-instructions"}," Please use the select to find the permission set you would like to add to this user. ")],-1)),(0,a.Lk)("div",R,[s[8]||(s[8]=(0,a.Lk)("label",null,"Search Permission Sets",-1)),(0,a.bF)(d,{options:i.permissionSetResults,value:i.permissionSetModel,"onUpdate:value":s[2]||(s[2]=e=>i.permissionSetModel=e),class:"form-control",multiple:"",filterable:""},null,8,["options","value"])])])):(0,a.Q3)("v-if",!0)]),(0,a.Lk)("div",T,[s[10]||(s[10]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",disabled:l.disableAddButton,onClick:s[3]||(s[3]=(...e)=>l.addUser&&l.addUser(...e))},(0,o.toDisplayString)(l.addButtonText()),9,I)])])])])}]]),Q={class:"modal fade",id:"confirmPermissionDeleteModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"confirmPermissionDeleteLabel","aria-hidden":"true"},N={class:"modal-dialog"},q={class:"modal-content"},j={class:"modal-footer"},K={name:"ConfirmPermissionDelete",emits:["remove_permission"],props:{permissionDeleteId:{type:Number,default:0}},methods:{removePermission(){const e=new FormData;e.set("user_group_id",this.permissionDeleteId),this.axios.post("/user_information/remove_permission/",e).catch((e=>{this.$store.dispatch("newToast",{header:"Error removing permission",message:`Sorry, we could not remove the permission. Error -> ${e}`,extra_classes:"bg-danger",delay:0})})),this.$emit("remove_permission",this.permissionDeleteId),document.getElementById("confirmPermissionDeleteClose").click()}}},O=(0,X.A)(K,[["render",function(e,s,t,o,r,i){return(0,a.uX)(),(0,a.CE)("div",Q,[(0,a.Lk)("div",N,[(0,a.Lk)("div",q,[s[2]||(s[2]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h1",{class:"modal-title fs-5",id:"confirmPermissionDeleteLabel"}," Are you sure? "),(0,a.Lk)("button",{type:"button",id:"confirmPermissionDeleteClose",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s[3]||(s[3]=(0,a.Lk)("div",{class:"modal-body"}," Are you sure you want to delete that permission? ",-1)),(0,a.Lk)("div",j,[s[1]||(s[1]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," No ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:s[0]||(s[0]=(...e)=>i.removePermission&&i.removePermission(...e))}," Yes ")])])])])}]]);var W=t(3980),Y=t(9581);const z={name:"UserList",components:{CarbonTrashCan:W.dA,AdminAddUser:G,ConfirmPermissionDelete:O},props:{destination:{type:String,default:""},locationId:{type:Number,default:0},theme:{type:String,default:""},userListResults:{type:Array,default:()=>[]}},data:()=>({localListResults:[],permissionDeleteId:0}),methods:{useNBTheme:Y.p,addButtonText(){return"user"===this.destination?"Add Group":"Add User"},addUser(){new v.aF(document.getElementById("addUserModal")).show()},deletePermission(e){this.permissionDeleteId=e,new v.aF(document.getElementById("confirmPermissionDeleteModal")).show()},isTeamLeader(e){return this.userListResults.filter((s=>s.username===e&&s.group_leader)).length>0},removePermission(e){this.localListResults=this.localListResults.filter((s=>s.user_group_id!==e))},updateGroupLeader(e){this.$store.dispatch("newToast",{header:"Updating Team Leader Status",message:"Currently updating team leader status. Please wait",extra_classes:"bg-warning text-dark",delay:0,unique_type:"update_group_leader"});const s=e.target.checked,t=new FormData;t.set("group_leader",s),t.set("username",e.target.dataset.user),"group"===this.destination||"user"===this.destination?t.set("group",e.target.dataset.group):"permission_set"===this.destination&&t.set("permission_set",e.target.dataset.permissionSet),this.axios.post(`/update_group_leader_status/${this.destination}/`,t).then((e=>{this.localListResults=e.data,this.$store.dispatch("newToast",{header:"Updated Team Leader Status",message:"Updated team leader status.",extra_classes:"bg-success",unique_type:"update_group_leader"})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error updating group leader",message:`Sorry, we could not update group leader. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.localListResults=this.userListResults}},H=(0,X.A)(z,[["render",function(e,s,t,v,_,y){const f=(0,a.g2)("carbon-trash-can"),S=(0,a.g2)("admin-add-user"),w=(0,a.g2)("confirm-permission-delete"),U=(0,a.g2)("n-config-provider");return(0,a.uX)(),(0,a.Wv)(U,{theme:y.useNBTheme(t.theme)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",r,[(0,a.Lk)("div",i,["user"===t.destination?((0,a.uX)(),(0,a.CE)("h2",l,"User Permission List")):((0,a.uX)(),(0,a.CE)("h2",d,"User List")),s[4]||(s[4]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",n,[(0,a.Lk)("div",u,[s[2]||(s[2]=(0,a.Lk)("strong",null,"List of Users",-1)),(0,a.Lk)("p",c," The following are a list of users associated to "+(0,o.toDisplayString)(t.destination)+'. To add a new user please click on the "Add User" at the bottom of the page. ',1)]),(0,a.Lk)("div",m,[(0,a.Lk)("table",p,[s[3]||(s[3]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",null,"User"),(0,a.Lk)("td",null,"Group List"),(0,a.Lk)("td",null,"Permission List"),(0,a.Lk)("td",null,"Team Leader"),(0,a.Lk)("td")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.localListResults,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.username},[(0,a.Lk)("td",null,(0,o.toDisplayString)(e.username__first_name)+" "+(0,o.toDisplayString)(e.username__last_name),1),(0,a.Lk)("td",null,(0,o.toDisplayString)(e.group__group_name),1),(0,a.Lk)("td",null,(0,o.toDisplayString)(e.permission_set__permission_set_name),1),(0,a.Lk)("td",h,[(0,a.Lk)("input",{class:"form-check-input",type:"checkbox",checked:e.group_leader,"data-group":e.group,"data-permission-set":e.permission_set,"data-user":e.username,onChange:s[0]||(s[0]=(...e)=>y.updateGroupLeader&&y.updateGroupLeader(...e))},null,40,g)]),(0,a.Lk)("td",null,[(0,a.Lk)("span",k,[(0,a.bF)(f,{onClick:s=>y.deletePermission(e.user_group_id)},null,8,["onClick"])])])])))),128))])])])]),s[5]||(s[5]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",b,[(0,a.Lk)("div",L,[(0,a.Lk)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:s[1]||(s[1]=(...e)=>y.addUser&&y.addUser(...e))},(0,o.toDisplayString)(y.addButtonText()),1)])])]),(0,a.Q3)(" MODALS "),(0,a.bF)(S,{destination:t.destination,"location-id":t.locationId},null,8,["destination","location-id"]),(0,a.bF)(w,{"permission-delete-id":_.permissionDeleteId,onRemove_permission:y.removePermission},null,8,["permission-delete-id","onRemove_permission"])])])),_:1},8,["theme"])}]])},9581:(e,s,t)=>{t.d(s,{p:()=>r});var a=t(953),o=t(166);function r(e){return"dark"===(0,a.BA)(e)?o.a:null}}}]);