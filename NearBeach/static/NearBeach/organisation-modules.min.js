"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[9616],{160:(t,e,s)=>{s.d(e,{Z:()=>k});var a=s(6252),o=s(9963);const l={class:"row"},i=(0,a._)("div",{class:"col-md-4"},[(0,a._)("strong",null,"New Customer"),(0,a._)("p",{class:"text-instructions"}," Please fill out the following details. "),(0,a._)("strong",null,"Please Note:"),(0,a._)("p",{class:"text-instructions"}," Customers do not go through a duplication process. Please search for the potential customer first before adding them into NearBeach. ")],-1),r={class:"col-md-8"},n={class:"row"},d={class:"form-group col-sm-3"},u={class:"form-group col-sm-4"},c={class:"form-group col-sm-5"},m=(0,a._)("br",null,null,-1),p={class:"form-group col-sm-8"},h=(0,a._)("br",null,null,-1);var b=s(2001),g=s(5705),v=s(760),_=s(7939);const f={name:"NewCustomerForm",setup:()=>({v$:(0,g.ZP)()}),components:{NSelect:b.Z,ValidationRendering:_.Z},props:{flagValidationCheck:{type:Boolean,default:!1},organisationName:{type:String,default:""},titleList:{type:Array,default:()=>[]}},data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",organisationModel:{},searchTimeout:"",titleFixList:[],titleModel:[]}),validations:{customerEmailModel:{required:v.C1,email:v.Do},customerFirstNameModel:{required:v.C1},customerLastNameModel:{required:v.C1},titleModel:{required:v.C1}},methods:{},watch:{customerEmailModel(){this.$emit("update_customer_data",{field:"customerEmailModel",value:this.customerEmailModel})},customerFirstNameModel(){this.$emit("update_customer_data",{field:"customerFirstNameModel",value:this.customerFirstNameModel})},customerLastNameModel(){this.$emit("update_customer_data",{field:"customerLastNameModel",value:this.customerLastNameModel})},flagValidationCheck(){this.flagValidationCheck&&this.v$.$touch()},titleModel(){this.$emit("update_customer_data",{field:"titleModel",value:this.titleModel})}},mounted(){this.titleFixList=this.titleList.map((t=>({value:t.pk,label:t.fields.title})))}},k=(0,s(3744).Z)(f,[["render",function(t,e,s,b,g,v){const _=(0,a.up)("validation-rendering"),f=(0,a.up)("n-select");return(0,a.wg)(),(0,a.iD)("div",l,[i,(0,a._)("div",r,[(0,a.kq)(" CUSTOMER DETAILS "),(0,a._)("div",n,[(0,a._)("div",d,[(0,a._)("label",null,[(0,a.Uk)(" Title: "),(0,a.Wm)(_,{"error-list":b.v$.titleModel.$errors},null,8,["error-list"])]),(0,a.Wm)(f,{options:g.titleFixList,label:"title",placeholder:"",value:g.titleModel,"onUpdate:value":e[0]||(e[0]=t=>g.titleModel=t)},null,8,["options","value"])]),(0,a._)("div",u,[(0,a._)("label",null,[(0,a.Uk)(" First Name: "),(0,a.Wm)(_,{"error-list":b.v$.customerFirstNameModel.$errors},null,8,["error-list"])]),(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>g.customerFirstNameModel=t)},null,512),[[o.vModelText,g.customerFirstNameModel]])]),(0,a._)("div",c,[(0,a._)("label",null,[(0,a.Uk)(" Last Name: "),(0,a.Wm)(_,{"error-list":b.v$.customerLastNameModel.$errors},null,8,["error-list"])]),(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=t=>g.customerLastNameModel=t)},null,512),[[o.vModelText,g.customerLastNameModel]])])]),m,(0,a.kq)(" Customer Email "),(0,a._)("div",p,[(0,a._)("label",null,[(0,a.Uk)(" Email: "),(0,a.Wm)(_,{"error-list":b.v$.customerEmailModel.$errors},null,8,["error-list"])]),(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=t=>g.customerEmailModel=t)},null,512),[[o.vModelText,g.customerEmailModel]])]),h])])}]])},7896:(t,e,s)=>{s.r(e),s.d(e,{default:()=>K});var a=s(6252);const o={class:"card"},l={class:"card-body"},i=(0,a._)("ul",{class:"nav nav-tabs",id:"misc_module_tabs",role:"tablist"},[(0,a.kq)(" Organisation Contacts "),(0,a._)("li",{class:"nav-item",role:"presentation"},[(0,a._)("button",{class:"nav-link",id:"organisation-contacts-tab","data-bs-toggle":"tab","data-bs-target":"#organisation-contacts",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Organisation Contacts ")]),(0,a.kq)(" Document Uploads "),(0,a._)("li",{class:"nav-item",role:"presentation"},[(0,a._)("button",{class:"nav-link",id:"document-uploads-tab","data-bs-toggle":"tab","data-bs-target":"#document-uploads",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Document Uploads ")]),(0,a.kq)(" Associated Projects & Tasks "),(0,a._)("li",{class:"nav-item",role:"presentation"},[(0,a._)("button",{class:"nav-link",id:"associated-objects-tab","data-bs-toggle":"tab","data-bs-target":"#associated-objects",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Associated Objects ")]),(0,a.kq)(" Misc Modules "),(0,a._)("li",{class:"nav-item",role:"presentation"},[(0,a._)("button",{class:"nav-link",id:"misc-modules-tab","data-bs-toggle":"tab","data-bs-target":"#misc-modules",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Misc ")]),(0,a.kq)(" Notes Modules "),(0,a._)("li",{class:"nav-item",role:"presentation"},[(0,a._)("button",{class:"nav-link",id:"notes-modules-tab","data-bs-toggle":"tab","data-bs-target":"#notes-modules",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Notes ")])],-1),r=(0,a._)("hr",null,null,-1),n={class:"tab-content",id:"misc_module_content"},d={class:"tab-pane fade",id:"organisation-contacts",role:"tabpanel","aria-labelledby":"profile-tab"},u=(0,a._)("p",{class:"text-instructions"}," Below are a list of contacts who are connected to this organisation. ",-1),c={key:0},m={key:1,class:"row submit-row"},p={class:"col-md-12"},h={class:"tab-pane fade",id:"document-uploads",role:"tabpanel","aria-labelledby":"profile-tab"},b={class:"tab-pane fade",id:"associated-objects",role:"tabpanel","aria-labelledby":"profile-tab"},g={class:"tab-pane fade",id:"misc-modules",role:"tabpanel","aria-labelledby":"profile-tab"},v={class:"tab-pane fade",id:"notes-modules",role:"tabpanel","aria-labelledby":"profile-tab"};var _=s(3138),f=s(6542),k=s(3272),M=s(7146);const y={class:"modal fade",id:"addCustomerModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},w={class:"modal-dialog modal-xl modal-fullscreen-xl-down"},C={class:"modal-content"},N={class:"modal-header"},q=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addCustomerCloseButton"},[(0,a._)("span",{"aria-hidden":"true"})],-1),j={class:"modal-body"},R={class:"modal-footer"},L=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);var U=s(160),I=s(989),x=s(5705),$=s(760),D=s(5808);const T={name:"NewCustomerModal",setup:()=>({v$:(0,x.ZP)()}),components:{Icon:f.JO,NewCustomerForm:U.Z},props:{organisationId:{type:Number,default:0},titleList:{type:Array,default:()=>[]}},mixins:[D.Z],data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",flagValidationCheck:!1,organisationModel:{},titleModel:[]}),validations:{customerEmailModel:{required:$.C1,email:$.Do},customerFirstNameModel:{required:$.C1},customerLastNameModel:{required:$.C1},titleModel:{required:$.C1}},computed:{...(0,I.Se)({rootUrl:"getRootUrl"})},methods:{submitNewCustomer:async function(){if(this.flagValidationCheck=!0,setTimeout((()=>{this.flagValidationCheck=!1}),100),!await this.v$.$validate())return document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",void new _.u_(document.getElementById("errorModal")).show();const t=new FormData;t.set("customer_title",this.titleModel),t.set("customer_first_name",this.customerFirstNameModel),t.set("customer_last_name",this.customerLastNameModel),t.set("customer_email",this.customerEmailModel),t.set("organisation",this.organisationId),this.axios.post(`${this.rootUrl}new_customer/save/`,t).then((t=>{window.location.href=t.data})).catch((t=>{this.$store.dispatch("newToast",{header:"Could not save customer",message:`Sorry, could not save the customer. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))},updateCustomerData(t){this[t.field]=t.value}}};var E=s(3744);const O=(0,E.Z)(T,[["render",function(t,e,s,o,l,i){const r=(0,a.up)("Icon"),n=(0,a.up)("new-customer-form");return(0,a.wg)(),(0,a.iD)("div",y,[(0,a._)("div",w,[(0,a._)("div",C,[(0,a._)("div",N,[(0,a._)("h2",null,[(0,a.Wm)(r,{icon:t.icons.userIcon},null,8,["icon"]),(0,a.Uk)(" Add Customer Wizard ")]),q]),(0,a._)("div",j,[(0,a.Wm)(n,{"title-list":s.titleList,"flag-validation-check":l.flagValidationCheck,onUpdate_customer_data:e[0]||(e[0]=t=>i.updateCustomerData(t))},null,8,["title-list","flag-validation-check"])]),(0,a._)("div",R,[(0,a._)("a",{href:"javascript:void(0)",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>i.submitNewCustomer&&i.submitNewCustomer(...t))},"Add Contact"),L])])])])}]]);var W=s(8618);const Z=(0,a._)("p",{class:"text-instructions"}," The following are current OPEN objects associated with the organisation. ",-1),F={key:0},S={key:4,class:"spacer"},A={key:5,class:"alert alert-info"},V={name:"AssociatedObjects",components:{RenderObjectCard:s(7819).Z,Icon:f.JO},mixins:[D.Z],data:()=>({projectResults:[],projectVariables:{header:"Projects",prefix:"Pro",id:"project_id",title:"project_name",status:"project_status_text"},requirementResults:[],requirementVariables:{header:"Requirements",prefix:"Req",id:"requirement_id",title:"requirement_title",status:"requirement_status__requirement_status"},taskResults:[],taskVariables:{header:"Tasks",prefix:"Task",id:"task_id",title:"task_short_description",status:"task_status_text"}}),computed:{...(0,I.Se)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{getAssociatedObjectResults(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/associated_objects/`).then((t=>{this.projectResults=t.data.project,this.requirementResults=t.data.requirement,this.taskResults=t.data.task})).catch((t=>{}))},getFriendlyDate:t=>new Date(t).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},mounted(){this.$nextTick((()=>{this.getAssociatedObjectResults()}))}},P=(0,E.Z)(V,[["render",function(t,e,s,o,l,i){const r=(0,a.up)("Icon"),n=(0,a.up)("render-object-card");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("h2",null,[(0,a.Wm)(r,{icon:t.icons.objectStorage},null,8,["icon"]),(0,a.Uk)(" Associated Objects ")]),Z,l.projectResults.length+l.taskResults.length+l.requirementResults.length>0?((0,a.wg)(),(0,a.iD)("hr",F)):(0,a.kq)("v-if",!0),(0,a.kq)(" Project Results "),l.projectResults.length>0?((0,a.wg)(),(0,a.j4)(n,{key:1,"search-results":l.projectResults,"import-variables":l.projectVariables,destination:"project"},null,8,["search-results","import-variables"])):(0,a.kq)("v-if",!0),(0,a.kq)(" Requirement Results "),l.requirementResults.length>0?((0,a.wg)(),(0,a.j4)(n,{key:2,"search-results":l.requirementResults,"import-variables":l.requirementVariables,destination:"requirement"},null,8,["search-results","import-variables"])):(0,a.kq)("v-if",!0),(0,a.kq)(" Task Results "),l.taskResults.length>0?((0,a.wg)(),(0,a.j4)(n,{key:3,"search-results":l.taskResults,"import-variables":l.taskVariables,destination:"task"},null,8,["search-results","import-variables"])):(0,a.kq)("v-if",!0),(0,a.kq)(" Only show when there are no associated tasks "),l.projectResults.length+l.taskResults.length+l.requirementResults.length===0?((0,a.wg)(),(0,a.iD)("div",S)):(0,a.kq)("v-if",!0),l.projectResults.length+l.taskResults.length+l.requirementResults.length===0?((0,a.wg)(),(0,a.iD)("div",A,' There are currently no Objects associated with this Organisation. You can create some new objects by click on the "New Objects" menu item. ')):(0,a.kq)("v-if",!0)])}]]);var B=s(8737),z=s(624),J=s(2551),H=s(9586),Y=s(6200);const G={name:"OrganisationModules",components:{AddFolderWizard:s(1713).Z,AddLinkWizard:Y.Z,UploadDocumentWizard:H.Z,ConfirmFileDeleteVue:J.Z,AssociatedObjects:P,CustomersListModule:k.Z,DocumentsModule:B.Z,Icon:f.JO,ListTagsModule:M.Z,NewCustomerModal:O,NotesModule:W.Z},props:{customerResults:{type:Array,default:()=>[]},destination:{type:String,default:""},locationId:{type:Number,default:0},staticUrl:{type:String,default:"/"},rootUrl:{type:String,default:"/"},theme:{type:String,default:""},titleList:{type:Array,default:()=>[]},userLevel:{type:Number,default:0}},computed:{},mixins:[z.Z,D.Z],methods:{addNewContact(){new _.u_(document.getElementById("addCustomerModal")).show()}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateUrl",staticUrl:this.staticUrl,rootUrl:this.rootUrl}),this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.$store.commit({type:"updateDestination",destination:this.destination,locationId:this.locationId})}},K=(0,E.Z)(G,[["render",function(t,e,s,_,f,k){const M=(0,a.up)("Icon"),y=(0,a.up)("customers-list-module"),w=(0,a.up)("documents-module"),C=(0,a.up)("upload-document-wizard"),N=(0,a.up)("add-folder-wizard"),q=(0,a.up)("add-link-wizard"),j=(0,a.up)("confirm-file-delete-vue"),R=(0,a.up)("associated-objects"),L=(0,a.up)("list-tags-module"),U=(0,a.up)("notes-module"),I=(0,a.up)("new-customer-modal"),x=(0,a.up)("n-config-provider");return(0,a.wg)(),(0,a.j4)(x,{theme:t.getTheme(s.theme)},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("div",l,[(0,a.kq)(" The MENU Items "),i,r,(0,a.kq)(" The Modules "),(0,a._)("div",n,[(0,a._)("div",d,[(0,a._)("h2",null,[(0,a.Wm)(M,{icon:t.icons.userIcon},null,8,["icon"]),(0,a.Uk)(" Contacts ")]),u,(0,a.Wm)(y,{"customer-results":s.customerResults},null,8,["customer-results"]),(0,a.kq)(" ADD CUSTOMER BUTTON "),(0,a.kq)(" ADD IN PERMISSIONS "),s.userLevel>1?((0,a.wg)(),(0,a.iD)("hr",c)):(0,a.kq)("v-if",!0),s.userLevel>1?((0,a.wg)(),(0,a.iD)("div",m,[(0,a._)("div",p,[(0,a._)("button",{class:"btn btn-primary save-changes",onClick:e[0]||(e[0]=(...t)=>k.addNewContact&&k.addNewContact(...t))}," Add Contact ")])])):(0,a.kq)("v-if",!0)]),(0,a._)("div",h,[(0,a.Wm)(w,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,a.Wm)(C),(0,a.Wm)(N,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,a.Wm)(q,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,a.Wm)(j)]),(0,a._)("div",b,[(0,a.Wm)(R)]),(0,a._)("div",g,[(0,a.Wm)(L)]),(0,a._)("div",v,[(0,a.Wm)(U,{"location-id":s.locationId,destination:s.destination},null,8,["location-id","destination"])])])]),(0,a.kq)(" MODALS "),(0,a.Wm)(I,{"organisation-id":s.locationId,"title-list":s.titleList},null,8,["organisation-id","title-list"])])])),_:1},8,["theme"])}]])}}]);