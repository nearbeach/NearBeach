"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[2689],{3795:(e,t,s)=>{s.d(t,{A:()=>v});var a=s(641),o=s(3751);const l={class:"row"},i={class:"col-md-8"},r={class:"row"},n={class:"form-group col-sm-3"},d={class:"form-group col-sm-4"},u={class:"form-group col-sm-5"},c={class:"form-group col-sm-8 mt-4 mb-4"};var m=s(1080),b=s(9639),h=s(3855),p=s(404);const g={name:"NewCustomerForm",setup:()=>({v$:(0,b.Ay)()}),components:{NSelect:m.A,ValidationRendering:p.A},emits:["update_customer_data"],props:{flagValidationCheck:{type:Boolean,default:!1},titleList:{type:Array,default:()=>[]}},data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",organisationModel:{},searchTimeout:"",titleFixList:[],titleModel:[]}),validations:{customerEmailModel:{required:h.mw,email:h.Rp},customerFirstNameModel:{required:h.mw},customerLastNameModel:{required:h.mw},titleModel:{required:h.mw}},methods:{},watch:{customerEmailModel(){this.$emit("update_customer_data",{field:"customerEmailModel",value:this.customerEmailModel})},customerFirstNameModel(){this.$emit("update_customer_data",{field:"customerFirstNameModel",value:this.customerFirstNameModel})},customerLastNameModel(){this.$emit("update_customer_data",{field:"customerLastNameModel",value:this.customerLastNameModel})},flagValidationCheck(){this.flagValidationCheck&&this.v$.$touch()},titleModel(){this.$emit("update_customer_data",{field:"titleModel",value:this.titleModel})}},mounted(){this.titleFixList=this.titleList.map((e=>({value:e.pk,label:e.fields.title})))}},v=(0,s(6262).A)(g,[["render",function(e,t,s,m,b,h){const p=(0,a.g2)("validation-rendering"),g=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",l,[t[8]||(t[8]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"New Customer"),(0,a.Lk)("p",{class:"text-instructions"}," Please fill out the following details. "),(0,a.Lk)("strong",null,"Please Note:"),(0,a.Lk)("p",{class:"text-instructions"}," Customers do not go through a duplication process. Please search for the potential customer first before adding them into NearBeach. ")],-1)),(0,a.Lk)("div",i,[(0,a.Q3)(" CUSTOMER DETAILS "),(0,a.Lk)("div",r,[(0,a.Lk)("div",n,[(0,a.Lk)("label",null,[t[4]||(t[4]=(0,a.eW)(" Title: ")),(0,a.bF)(p,{"error-list":m.v$.titleModel.$errors},null,8,["error-list"])]),(0,a.bF)(g,{options:b.titleFixList,label:"title",placeholder:"",value:b.titleModel,"onUpdate:value":t[0]||(t[0]=e=>b.titleModel=e)},null,8,["options","value"])]),(0,a.Lk)("div",d,[(0,a.Lk)("label",null,[t[5]||(t[5]=(0,a.eW)(" First Name: ")),(0,a.bF)(p,{"error-list":m.v$.customerFirstNameModel.$errors},null,8,["error-list"])]),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>b.customerFirstNameModel=e)},null,512),[[o.vModelText,b.customerFirstNameModel]])]),(0,a.Lk)("div",u,[(0,a.Lk)("label",null,[t[6]||(t[6]=(0,a.eW)(" Last Name: ")),(0,a.bF)(p,{"error-list":m.v$.customerLastNameModel.$errors},null,8,["error-list"])]),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>b.customerLastNameModel=e)},null,512),[[o.vModelText,b.customerLastNameModel]])])]),(0,a.Q3)(" Customer Email "),(0,a.Lk)("div",c,[(0,a.Lk)("label",null,[t[7]||(t[7]=(0,a.eW)(" Email: ")),(0,a.bF)(p,{"error-list":m.v$.customerEmailModel.$errors},null,8,["error-list"])]),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>b.customerEmailModel=e)},null,512),[[o.vModelText,b.customerEmailModel]])])])])}]])},5578:(e,t,s)=>{s.r(t),s.d(t,{default:()=>B});var a=s(641);const o={class:"card"},l={class:"card-body"},i={class:"nav nav-tabs",id:"misc_module_tabs",role:"tablist"},r={key:0,class:"nav-item",role:"presentation"},n={class:"tab-content",id:"misc_module_content"},d={class:"tab-pane fade",id:"organisation-contacts",role:"tabpanel","aria-labelledby":"profile-tab"},u={key:0},c={key:1,class:"row submit-row"},m={class:"col-md-12"},b={class:"tab-pane fade",id:"document-uploads",role:"tabpanel","aria-labelledby":"profile-tab"},h={class:"tab-pane fade",id:"associated-objects",role:"tabpanel","aria-labelledby":"profile-tab"},p={class:"tab-pane fade",id:"misc-modules",role:"tabpanel","aria-labelledby":"profile-tab"},g={class:"tab-pane fade",id:"notes-modules",role:"tabpanel","aria-labelledby":"profile-tab"},v={key:0,class:"tab-pane fade bg-danger",id:"admin",role:"tabpanel","aria-labelledby":"contact-tab"};var k=s(9336),f=s(3233),L=s(9142);const y={class:"modal fade",id:"addCustomerModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},M={class:"modal-dialog modal-xl modal-fullscreen-xl-down"},w={class:"modal-content"},C={class:"modal-body"},N={class:"modal-footer"};var A=s(3795),R=s(2124),_=s(9639),F=s(3855);const j={name:"NewCustomerModal",setup:()=>({v$:(0,_.Ay)()}),components:{NewCustomerForm:A.A},props:{organisationId:{type:Number,default:0},titleList:{type:Array,default:()=>[]}},data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",flagValidationCheck:!1,organisationModel:{},titleModel:[]}),validations:{customerEmailModel:{required:F.mw,email:F.Rp},customerFirstNameModel:{required:F.mw},customerLastNameModel:{required:F.mw},titleModel:{required:F.mw}},computed:{...(0,R.L8)({rootUrl:"getRootUrl"})},methods:{async submitNewCustomer(){if(this.flagValidationCheck=!0,setTimeout((()=>{this.flagValidationCheck=!1}),100),!await this.v$.$validate())return void this.$store.dispatch("newToast",{header:"Please check validation",message:"Sorry, but can you please fix all validation issues.",extra_classes:"bg-warning text-dark",delay:0});const e=new FormData;e.set("customer_title",this.titleModel),e.set("customer_first_name",this.customerFirstNameModel),e.set("customer_last_name",this.customerLastNameModel),e.set("customer_email",this.customerEmailModel),e.set("organisation",this.organisationId),this.axios.post(`${this.rootUrl}new_customer/save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Could not save customer",message:`Sorry, could not save the customer. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},updateCustomerData(e){this[e.field]=e.value}}};var E=s(6262);const x=(0,E.A)(j,[["render",function(e,t,s,o,l,i){const r=(0,a.g2)("new-customer-form");return(0,a.uX)(),(0,a.CE)("div",y,[(0,a.Lk)("div",M,[(0,a.Lk)("div",w,[t[3]||(t[3]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h2",null," Add Customer Wizard "),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addCustomerCloseButton"},[(0,a.Lk)("span",{"aria-hidden":"true"})])],-1)),(0,a.Lk)("div",C,[(0,a.bF)(r,{"title-list":s.titleList,"flag-validation-check":l.flagValidationCheck,onUpdate_customer_data:t[0]||(t[0]=e=>i.updateCustomerData(e))},null,8,["title-list","flag-validation-check"])]),(0,a.Lk)("div",N,[(0,a.Lk)("a",{href:"javascript:void(0)",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>i.submitNewCustomer&&i.submitNewCustomer(...e))},"Add Contact"),t[2]||(t[2]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1))])])])])}]]);var $=s(5738),T=s(5890),U=s(2806),Q=s(310),q=s(1614),I=s(6191),O=s(9981),D=s(2899),V=s(2787),S=s(6434),W=s(1367),P=s(4325),X=s(9581);const z={name:"OrganisationModules",components:{AddTagWizard:W.A,AddFolderWizard:O.A,AddLinkWizard:I.A,AssociatedObjects:T.A,ConfirmFileDeleteVue:Q.A,ConfirmNoteDelete:S.A,CustomersListModule:f.A,DeleteObject:P.A,DocumentsModule:U.A,EditHistoryNoteWizard:D.A,ListTagsModule:L.A,NewCustomerModal:x,NewHistoryNoteWizard:V.A,NotesModule:$.A,UploadDocumentWizard:q.A},props:{customerResults:{type:Array,default:()=>[]},destination:{type:String,default:""},locationId:{type:Number,default:0},staticUrl:{type:String,default:"/"},rootUrl:{type:String,default:"/"},theme:{type:String,default:""},titleList:{type:Array,default:()=>[]},userExtraPermissions:{type:Array,default:()=>[]},userLevel:{type:Number,default:0}},data(){return{localCustomerResults:this.customerResults}},computed:{},emits:["remove_customer"],methods:{useNBTheme:X.p,addNewContact(){new k.aF(document.getElementById("addCustomerModal")).show()},removeCustomer(e){this.localCustomerResults=this.localCustomerResults.filter((t=>parseInt(t.pk)!==parseInt(e)))}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateUrl",staticUrl:this.staticUrl,rootUrl:this.rootUrl}),this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.$store.commit({type:"updateDestination",destination:this.destination,locationId:this.locationId}),this.$store.commit({type:"updateUserExtraPermissions",userExtraPermissions:this.userExtraPermissions})}},B=(0,E.A)(z,[["render",function(e,t,s,k,f,L){const y=(0,a.g2)("customers-list-module"),M=(0,a.g2)("documents-module"),w=(0,a.g2)("upload-document-wizard"),C=(0,a.g2)("add-folder-wizard"),N=(0,a.g2)("add-link-wizard"),A=(0,a.g2)("confirm-file-delete-vue"),R=(0,a.g2)("associated-objects"),_=(0,a.g2)("list-tags-module"),F=(0,a.g2)("notes-module"),j=(0,a.g2)("edit-history-note-wizard"),E=(0,a.g2)("new-history-note-wizard"),x=(0,a.g2)("confirm-note-delete"),$=(0,a.g2)("delete-object"),T=(0,a.g2)("new-customer-modal"),U=(0,a.g2)("add-tag-wizard"),Q=(0,a.g2)("n-config-provider");return(0,a.uX)(),(0,a.Wv)(Q,{theme:L.useNBTheme(s.theme)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",o,[(0,a.Lk)("div",l,[(0,a.Q3)(" The MENU Items "),(0,a.Lk)("ul",i,[(0,a.Q3)(" Organisation Contacts "),t[3]||(t[3]=(0,a.Lk)("li",{class:"nav-item",role:"presentation"},[(0,a.Lk)("button",{class:"nav-link",id:"organisation-contacts-tab","data-bs-toggle":"tab","data-bs-target":"#organisation-contacts",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Organisation Contacts ")],-1)),(0,a.Q3)(" Document Uploads "),t[4]||(t[4]=(0,a.Lk)("li",{class:"nav-item",role:"presentation"},[(0,a.Lk)("button",{class:"nav-link",id:"document-uploads-tab","data-bs-toggle":"tab","data-bs-target":"#document-uploads",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Document Uploads ")],-1)),(0,a.Q3)(" Associated Projects & Tasks "),t[5]||(t[5]=(0,a.Lk)("li",{class:"nav-item",role:"presentation"},[(0,a.Lk)("button",{class:"nav-link",id:"associated-objects-tab","data-bs-toggle":"tab","data-bs-target":"#associated-objects",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Associated Objects ")],-1)),(0,a.Q3)(" Misc Modules "),t[6]||(t[6]=(0,a.Lk)("li",{class:"nav-item",role:"presentation"},[(0,a.Lk)("button",{class:"nav-link",id:"misc-modules-tab","data-bs-toggle":"tab","data-bs-target":"#misc-modules",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Misc ")],-1)),(0,a.Q3)(" Notes Modules "),t[7]||(t[7]=(0,a.Lk)("li",{class:"nav-item",role:"presentation"},[(0,a.Lk)("button",{class:"nav-link",id:"notes-modules-tab","data-bs-toggle":"tab","data-bs-target":"#notes-modules",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Notes ")],-1)),(0,a.Q3)(" ADMIN "),4===s.userLevel?((0,a.uX)(),(0,a.CE)("li",r,t[2]||(t[2]=[(0,a.Lk)("button",{class:"nav-link",id:"admin-tab","data-bs-toggle":"tab","data-bs-target":"#admin",type:"button",role:"tab","aria-controls":"home","aria-select":"false"}," Admin ",-1)]))):(0,a.Q3)("v-if",!0)]),t[10]||(t[10]=(0,a.Lk)("hr",null,null,-1)),(0,a.Q3)(" The Modules "),(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[t[8]||(t[8]=(0,a.Lk)("h2",null," Contacts ",-1)),t[9]||(t[9]=(0,a.Lk)("p",{class:"text-instructions"}," Below are a list of contacts who are connected to this organisation. ",-1)),(0,a.bF)(y,{"customer-results":f.localCustomerResults,onRemove_customer:t[0]||(t[0]=e=>L.removeCustomer(e))},null,8,["customer-results"]),(0,a.Q3)(" ADD CUSTOMER BUTTON "),(0,a.Q3)(" ADD IN PERMISSIONS "),s.userLevel>1?((0,a.uX)(),(0,a.CE)("hr",u)):(0,a.Q3)("v-if",!0),s.userLevel>1?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",m,[(0,a.Lk)("button",{class:"btn btn-primary save-changes",onClick:t[1]||(t[1]=(...e)=>L.addNewContact&&L.addNewContact(...e))}," Add Contact ")])])):(0,a.Q3)("v-if",!0)]),(0,a.Lk)("div",b,[(0,a.bF)(M,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,a.bF)(w),(0,a.bF)(C,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,a.bF)(N,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,a.bF)(A)]),(0,a.Lk)("div",h,[(0,a.bF)(R)]),(0,a.Lk)("div",p,[(0,a.bF)(_)]),(0,a.Lk)("div",g,[(0,a.bF)(F,{"location-id":s.locationId,destination:s.destination},null,8,["location-id","destination"]),(0,a.bF)(j),(0,a.bF)(E,{"location-id":s.locationId,destination:s.destination},null,8,["location-id","destination"]),(0,a.bF)(x)]),4===s.userLevel?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.bF)($)])):(0,a.Q3)("v-if",!0)])]),(0,a.Q3)(" MODALS "),(0,a.bF)(T,{"organisation-id":s.locationId,"title-list":s.titleList},null,8,["organisation-id","title-list"]),(0,a.bF)(U)])])),_:1},8,["theme"])}]])},5890:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(641);const o={key:0},l={key:4,class:"spacer"},i={key:5,class:"alert alert-info"};var r=s(2124);const n={name:"AssociatedObjects",components:{RenderObjectCard:s(9724).A},data:()=>({projectResults:[],projectVariables:{header:"Projects",prefix:"Pro",id:"project_id",title:"project_name",status:"project_status_text"},requirementResults:[],requirementVariables:{header:"Requirements",prefix:"Req",id:"requirement_id",title:"requirement_title",status:"requirement_status__requirement_status"},taskResults:[],taskVariables:{header:"Tasks",prefix:"Task",id:"task_id",title:"task_short_description",status:"task_status_text"}}),computed:{...(0,r.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{getAssociatedObjectResults(){0!==this.locationId?this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/associated_objects/`).then((e=>{this.projectResults=e.data.project,this.requirementResults=e.data.requirement,this.taskResults=e.data.task})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Associated Objects",message:`Sorry, we could not get associated objects. Error -> ${e}`,extra_classes:"bg-danger",delay:0})})):setTimeout((()=>{this.getAssociatedObjectResults()}),100)},getFriendlyDate:e=>new Date(e).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},mounted(){this.$nextTick((()=>{this.getAssociatedObjectResults()}))}},d=(0,s(6262).A)(n,[["render",function(e,t,s,r,n,d){const u=(0,a.g2)("render-object-card");return(0,a.uX)(),(0,a.CE)("div",null,[t[0]||(t[0]=(0,a.Lk)("h2",null," Associated Objects ",-1)),t[1]||(t[1]=(0,a.Lk)("p",{class:"text-instructions"}," The following are current OPEN objects associated with the organisation. ",-1)),n.projectResults.length+n.taskResults.length+n.requirementResults.length>0?((0,a.uX)(),(0,a.CE)("hr",o)):(0,a.Q3)("v-if",!0),(0,a.Q3)(" Project Results "),n.projectResults.length>0?((0,a.uX)(),(0,a.Wv)(u,{key:1,"search-results":n.projectResults,"import-variables":n.projectVariables,destination:"project"},null,8,["search-results","import-variables"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" Requirement Results "),n.requirementResults.length>0?((0,a.uX)(),(0,a.Wv)(u,{key:2,"search-results":n.requirementResults,"import-variables":n.requirementVariables,destination:"requirement"},null,8,["search-results","import-variables"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" Task Results "),n.taskResults.length>0?((0,a.uX)(),(0,a.Wv)(u,{key:3,"search-results":n.taskResults,"import-variables":n.taskVariables,destination:"task"},null,8,["search-results","import-variables"])):(0,a.Q3)("v-if",!0),(0,a.Q3)(" Only show when there are no associated tasks "),n.projectResults.length+n.taskResults.length+n.requirementResults.length===0?((0,a.uX)(),(0,a.CE)("div",l)):(0,a.Q3)("v-if",!0),n.projectResults.length+n.taskResults.length+n.requirementResults.length===0?((0,a.uX)(),(0,a.CE)("div",i,' There are currently no Objects associated with this Organisation. You can create some new objects by click on the "New Objects" menu item. ')):(0,a.Q3)("v-if",!0)])}]])}}]);