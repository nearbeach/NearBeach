"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[6819],{5900:(e,t,a)=>{a.d(t,{Z:()=>te});var o=a(6252),r=a(3577),s=a(9963);const i={key:0,class:"error"},l=(0,o._)("br",null,null,-1),d=["id","data-property","data-id","data-title"],n=["id","data-id","data-property","data-title"],p=["onClick"],m=(0,o._)("hr",null,null,-1),c=["id"],y={class:"modal-dialog"},h={class:"modal-content"},u={class:"modal-header"},I={class:"modal-title",id:"exampleModalLabel"},b=["id"],g={class:"modal-body"},v={class:"form-group"},w={key:0,class:"form-group"},_={class:"modal-footer"},k=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),P=["id"],C={class:"modal-dialog"},N={class:"modal-content"},D={class:"modal-header"},f={class:"modal-title"},L=["id"],M={class:"modal-body"},Z={class:"alert alert-warning"},$=(0,o._)("h4",null,"WARNING",-1),S=(0,o._)("p",null," All existing cards will be moved to the stated location you have provided. Any cards that have been archived or deleted, will still be associated with the removed card. ",-1),x={class:"row"},A=(0,o._)("div",{class:"spacer"},null,-1),E={key:0,class:"row"},B=(0,o._)("p",null,"Please select an appropriate destination for the current cards.",-1),O=(0,o._)("label",null,[(0,o._)("strong",null,"Destination for Cards")],-1),R=(0,o._)("br",null,null,-1),T={class:"modal-footer"},U=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),q=["disabled"];var W=a(3138),F=a(6542),G=a(9352),V=a(94),K=a(2001),j=a(1645),z=a(9980),J=a.n(z),X=a(989),Y=a(5705),H=a(760),Q=a(5808);const ee={name:"KanbanPropertyOrder",setup:()=>({v$:(0,Y.ZP)()}),components:{draggable:J(),Icon:F.JO,NRadio:G.Z,NRadioGroup:V.Z,NSelect:K.Z,NSpace:j.Z},props:{isDirty:{type:Boolean,default:!0},isNewMode:{type:Boolean,default:!0},isReadOnly:{type:Boolean,default:!1},kanbanBoardId:{type:Number,default:0},propertyList:{type:Array,default:()=>[]},propertyName:{type:String,default:""},source:{type:String,default:""}},data(){return{columnPropertyModel:"Normal",columnPropertyOptions:[{label:"Backlog",value:"Backlog"},{label:"Normal",value:"Normal"},{label:"Blocked",value:"Blocked"},{label:"Closed",value:"Closed"}],deleteItemId:"",destinationItemId:"",localPropertyList:this.propertyList,newCardDestinationList:[],newPropertyItem:"",removeCardsModel:!1,singleItemId:""}},mixins:[Q.Z],validations:{localPropertyList:{required:H.C1}},watch:{propertyList(){this.localPropertyList=this.propertyList}},computed:{...(0,X.Se)({canDragCards:"getCanDragCards",rootUrl:"getRootUrl"})},methods:{addItem(){""!==this.newPropertyItem&&(this.isNewMode?this.newModeAddItem():this.editModeAddItem(),this.sendPropertyListUp(),document.getElementById(`addItemClose${this.propertyName}`).click())},deleteItem(){const e=new FormData;e.set("delete_item_id",this.deleteItemId),this.removeCardsModel||e.set("destination_item_id",this.destinationItemId);const t=`${this.rootUrl}kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/delete/`;this.axios.post(t,e).then((e=>{this.localPropertyList=this.localPropertyList.filter((e=>e.id!==this.deleteItemId)),this.$emit("update_property_list",{source:this.source,data:this.localPropertyList}),document.getElementById(`deleteItemClose${this.propertyName}`).click()})).catch((e=>{this.$store.dispatch("newToast",{header:"Can not delete item",message:`Sorry, but we are having issues deleting item - Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},editItem(e){this.isReadOnly||(this.newPropertyItem=e.target.dataset.title,this.singleItemId=e.target.dataset.id,this.columnPropertyModel=e.target.dataset.property,this.openModal())},editModeAddItem:async function(){const e=`kanban_${this.propertyName.toLowerCase()}_name`,t=`kanban_${this.propertyName.toLowerCase()}_sort_number`,a=this.singleItemId,o=new FormData;if(o.set(e,this.newPropertyItem),o.set(t,this.getMaxId()+1),"Column"===this.propertyName&&o.set("kanban_column_property",this.columnPropertyModel),""===a)var r=`/kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/new/`;else r=`/kanban_${this.propertyName.toLowerCase()}/${this.singleItemId}/edit/`;await this.axios.post(r,o).then((t=>{const o=t.data[0];""===a?this.localPropertyList.push({id:o.pk,property:o.fields.kanban_column_property,title:o.fields[e]}):this.localPropertyList.forEach((e=>{parseInt(e.id)===parseInt(this.singleItemId)&&(e.title=this.newPropertyItem,e.property=this.columnPropertyModel)})),this.singleItemId="",this.newPropertyItem=""})).catch((e=>{this.showErrorModal(e,"kanban board",this.kanbanBoardId),this.$store.dispatch("newToast",{header:"Can not add/edit",message:`Sorry, but we are having issues editing or adding - Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},getMaxId(){const e=this.localPropertyList.map((e=>e.id));return e.sort(((e,t)=>e-t))[e.length-1]},newModeAddItem(){""===this.singleItemId?this.localPropertyList.push({id:this.getMaxId()+1,property:this.columnPropertyModel,title:this.newPropertyItem}):this.localPropertyList.forEach((e=>{e.id===this.singleItemId&&(e.title=this.newPropertyItem,e.property=this.columnPropertyModel)})),this.singleItemId="",this.newPropertyItem=""},openModal(){new W.u_(document.getElementById(`addItem${this.propertyName}`)).show()},removeItem(e){this.isNewMode?(this.localPropertyList=this.localPropertyList.filter((t=>t.id!==e)),this.sendPropertyListUp()):(this.deleteItemId=e,this.newCardDestinationList=this.localPropertyList.filter((e=>e.id!==this.deleteItemId)).map((e=>({value:e.id,label:e.title}))),this.destinationItemId=this.newCardDestinationList[0].value,new W.u_(document.getElementById(`deleteItem${this.propertyName}`)).show())},sendPropertyListUp(){if(this.$emit("update_property_list",{source:this.source,data:this.localPropertyList}),!this.isNewMode){const e=`/kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/resort/`,t=new FormData;this.localPropertyList.forEach(((e,a)=>{t.append("item",e.id)})),this.axios.post(e,t).catch((e=>{this.$store.dispatch("newToast",{header:"Can not apply resort",message:`Sorry, we've had an issue resorting. Please refresh the page. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}}}},te=(0,a(3744).Z)(ee,[["render",function(e,t,a,W,F,G){const V=(0,o.up)("Icon"),K=(0,o.up)("draggable"),j=(0,o.up)("n-select"),z=(0,o.up)("n-radio"),J=(0,o.up)("n-space"),X=(0,o.up)("n-radio-group");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("strong",null,(0,r.toDisplayString)(a.propertyName),1),!W.v$.localPropertyList.required&&a.isDirty?((0,o.wg)(),(0,o.iD)("span",i," Please create at least one "+(0,r.toDisplayString)(a.propertyName)+".",1)):(0,o.kq)("v-if",!0),l,(0,o.kq)(" The column of data where you can sort the properties "),(0,o.Wm)(K,{modelValue:F.localPropertyList,"onUpdate:modelValue":t[1]||(t[1]=e=>F.localPropertyList=e),disabled:!e.canDragCards||a.isReadOnly,"item-key":"pk","ghost-class":"ghost",onChange:G.sendPropertyListUp},{item:(0,o.w5)((({element:a})=>[((0,o.wg)(),(0,o.iD)("div",{class:"sortable",key:a.id,id:a.id,"data-property":a.property,"data-id":a.id,"data-title":a.title,onDblclick:t[0]||(t[0]=e=>G.editItem(e))},[((0,o.wg)(),(0,o.iD)("strong",{key:a.id,id:a.id,"data-id":a.id,"data-property":a.property,"data-title":a.title},(0,r.toDisplayString)(a.title),9,n)),F.localPropertyList.length>1?((0,o.wg)(),(0,o.iD)("span",{key:0,onClick:e=>G.removeItem(a.id)},[(0,o.Wm)(V,{icon:e.icons.xCircle},null,8,["icon"])],8,p)):(0,o.kq)("v-if",!0)],40,d))])),_:1},8,["modelValue","disabled","onChange"]),(0,o.kq)(" ADD BUTTON "),m,!1===a.isReadOnly?((0,o.wg)(),(0,o.iD)("button",{key:1,class:"btn btn-primary",onClick:t[2]||(t[2]=(...e)=>G.openModal&&G.openModal(...e))}," Add "+(0,r.toDisplayString)(a.propertyName)+" Item ",1)):(0,o.kq)("v-if",!0),(0,o.kq)(" MODAL FOR ADDING AN EXTRA ROW "),(0,o._)("div",{class:"modal fade",id:`addItem${a.propertyName}`,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,o._)("div",y,[(0,o._)("div",h,[(0,o._)("div",u,[(0,o._)("h5",I," Add/Edit "+(0,r.toDisplayString)(a.propertyName),1),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:`addItemClose${a.propertyName}`},null,8,b)]),(0,o._)("div",g,[(0,o._)("div",v,[(0,o._)("label",null,(0,r.toDisplayString)(a.propertyName)+" Item Description",1),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>F.newPropertyItem=e),type:"text",class:"form-control"},null,512),[[s.vModelText,F.newPropertyItem]])]),"column"===a.propertyName.toLowerCase()?((0,o.wg)(),(0,o.iD)("div",w,[(0,o._)("label",null,(0,r.toDisplayString)(a.propertyName)+" Property",1),(0,o.Wm)(j,{value:F.columnPropertyModel,"onUpdate:value":t[4]||(t[4]=e=>F.columnPropertyModel=e),options:F.columnPropertyOptions},null,8,["value","options"])])):(0,o.kq)("v-if",!0)]),(0,o._)("div",_,[k,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>G.addItem&&G.addItem(...e))}," Save changes ")])])])],8,c),(0,o.kq)(" MODAL FOR DELETING ITEM "),(0,o._)("div",{class:"modal fade",id:`deleteItem${a.propertyName}`,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,o._)("div",C,[(0,o._)("div",N,[(0,o._)("div",D,[(0,o._)("h5",f,"Delete "+(0,r.toDisplayString)(a.propertyName),1),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:`deleteItemClose${a.propertyName}`},null,8,L)]),(0,o._)("div",M,[(0,o.kq)(" WARNING "),(0,o._)("div",Z,[$,(0,o._)("p",null," This process can not be reversed. Deleting a "+(0,r.toDisplayString)(a.propertyName)+" will remove it. ",1),S]),(0,o.kq)(" ASK USER ABOUT CARDS "),(0,o._)("div",x,[(0,o._)("p",null,"Would you like to remove the cards within the "+(0,r.toDisplayString)(a.propertyName)+"?",1),(0,o.Wm)(X,{value:F.removeCardsModel,"onUpdate:value":t[6]||(t[6]=e=>F.removeCardsModel=e),name:"radiogroup"},{default:(0,o.w5)((()=>[(0,o.Wm)(J,null,{default:(0,o.w5)((()=>[(0,o.Wm)(z,{value:!0,label:"Yes - please remove cards"}),(0,o.Wm)(z,{value:!1,label:"No - please MOVE cards"})])),_:1})])),_:1},8,["value"])]),(0,o.kq)(" CARD DESTINATIONS "),A,F.removeCardsModel?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("div",E,[B,O,(0,o.Wm)(j,{options:F.newCardDestinationList,value:F.destinationItemId,"onUpdate:value":t[7]||(t[7]=e=>F.destinationItemId=e),style:{"z-index":"9999"},class:"new-card-destination"},null,8,["options","value"])])),R]),(0,o._)("div",T,[U,!1===a.isReadOnly?((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=(...e)=>G.deleteItem&&G.deleteItem(...e)),disabled:null==this.destinationItemId}," Delete "+(0,r.toDisplayString)(a.propertyName),9,q)):(0,o.kq)("v-if",!0)])])])],8,P)])}]])},624:(e,t,a)=>{a.d(t,{Z:()=>r});var o=a(7449);const r={data:()=>({darkTheme:o.$}),methods:{getTheme:e=>"dark"===e?o.$:null}}},5808:(e,t,a)=>{a.d(t,{Z:()=>L});var o=a(3985),r=a(5555),s=a(1826),i=a(6443),l=a(1327),d=a(8521),n=a(1056),p=a(4324),m=a(9672),c=a(9867),y=a(1239),h=a(5004),u=a(1321),I=a(1216),b=a(5550),g=a(7702),v=a(7903),w=a(2606),_=a(3843),k=a(2393),P=a(3360),C=a(9714),N=a(1323),D=a(2610),f=a(5968);const L={data:()=>({icons:{arrowUp:o.Z,bugIcon:r.Z,bxBriefcase:s.Z,cardChecklist:i.Z,clipboardIcon:l.Z,documentPdf:d.Z,documentText:n.Z,folderIcon:p.Z,groupPresentation:m.Z,imageIcon:c.Z,infoCircle:y.Z,linkIcon:h.Z,linkIcon2:u.Z,linkOut:I.Z,mailIcon:b.Z,microsoftExcel:g.Z,microsoftPowerpoint:v.Z,microsoftWord:w.Z,noteAdd:_.Z,objectStorage:k.Z,passwordIcon:P.Z,trashCan:C.Z,userIcon:N.Z,usersIcon:D.Z,xCircle:f.Z}})}}}]);