"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[2284],{2283:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var s=i(641);const a={class:"card"},n={class:"card-body"};var l=i(384);const c={name:"KanbanPublicLinks",methods:{useNBTheme:i(9581).p},props:{isReadOnly:{type:Boolean,default:!1},locationId:{type:Number,default:0},theme:{type:String,default:""}},components:{ListPublicLinks:l.A}},o=(0,i(6262).A)(c,[["render",function(e,t,i,l,c,o){const r=(0,s.g2)("list-public-links"),u=(0,s.g2)("n-config-provider");return(0,s.uX)(),(0,s.Wv)(u,{theme:o.useNBTheme(i.theme)},{default:(0,s.k6)((()=>[(0,s.Lk)("div",a,[(0,s.Lk)("div",n,[(0,s.bF)(r,{"is-read-only":i.isReadOnly,"override-destination":"kanban_board","override-location-id":i.locationId},null,8,["is-read-only","override-location-id"])])])])),_:1},8,["theme"])}]])},384:(e,t,i)=>{i.d(t,{A:()=>$});var s=i(641),a=i(33);const n=(0,s.Lk)("h2",null,"Public Links",-1),l=(0,s.Lk)("p",{class:"text-instructions"}," The following will be public links you can send to clients. The links will contain certain information of the current object. i.e. it's status and description. Becareful who you send the links too! ",-1),c={key:0,class:"alert alert-info"},o={key:1,class:"alert alert-info"},r={key:2,class:"table table-striped"},u=(0,s.Lk)("td",null,"Public Link",-1),d=(0,s.Lk)("td",{style:{"text-align":"center",width:"100px"}},"Is Active",-1),h={key:0,style:{width:"10px"}},k=["onClick"],p={style:{"text-align":"center"}},b=["checked","data-public-link-id","disabled"],g={key:0},L={class:"remove-link"},y={key:3,class:"row submit-row"},v={class:"col-md-12"};var m=i(2124),_=i(3980),w=i(9336);const f={name:"ListPublicLinks",props:{isReadOnly:{type:Boolean,default:!1},overrideDestination:{type:String,default:""},overrideLocationId:{type:Number,default:0}},data:()=>({isFetchingData:!0}),watch:{overrideLocationId(){this.getPublicLinks()}},components:{CarbonTrashCan:_.dA},computed:{...(0,m.L8)({destination:"getDestination",locationId:"getLocationId",publicLinkResults:"getPublicLinkResults",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{confirmDeletePublicLink(e){this.$store.commit({type:"updatePublicLinkRemoveKey",publicLinkRemoveKey:e});const t=document.getElementById("cardInformationModalCloseButton");null!==t&&t.click(),new w.aF(document.getElementById("confirmPublicLinkDeleteModal")).show()},async copyPublicLink(e){const t=`${window.location.origin}${this.rootUrl}public/${this.getDestination()}/${this.getLocationId()}/${e}/`;try{await navigator.clipboard.writeText(t),this.$store.dispatch("newToast",{header:"Public Link Copied",message:"Public Link has successfully copied to the clipboard",extra_classes:"bg-success"})}catch(e){this.$store.dispatch("newToast",{header:"Can not copy public link",message:"Sorry, we failed to copy the public link",extra_classes:"bg-danger",delay:0})}},createPublicLink(){this.$store.dispatch("newToast",{header:"Creating New Toast",message:"Please wait whilst we create the toast",extra_classes:"bg-warning text-dark",delay:0,unique_type:"create_public_link"}),this.axios.post(`${this.rootUrl}public_data/${this.getDestination()}/${this.getLocationId()}/create/`).then((e=>{this.$store.dispatch("newToast",{header:"Successful new Public Link",message:"We have been able to create a new public link",extra_classes:"bg-success",unique_type:"create_public_link"}),this.$store.commit({type:"updatePublicLinkResults",publicLinkResults:e.data})})).catch((e=>{this.$store.dispatch("newToast",{header:"Can not create new public link",message:`Sorry, we failed to create the new public link. Error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"create_public_link"})}))},formatUrl(e){if(""===e||void 0===e)return"Data error!";const t=e.slice(0,7);return`${window.location.origin}${this.rootUrl}public/${this.getDestination()}/${this.getLocationId()}/${t}...`},getDestination(){return""!==this.overrideDestination?this.overrideDestination:this.destination},getLocationId(){return""!==this.overrideDestination?this.overrideLocationId:this.locationId},getPublicLinks(){0!==this.getLocationId()&&this.axios(`${this.rootUrl}public_data/${this.getDestination()}/${this.getLocationId()}/get_links/`).then((e=>{this.$store.commit({type:"updatePublicLinkResults",publicLinkResults:e.data}),this.isFetchingData=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Error fetching Public Links",message:`We had an issue fetching the public links for this object. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},updateIsActive(e){const t=e.target.dataset.publicLinkId;this.$store.dispatch("newToast",{header:"Updating Active Status for Private Link",message:"Please wait - we are updating the status",extra_classes:"bg-warning text-dark",delay:0,unique_type:`is_active-${t}`});let i="False";e.target.checked&&(i="True");const s=new FormData;s.set("public_link_id",t),s.set("public_link_is_active",i),this.axios.post(`${this.rootUrl}public_data/${this.destination}/${this.locationId}/update_link/`,s).then((()=>{this.$store.dispatch("newToast",{header:"Successfully Updated",message:"We have updated the is active status for the link",extra_classes:"bg-success",unique_type:`is_active-${t}`})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Updating Active Status for Private Link",message:`We are sorry, something went wrong. Error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:`is_active-${t}`})}))}},mounted(){this.$nextTick((()=>{this.getPublicLinks()}))}},$=(0,i(6262).A)(f,[["render",function(e,t,i,m,_,w){const f=(0,s.g2)("carbon-trash-can");return(0,s.uX)(),(0,s.CE)(s.FK,null,[n,l,_.isFetchingData?((0,s.uX)(),(0,s.CE)("div",c,"Currently loading data...")):(0,s.Q3)("v-if",!0),!1===_.isFetchingData&&0===e.publicLinkResults.length?((0,s.uX)(),(0,s.CE)("div",o," Sorry. There are no public links setup for this object. ")):((0,s.uX)(),(0,s.CE)("table",r,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[u,d,e.userLevel>1?((0,s.uX)(),(0,s.CE)("td",h)):(0,s.Q3)("v-if",!0)])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.publicLinkResults,(i=>((0,s.uX)(),(0,s.CE)("tr",{key:i.public_link_id},[(0,s.Lk)("td",null,[(0,s.Lk)("button",{type:"button",class:"btn btn-link",onClick:e=>w.copyPublicLink(i.public_link_id)},(0,a.toDisplayString)(w.formatUrl(i.public_link_id)),9,k)]),(0,s.Lk)("td",p,[(0,s.Lk)("input",{class:"form-check-input",type:"checkbox",checked:i.public_link_is_active,"data-public-link-id":i.public_link_id,disabled:e.userLevel<=1,onChange:t[0]||(t[0]=(...e)=>w.updateIsActive&&w.updateIsActive(...e))},null,40,b)]),e.userLevel>1?((0,s.uX)(),(0,s.CE)("td",g,[(0,s.Lk)("span",L,[(0,s.bF)(f,{onClick:e=>w.confirmDeletePublicLink(i.public_link_id)},null,8,["onClick"])])])):(0,s.Q3)("v-if",!0)])))),128))])])),!1===i.isReadOnly&&e.userLevel>1?((0,s.uX)(),(0,s.CE)("div",y,[(0,s.Lk)("div",v,[(0,s.Lk)("button",{class:"btn btn-primary save-changes",onClick:t[1]||(t[1]=(...e)=>w.createPublicLink&&w.createPublicLink(...e))}," Create Public Link ")])])):(0,s.Q3)("v-if",!0)],64)}]])},9581:(e,t,i)=>{i.d(t,{p:()=>n});var s=i(953),a=i(7413);function n(e){return"dark"===(0,s.BA)(e)?a.a:null}}}]);