"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[6818],{6818:(e,t,o)=>{o.d(t,{Z:()=>K});var a=o(6252),r=o(3577),l=o(9963);const i={key:0,class:"error"},s=(0,a._)("br",null,null,-1),d=["id","data-property","data-id","data-title"],n=["id","data-id","data-property","data-title"],p=["onClick"],m=(0,a._)("hr",null,null,-1),c=["id"],y={class:"modal-dialog"},h={class:"modal-content"},u={class:"modal-header"},I={class:"modal-title",id:"exampleModalLabel"},b=["id"],g={class:"modal-body"},w={class:"form-group"},_={key:0,class:"form-group"},v={class:"modal-footer"},P=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),k=["id"],L={class:"modal-dialog"},N={class:"modal-content"},M={class:"modal-header"},f={class:"modal-title"},C=["id"],D={class:"modal-body"},Z={class:"row"},$=(0,a._)("label",null,[(0,a._)("strong",null,"Destination for Cards")],-1),E=(0,a._)("br",null,null,-1),S=(0,a._)("div",{class:"alert alert-warning"},[(0,a._)("h4",null,"WARNING"),(0,a._)("p",null," This process can not be reversed. Deleting a {propertyName} will remove it. "),(0,a._)("p",null," All existing cards will be moved to the stated location you have provided. Any cards that have been archived or deleted, will still be associated with the removed card. ")],-1),B={class:"modal-footer"},A=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),x=["disabled"];var U=o(9669),T=o.n(U),O=o(3138),q=o(6542),R=o(1317),W=o(9980),F=o.n(W),V=o(989),G=o(5705),H=o(760),j=o(5808),z=o(3058);const J={name:"KanbanPropertyOrder",setup:()=>({v$:(0,G.ZP)()}),components:{draggable:F(),Icon:q.JO,NSelect:R.Z},props:{isDirty:{type:Boolean,default:!0},isNewMode:{type:Boolean,default:!0},kanbanBoardId:{type:Number,default:0},propertyList:{type:Array,default:()=>[]},propertyName:{type:String,default:""},source:{type:String,default:""}},data(){return{columnPropertyModel:"Normal",columnPropertyOptions:[{label:"Normal",value:"Normal"},{label:"Blocked",value:"Blocked"},{label:"Closed",value:"Closed"}],deleteItemId:"",destinationItemId:"",localPropertyList:this.propertyList,newCardDestinationList:[],newPropertyItem:"",singleItemId:""}},mixins:[z.Z,j.Z],validations:{localPropertyList:{required:H.C1}},watch:{propertyList(){this.localPropertyList=this.propertyList}},computed:{...(0,V.Se)({rootUrl:"getRootUrl"})},methods:{addItem(){""!=this.newPropertyItem&&(this.isNewMode?this.newModeAddItem():this.editModeAddItem(),this.sendPropertyListUp(),document.getElementById(`addItemClose${this.propertyName}`).click())},deleteItem(){const e=new FormData;e.set("delete_item_id",this.deleteItemId),e.set("destination_item_id",this.destinationItemId);const t=`${this.rootUrl}kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/delete/`;T().post(t,e).then((e=>{this.localPropertyList=this.localPropertyList.filter((e=>e.id!=this.deleteItemId)),this.$emit("update_property_list",{source:this.source,data:this.localPropertyList}),document.getElementById(`deleteItemClose${this.propertyName}`).click()})).catch((e=>{this.showErrorModal(e,"kanban item delete",this.kanbanBoardId)}))},editItem(e){this.newPropertyItem=e.target.dataset.title,this.singleItemId=e.target.dataset.id,this.columnPropertyModel=e.target.dataset.property,this.openModal()},editModeAddItem:async function(){const e=`kanban_${this.propertyName.toLowerCase()}_name`,t=`kanban_${this.propertyName.toLowerCase()}_sort_number`,o=this.singleItemId,a=new FormData;if(a.set(e,this.newPropertyItem),a.set(t,this.getMaxId()+1),"Column"===this.propertyName&&a.set("kanban_column_property",this.columnPropertyModel),""==o)var r=`/kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/new/`;else r=`/kanban_${this.propertyName.toLowerCase()}/${this.singleItemId}/edit/`;await T().post(r,a).then((t=>{const a=t.data[0];""==o?this.localPropertyList.push({id:a.pk,property:a.fields.kanban_column_property,title:a.fields[e]}):this.localPropertyList.forEach((e=>{e.id==this.singleItemId&&(e.title=this.newPropertyItem,e.property=this.columnPropertyModel)})),this.singleItemId="",this.newPropertyItem=""})).catch((e=>{this.showErrorModal(e,"kanban board",this.kanbanBoardId)}))},getMaxId(){const e=this.localPropertyList.map((e=>e.id));return e.sort(((e,t)=>e-t))[e.length-1]},newModeAddItem(){""==this.singleItemId?this.localPropertyList.push({id:this.getMaxId()+1,property:this.columnPropertyModel,title:this.newPropertyItem}):this.localPropertyList.forEach((e=>{e.id==this.singleItemId&&(e.title=this.newPropertyItem,e.property=this.columnPropertyModel)})),this.singleItemId="",this.newPropertyItem=""},openModal(){new O.u_(document.getElementById(`addItem${this.propertyName}`)).show()},removeItem(e){this.isNewMode?(this.localPropertyList=this.localPropertyList.filter((t=>t.id!=e)),this.sendPropertyListUp()):(this.deleteItemId=e,this.newCardDestinationList=this.localPropertyList.filter((e=>e.id!=this.deleteItemId)).map((e=>({value:e.id,label:e.title}))),this.destinationItemId=this.newCardDestinationList[0].value,new O.u_(document.getElementById(`deleteItem${this.propertyName}`)).show())},sendPropertyListUp(){if(this.$emit("update_property_list",{source:this.source,data:this.localPropertyList}),!this.isNewMode){const e=`/kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/resort/`,t=new FormData;this.localPropertyList.forEach(((e,o)=>{t.append("item",e.id)})),T().post(e,t).then((e=>{})).catch((e=>{}))}}}},K=(0,o(3744).Z)(J,[["render",function(e,t,o,U,T,O){const q=(0,a.up)("Icon"),R=(0,a.up)("draggable"),W=(0,a.up)("n-select");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("strong",null,(0,r.toDisplayString)(o.propertyName),1),!U.v$.localPropertyList.required&&o.isDirty?((0,a.wg)(),(0,a.iD)("span",i," Please create at least one "+(0,r.toDisplayString)(o.propertyName)+".",1)):(0,a.kq)("v-if",!0),s,(0,a.kq)(" The column of data where you can sort the properties "),(0,a.Wm)(R,{modelValue:T.localPropertyList,"onUpdate:modelValue":t[1]||(t[1]=e=>T.localPropertyList=e),"item-key":"pk","ghost-class":"ghost",onChange:O.sendPropertyListUp},{item:(0,a.w5)((({element:o})=>[((0,a.wg)(),(0,a.iD)("div",{class:"sortable",key:o.id,id:o.id,"data-property":o.property,"data-id":o.id,"data-title":o.title,onDblclick:t[0]||(t[0]=e=>O.editItem(e))},[((0,a.wg)(),(0,a.iD)("strong",{key:o.id,id:o.id,"data-id":o.id,"data-property":o.property,"data-title":o.title},(0,r.toDisplayString)(o.title),9,n)),T.localPropertyList.length>1?((0,a.wg)(),(0,a.iD)("span",{key:0,onClick:e=>O.removeItem(o.id)},[(0,a.Wm)(q,{icon:e.icons.xCircle},null,8,["icon"])],8,p)):(0,a.kq)("v-if",!0)],40,d))])),_:1},8,["modelValue","onChange"]),(0,a.kq)(" ADD BUTTON "),m,(0,a._)("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...e)=>O.openModal&&O.openModal(...e))}," Add "+(0,r.toDisplayString)(o.propertyName)+" Item ",1),(0,a.kq)(" MODAL FOR ADDING AN EXTRA ROW "),(0,a._)("div",{class:"modal fade",id:`addItem${o.propertyName}`,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,a._)("div",y,[(0,a._)("div",h,[(0,a._)("div",u,[(0,a._)("h5",I," Add/Edit "+(0,r.toDisplayString)(o.propertyName),1),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:`addItemClose${o.propertyName}`},null,8,b)]),(0,a._)("div",g,[(0,a._)("div",w,[(0,a._)("label",null,(0,r.toDisplayString)(o.propertyName)+" Item Description",1),(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>T.newPropertyItem=e),type:"text",class:"form-control"},null,512),[[l.vModelText,T.newPropertyItem]])]),"column"===o.propertyName.toLowerCase()?((0,a.wg)(),(0,a.iD)("div",_,[(0,a._)("label",null,(0,r.toDisplayString)(o.propertyName)+" Property",1),(0,a.Wm)(W,{value:T.columnPropertyModel,"onUpdate:value":t[4]||(t[4]=e=>T.columnPropertyModel=e),options:T.columnPropertyOptions},null,8,["value","options"])])):(0,a.kq)("v-if",!0)]),(0,a._)("div",v,[P,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>O.addItem&&O.addItem(...e))}," Save changes ")])])])],8,c),(0,a.kq)(" MODAL FOR DELETING ITEM "),(0,a._)("div",{class:"modal fade",id:`deleteItem${o.propertyName}`,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,a._)("div",L,[(0,a._)("div",N,[(0,a._)("div",M,[(0,a._)("h5",f,"Delete "+(0,r.toDisplayString)(o.propertyName),1),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:`deleteItemClose${o.propertyName}`},null,8,C)]),(0,a._)("div",D,[(0,a.kq)(" CARD DESTINATIONS "),(0,a._)("div",Z,[$,(0,a.Wm)(W,{options:T.newCardDestinationList,value:T.destinationItemId,"onUpdate:value":t[6]||(t[6]=e=>T.destinationItemId=e),style:{"z-index":"9999"},class:"new-card-destination"},null,8,["options","value"])]),E,(0,a.kq)(" WARNING "),S]),(0,a._)("div",B,[A,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[7]||(t[7]=(...e)=>O.deleteItem&&O.deleteItem(...e)),disabled:null==this.destinationItemId}," Delete "+(0,r.toDisplayString)(o.propertyName),9,x)])])])],8,k)])}]])},3058:(e,t,o)=>{o.d(t,{Z:()=>r});var a=o(3138);const r={methods:{showErrorModal(e,t,o){new a.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${t}-${o}<hr>${e}`,new a.u_(document.getElementById("errorModal")).show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new a.u_(document.getElementById("errorModal")).show()}}}},5808:(e,t,o)=>{o.d(t,{Z:()=>C});var a=o(3985),r=o(5555),l=o(1826),i=o(6443),s=o(1327),d=o(8521),n=o(1056),p=o(4324),m=o(9672),c=o(9867),y=o(1239),h=o(5004),u=o(1321),I=o(1216),b=o(5550),g=o(7702),w=o(7903),_=o(2606),v=o(3843),P=o(2393),k=o(3360),L=o(9714),N=o(1323),M=o(2610),f=o(5968);const C={data:()=>({icons:{arrowUp:a.Z,bugIcon:r.Z,bxBriefcase:l.Z,cardChecklist:i.Z,clipboardIcon:s.Z,documentPdf:d.Z,documentText:n.Z,folderIcon:p.Z,groupPresentation:m.Z,imageIcon:c.Z,infoCircle:y.Z,linkIcon:h.Z,linkIcon2:u.Z,linkOut:I.Z,mailIcon:b.Z,microsoftExcel:g.Z,microsoftPowerpoint:w.Z,microsoftWord:_.Z,noteAdd:v.Z,objectStorage:P.Z,passwordIcon:k.Z,trashCan:L.Z,userIcon:N.Z,usersIcon:M.Z,xCircle:f.Z}})}}}]);