"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[8902],{2233:(t,e,a)=>{a.d(e,{A:()=>d});var s=a(1601),n=a.n(s),r=a(6314),i=a.n(r)()(n());i.push([t.id,"\n.transparent-rectangle {\n\tfill: none;\n}\n",""]);const d=i},2599:(t,e,a)=>{a.r(e),a.d(e,{default:()=>lt});var s=a(641),n=a(33);const r={key:0,class:"alert alert-warning"},i={key:1,class:"alert alert-warning"};var d=a(2124),o=a(6285);const l={class:"modal fade",id:"confirmObjectRemoveModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmObjectRemove","aria-hidden":"true"},c={class:"modal-dialog"},h={class:"modal-content"},u={class:"modal-footer"},m={name:"ConfirmObjectRemove",props:{},computed:{...(0,d.L8)({destination:"getDestination",locationId:"getLocationId",objectId:"getConfirmDeleteObjectId",objectType:"getConfirmDeleteObjectType",parentObjectId:"getConfirmDeleteParentObjectId",parentObjectType:"getConfirmDeleteParentObjectType",rootUrl:"getRootUrl"})},methods:{closeModal(){document.getElementById("confirmObjectRemoveButton").click()},removeObject(){this.$store.dispatch("newToast",{header:"Removing Object from Sprint",message:"Please wait whilst we remove the object",extra_classes:"bg-warning text-dark",delay:0,unique_type:"remove_object"}),this.$store.getters.getGanttChartDataByObject(this.objectId,this.objectType).length>1?this.removeObjectAssociation():this.removeObjectFromSprint()},removeObjectAssociation(){const t=new FormData;t.set("link_id",this.objectId),t.set("link_connection",this.objectType),this.axios.post(`${this.rootUrl}object_data/${this.parentObjectType}/${this.parentObjectId}/remove_link/`,t).then((()=>{this.$store.dispatch("removeGanttChartSingleRow",{objectType:this.objectType,objectId:this.objectId,parentObjectId:this.parentObjectId,parentObjectType:this.parentObjectType}),this.$store.dispatch("newToast",{header:"Removing Object from Sprint",message:"Object has been removed",extra_classes:"bg-success text-dark",unique_type:"remove_object"})})).catch((t=>{this.$store.dispatch("newToast",{header:"Failed Updating Sprint",message:`Sorry, moving the object failed. Error -> ${t}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},removeObjectFromSprint(){const t=new FormData;t.set(this.objectType,this.objectId),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_object_from_sprint/`,t).then((()=>{this.$store.dispatch("removeGanttChartSingleRow",{objectType:this.objectType,objectId:this.objectId,parentObjectId:this.parentObjectId,parentObjectType:this.parentObjectType}),this.$store.dispatch("newToast",{header:"Removing Object from Sprint",message:"Object has been removed",extra_classes:"bg-success text-dark",unique_type:"remove_object"})})).catch((t=>{this.$store.dispatch("newToast",{header:"Failed to remove object",message:`Failed to remove the object from the sprint. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"remove_object"})})),this.closeModal()}}};var p=a(6262);const b=(0,p.A)(m,[["render",function(t,e,a,n,r,i){return(0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",c,[(0,s.Lk)("div",h,[e[2]||(e[2]=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"confirmObjectRemove"}," Please confirm object removal. "),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmObjectRemoveButton"})],-1)),e[3]||(e[3]=(0,s.Lk)("div",{class:"modal-body"}," Please confirm you would like to remove this object from the sprint. ",-1)),(0,s.Lk)("div",u,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>i.closeModal&&i.closeModal(...t))}," No "),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>i.removeObject&&i.removeObject(...t))}," Yes ")])])])])}]]),g={class:"gantt-header"},y={class:"gantt-header--dates"},j={class:"dayDate"},D={class:"dayText"},v={name:"RenderGanttDaysHeader",props:{},data:()=>({dateDictionary:{0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat"}}),computed:{...(0,d.L8)({deltaDays:"getDeltaDays",endDateGantt:"getEndDateGantt",startDateGantt:"getStartDateGantt"})},methods:{getDayDate(t){const e=24*t*60*60*1e3,a=new Date(this.startDateGantt+e);return this.dateDictionary[a.getDay()]},getDayText(t){const e=24*t*60*60*1e3;return new Date(this.startDateGantt+e).getDate()}}},I=(0,p.A)(v,[["render",function(t,e,a,r,i,d){return(0,s.uX)(),(0,s.CE)("div",g,[e[0]||(e[0]=(0,s.Fv)('<div class="gantt-header--information"><div class="gantt-header--title">Object Title</div><div class="gantt-header--start-date">Start Date</div><div class="gantt-header--end-date">End Date</div><div class="gantt-header--status">Status</div></div>',1)),(0,s.Lk)("div",y,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.deltaDays+1,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"gantt-header--date"},[(0,s.Lk)("div",j,(0,n.toDisplayString)(d.getDayDate(t-1)),1),(0,s.Lk)("div",D,(0,n.toDisplayString)(d.getDayText(t-1)),1)])))),128))])])}]]),_={class:"gantt-header"},w={class:"gantt-header--months"},O={name:"RenderGanttMonthlyHeader",props:{},data:()=>({monthArray:[],monthDictionary:{0:"Jan",1:"Feb",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}}),computed:{...(0,d.L8)({deltaDays:"getDeltaDays",endDateGantt:"getEndDateGantt",startDateGantt:"getStartDateGantt"})},watch:{deltaDays(){this.generateHeader()}},methods:{generateHeader(){this.monthArray=[];const t=new Date(this.startDateGantt),e=new Date(this.endDateGantt);let a=t,s=e,n=!0,r=0;for(;n;){let t=0;a.getMonth()===e.getMonth()?(n=!1,t=Math.round((e.getTime()-a.getTime())/864e5)+1):(s=11===a.getMonth()?new Date(a.getFullYear()+1,0,1):new Date(a.getFullYear(),a.getMonth()+1,1),t=Math.round((s.getTime()-a.getTime())/864e5)),this.monthArray.push({index:r,delta:t,width:48*t,month:this.monthDictionary[a.getMonth()],year:a.getFullYear()}),r+=1,a=s}}}},S=(0,p.A)(O,[["render",function(t,e,a,r,i,d){return(0,s.uX)(),(0,s.CE)("div",_,[e[0]||(e[0]=(0,s.Lk)("div",{class:"gantt-header--information"},null,-1)),(0,s.Lk)("div",w,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(this.monthArray,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t.index,class:"gantt-header--month",style:(0,n.normalizeStyle)(`width: ${t.width}px`)},[(0,s.Lk)("span",null,(0,n.toDisplayString)(t.month)+" "+(0,n.toDisplayString)(t.year),1)],4)))),128))])])}]]),f={class:"gantt-row",id:"gantt_row_parent"},T={name:"RenderBlankGanttRow",emits:["mouse_down"],data(){return{datePickerFormat:"yyyy-MM-dd HH:mm",localEndDate:this.endDate,localStartDate:this.startDate,localStatusId:this.statusId,statusList:[]}},computed:{...(0,d.L8)({rootUrl:"getRootUrl",mdObjectId:"getMdObjectId",mdObjectType:"getMdObjectType",mdParentObjectId:"getMdParentObjectId",mdParentObjectType:"getMdParentObjectType",mdColumn:"getMdColumn"})},methods:{canBeDestination(){return![null,"",void 0].includes(this.mdParentObjectType)},canObjectMove(){return this.$store.getters.getGanttChartDataByObject(this.mdObjectId,this.mdObjectType).length<=1},dragleaveRow(t){t.preventDefault(),document.getElementById("gantt_row_parent").classList.remove("gantt-chart-row-destination")},dragoverRow(t){t.preventDefault(),!1!==this.canBeDestination()&&document.getElementById("gantt_row_parent").classList.add("gantt-chart-row-destination")},drop(t){if(t.preventDefault(),document.getElementById("gantt_row_parent").classList.remove("gantt-chart-row-destination"),!1===this.canBeDestination())return;if(!this.canObjectMove())return void this.$store.dispatch("newToast",{heading:"Can not move object",message:"Sorry object can't be moved, as it isn't the only instance of that object. An object can only exist at root level if it is the only instance",extra_classes:"bg-danger",delay:0});this.$store.dispatch("updateGanttChartSingleRowsParent",{object_id:this.mdObjectId,object_type:this.mdObjectType,parent_object_id:this.mdParentObjectId,parent_object_type:this.mdParentObjectType,new_parent_object_id:0,new_parent_object_type:""});const e=new FormData;e.set("link_id",this.mdObjectId),e.set("link_connection",this.mdObjectType),this.axios.post(`${this.rootUrl}object_data/${this.mdParentObjectType}/${this.mdParentObjectId}/remove_link/`,e).catch((t=>{this.$store.dispatch("newToast",{header:"Failed Updating Sprint",message:`Sorry, moving the object failed. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}}},E=(0,p.A)(T,[["render",function(t,e,a,n,r,i){return(0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("div",{class:"gantt-row--information",onDragleave:e[0]||(e[0]=(...t)=>i.dragleaveRow&&i.dragleaveRow(...t)),onDragover:e[1]||(e[1]=(...t)=>i.dragoverRow&&i.dragoverRow(...t)),onDrop:e[2]||(e[2]=(...t)=>i.drop&&i.drop(...t))},e[3]||(e[3]=[(0,s.Lk)("div",{class:"gantt-row--title"},null,-1),(0,s.Lk)("div",{class:"gantt-row--start-date"},null,-1),(0,s.Lk)("div",{class:"gantt-row--end-date"},null,-1),(0,s.Lk)("div",{class:"gantt-row--status"},null,-1)]),32),e[4]||(e[4]=(0,s.Lk)("div",{class:"gantt-row--render"},null,-1))])}]]);var C=a(9581);const k=["id"],M={style:{"margin-right":"10px"}},L={href:"javascript:void(0)"},$=["data-bs-title"],G=["href"],R={class:"gantt-row--start-date"},x={class:"gantt-row--end-date"},P={class:"gantt-row--status"},F={class:"gantt-row--render"};var A=a(3980),N=a(3728),U=a(1080),X=a(9336);const B={class:"icon"},H=["width","height"],W={name:"CarbonDragVertical",props:{height:{type:String,default:"20px"},width:{type:String,default:"20px"}}};var z=a(5072),Q=a.n(z),K=a(7825),q=a.n(K),V=a(7659),Y=a.n(V),J=a(5056),Z=a.n(J),tt=a(540),et=a.n(tt),at=a(1113),st=a.n(at),nt=a(2233),rt={};rt.styleTagTransform=st(),rt.setAttributes=Z(),rt.insert=Y().bind(null,"head"),rt.domAPI=q(),rt.insertStyleElement=et(),Q()(nt.A,rt),nt.A&&nt.A.locals&&nt.A.locals;const it={name:"RenderGanttRow",emits:["mouse_down"],props:{description:{type:String,default:""},endDate:{type:Number,default:0},higherOrderStatus:{type:String,default:""},isClosed:{type:Boolean,default:!1},levelNumber:{type:Number,default:0},objectId:{type:Number,default:0},objectType:{type:String,default:""},parentObjectId:{type:Number,default:0},parentObjectType:{type:String,default:""},startDate:{type:Number,default:0},statusId:{type:Number,default:0},title:{type:String,default:""}},components:{CarbonDragVertical:(0,p.A)(W,[["render",function(t,e,a,n,r,i){return(0,s.uX)(),(0,s.CE)("span",B,[((0,s.uX)(),(0,s.CE)("svg",{xmlns:"http://www.w3.org/2000/svg",width:a.width,height:a.height,viewBox:"0 0 32 32"},e[0]||(e[0]=[(0,s.Lk)("polygon",{fill:"currentColor",points:"4 20 15 20 15 26.17 12.41 23.59 11 25 16 30 21 25 19.59 23.59 17 26.17 17 20 28 20 28 18 4 18 4 20"},null,-1),(0,s.Lk)("polygon",{fill:"currentColor",points:"11 7 12.41 8.41 15 5.83 15 12 4 12 4 14 28 14 28 12 17 12 17 5.83 19.59 8.41 21 7 16 2 11 7"},null,-1),(0,s.Lk)("rect",{id:"_Transparent_Rectangle_","data-name":"<Transparent Rectangle>",class:"transparent-rectangle",width:"32",height:"32"},null,-1)]),8,H))])}]]),CarbonInformation:A.G5,CarbonTrashCan:A.dA,NDatePicker:N.A,NSelect:U.A},data(){return{datePickerFormat:"yyyy-MM-dd HH:mm",localEndDate:this.endDate,localStartDate:this.startDate,localStatusId:this.statusId,statusList:[],titleKeyValuePair:{project:"Pro",requirement_item:"Item",task:"Task"}}},watch:{endDate(t){this.localEndDate=t},startDate(t){this.localStartDate=t},statusId(t){this.localStatusId=t}},computed:{...(0,d.L8)({endDateGantt:"getEndDateGantt",rootUrl:"getRootUrl",startDateGantt:"getStartDateGantt",userLevel:"getUserLevel",mdObjectId:"getMdObjectId",mdObjectType:"getMdObjectType",mdParentObjectId:"getMdParentObjectId",mdParentObjectType:"getMdParentObjectType",mdColumn:"getMdColumn"}),barWidth(){let t=this.localStartDate,e=this.localEndDate;t<this.startDateGantt&&(t=this.startDateGantt);const a=o.c9.fromMillis(this.endDateGantt).set({hour:23,minute:59,second:59,millisecond:999});return e>a.ts&&(e=a.ts),2*Math.ceil((e-t)/36e5)},renderBar(){const t=this.localEndDate>this.startDateGantt,e=this.localStartDate<this.endDateGantt;return t&&e},spacerWidth(){return this.localStartDate<=this.startDateGantt?0:2*Math.floor((this.localStartDate-this.startDateGantt)/36e5)}},methods:{canBeDestination(){return"na_vertical_move"===this.mdColumn&&"task"!==this.objectType&&this.objectType!==this.mdObjectType&&(this.mdParentObjectType!==this.objectType||parseInt(this.mdParentObjectId)!==parseInt(this.objectId))},canObjectMove(){return 0===this.$store.getters.getGanttChartDataByObject(this.mdObjectId,this.mdObjectType).filter((t=>{const e=parseInt(t.parent_object_id)===parseInt(this.objectId),a=t.parent_object_type===this.objectType;return e&&a})).length},confirmRemoval(){this.$store.commit({type:"updateConfirmDelete",objectType:this.objectType,objectId:this.objectId,parentObjectId:this.parentObjectId,parentObjectType:this.parentObjectType}),new X.aF(document.getElementById("confirmObjectRemoveModal")).show()},dragleaveRow(t){t.preventDefault(),document.getElementById(this.getGanttRowId()).classList.remove("gantt-chart-row-destination")},dragoverRow(t){t.preventDefault(),!1!==this.canBeDestination()&&document.getElementById(this.getGanttRowId()).classList.add("gantt-chart-row-destination")},drop(t){if(t.preventDefault(),document.getElementById(this.getGanttRowId()).classList.remove("gantt-chart-row-destination"),!1===this.canBeDestination())return;if(!this.canObjectMove())return void this.$store.dispatch("newToast",{heading:"Can not move object",message:"Sorry object can't be moved, as there already exists an instance of this object within this location",extra_classes:"bg-danger",delay:0});this.$store.dispatch("updateGanttChartSingleRowsParent",{object_id:this.mdObjectId,object_type:this.mdObjectType,parent_object_id:this.mdParentObjectId,parent_object_type:this.mdParentObjectType,new_parent_object_id:this.objectId,new_parent_object_type:this.objectType});const e=new FormData;e.set(this.mdObjectType,this.mdObjectId),e.set("object_relation","parent_object_of");const a=new FormData;a.set("link_id",this.mdObjectId),a.set("link_connection",this.mdObjectType),this.axios.post(`${this.rootUrl}object_data/${this.objectType}/${this.objectId}/add_link/`,e).catch((t=>{this.$store.dispatch("newToast",{header:"Failed Updating Sprint",message:`Sorry, moving the object failed. Error -> ${t}`,extra_classes:"bg-danger",delay:0})})),0!==this.mdParentObjectId&&this.axios.post(`${this.rootUrl}object_data/${this.mdParentObjectType}/${this.mdParentObjectId}/remove_link/`,a).catch((t=>{this.$store.dispatch("newToast",{header:"Failed Updating Sprint",message:`Sorry, moving the object failed. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))},getGanttRowId(){return 0===this.parentObjectId||void 0===this.parentObjectId?`gantt_row_${this.objectType}_${this.objectId}`:`gantt_row_${this.objectType}_${this.objectId}_${this.parentObjectType}_${this.parentObjectId}`},getObjectUrl(){return`${this.rootUrl}${this.objectType}_information/${this.objectId}`},getStatusList(){this.statusList=this.$store.getters.getGanttStatusList(this.objectType)},handleVerticalMove(t){this.$store.commit("updateMouseDown",{isMouseDown:!0,mdObjectId:this.objectId,mdObjectType:this.objectType,mdParentObjectId:this.parentObjectId,mdParentObjectType:this.parentObjectType,mdColumn:"na_vertical_move"})},modifiedEndDate(){this.localEndDate<this.localStartDate&&(this.localStartDate=this.localEndDate-864e5),this.updateGanttData()},modifiedStartDate(){this.localStartDate>this.localEndDate&&(this.localEndDate=this.localStartDate+864e5),this.updateGanttData()},mouseDown(t){this.userLevel<=1||this.$store.commit("updateMouseDown",{isMouseDown:!0,mdClientXInitial:t.clientX,mdHigherOrderStatus:this.higherOrderStatus,mdObjectId:this.objectId,mdObjectType:this.objectType,mdParentObjectId:this.parentObjectId,mdParentObjectType:this.parentObjectType,mdColumn:t.target.dataset.column,mdEndDateInitial:this.endDate,mdStartDateInitial:this.startDate,mdStatus:this.status,mdStatusId:this.statusId,mdTitle:this.title})},updateGanttData(){this.$store.dispatch("updateGanttChartSingleRow",{end_date:this.localEndDate,higher_order_status:this.higherOrderStatus,object_id:this.objectId,object_type:this.objectType,start_date:this.localStartDate,status_id:this.localStatusId}),this.$nextTick((()=>{const t=new FormData;t.set("status_id",this.localStatusId);const e=new Date(this.localEndDate),a=new Date(this.localStartDate);t.set("end_date",e.toISOString()),t.set("start_date",a.toISOString()),this.axios.post(`${this.rootUrl}gantt_data/${this.objectType}/${this.objectId}/update_data/`,t).catch((t=>{this.$store.dispatch("newToast",{header:"Error Updating the Object",message:`Sorry, we could not update the object's information. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}))},updateStatus(t){this.localStatusId=t,this.updateGanttData()}},mounted(){this.getStatusList(),setTimeout((()=>{[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((t=>new X.m_(t)))}),500)}},dt={name:"RenderGanttGroup",components:{RenderGanttRow:(0,p.A)(it,[["render",function(t,e,a,r,i,d){const o=(0,s.g2)("carbon-trash-can"),l=(0,s.g2)("carbon-drag-vertical"),c=(0,s.g2)("carbon-information"),h=(0,s.g2)("n-date-picker"),u=(0,s.g2)("n-select");return(0,s.uX)(),(0,s.CE)("div",{class:"gantt-row",id:d.getGanttRowId()},[(0,s.Lk)("div",{class:"gantt-row--information",onDragleave:e[5]||(e[5]=(...t)=>d.dragleaveRow&&d.dragleaveRow(...t)),onDragover:e[6]||(e[6]=(...t)=>d.dragoverRow&&d.dragoverRow(...t)),onDrop:e[7]||(e[7]=(...t)=>d.drop&&d.drop(...t))},[(0,s.Lk)("div",{class:"gantt-row--title",style:(0,n.normalizeStyle)(`padding-left:${32*a.levelNumber}px`)},[(0,s.Lk)("span",M,[(0,s.bF)(o,{onClick:e[0]||(e[0]=t=>d.confirmRemoval())})]),"requirement_item"!==a.objectType?((0,s.uX)(),(0,s.CE)("span",{key:0,style:{"margin-right":"10px"},onMousedown:e[1]||(e[1]=(...t)=>d.handleVerticalMove&&d.handleVerticalMove(...t))},[(0,s.Lk)("a",L,[(0,s.bF)(l)])],32)):(0,s.Q3)("v-if",!0),(0,s.Lk)("span",{style:{"margin-right":"10px"},"data-bs-title":a.description,"data-bs-toggle":"tooltip","data-bs-html":"true","data-bs-custom-class":"tooltip-description","data-bs-delay":"200"},[(0,s.Lk)("a",{target:"_blank",href:d.getObjectUrl()},[(0,s.bF)(c)],8,G)],8,$),(0,s.eW)(" "+(0,n.toDisplayString)(i.titleKeyValuePair[a.objectType])+(0,n.toDisplayString)(a.objectId)+" - "+(0,n.toDisplayString)(a.title),1)],4),(0,s.Lk)("div",R,["requirement_item"!==a.objectType?((0,s.uX)(),(0,s.Wv)(h,{key:0,value:i.localStartDate,"onUpdate:value":[e[2]||(e[2]=t=>i.localStartDate=t),d.modifiedStartDate],disabled:t.userLevel<=1||a.isClosed,format:i.datePickerFormat,size:"small",type:"datetime"},null,8,["value","onUpdate:value","disabled","format"])):(0,s.Q3)("v-if",!0)]),(0,s.Lk)("div",x,["requirement_item"!==a.objectType?((0,s.uX)(),(0,s.Wv)(h,{key:0,value:i.localEndDate,"onUpdate:value":[e[3]||(e[3]=t=>i.localEndDate=t),d.modifiedEndDate],disabled:t.userLevel<=1||a.isClosed,format:i.datePickerFormat,size:"small",type:"datetime"},null,8,["value","onUpdate:value","disabled","format"])):(0,s.Q3)("v-if",!0)]),(0,s.Lk)("div",P,[(0,s.bF)(u,{value:i.localStatusId,"onUpdate:value":e[4]||(e[4]=t=>i.localStatusId=t),options:i.statusList,"on-update-value":d.updateStatus,disabled:t.userLevel<=1||a.isClosed,size:"small"},null,8,["value","options","on-update-value","disabled"])])],32),(0,s.Lk)("div",F,[d.renderBar?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.normalizeClass)(`gantt-row--render-bar gantt-row--level-${a.levelNumber}`)},[(0,s.Lk)("div",{class:"gantt-row--spacer",style:(0,n.normalizeStyle)(`width: ${d.spacerWidth}px`)},null,4),(0,s.Lk)("div",{class:"gantt-row--bar",style:(0,n.normalizeStyle)(`width: ${d.barWidth}px`)},[(0,s.Lk)("div",{class:"gantt-row--bar-start","data-column":"start",onMousedown:e[8]||(e[8]=(...t)=>d.mouseDown&&d.mouseDown(...t))},null,32),(0,s.Lk)("div",{class:"gantt-row--bar-middle","data-column":"middle",onMousedown:e[9]||(e[9]=(...t)=>d.mouseDown&&d.mouseDown(...t))},null,32),(0,s.Lk)("div",{class:"gantt-row--bar-end","data-column":"end",onMousedown:e[10]||(e[10]=(...t)=>d.mouseDown&&d.mouseDown(...t))},null,32)],4)],2)):(0,s.Q3)("v-if",!0)])],8,k)}]])},props:{description:{type:String,default:""},endDate:{type:Number,default:0},higherOrderStatus:{type:String,default:""},isClosed:{type:Boolean,default:!1},levelNumber:{type:Number,default:0},objectId:{type:Number,default:0},objectType:{type:String,default:""},parentObjectId:{type:Number,default:0},parentObjectType:{type:String,default:""},startDate:{type:Number,default:0},statusId:{type:Number,default:0},title:{type:String,default:""}},computed:{...(0,d.L8)({ganttChartData:"getGanttChartData"}),filteredGanttChartData(){return this.ganttChartData(this.objectType,this.objectId)}},methods:{}},ot={name:"GanttChart",components:{RenderGanttGroup:(0,p.A)(dt,[["render",function(t,e,a,n,r,i){const d=(0,s.g2)("render-gantt-row"),o=(0,s.g2)("render-gantt-group",!0);return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Q3)("\tRENDER THE ONE ELEMENT WE WANT"),(0,s.bF)(d,{description:a.description,"end-date":a.endDate,"is-closed":a.isClosed,"level-number":a.levelNumber,"object-id":a.objectId,"object-type":a.objectType,"parent-object-id":a.parentObjectId,"parent-object-type":a.parentObjectType,"higher-order-status":a.higherOrderStatus,"start-date":a.startDate,"status-id":a.statusId,title:a.title},null,8,["description","end-date","is-closed","level-number","object-id","object-type","parent-object-id","parent-object-type","higher-order-status","start-date","status-id","title"]),(0,s.Q3)("\tRENDER ALL THE CHILD ELEMENTS WE WANT"),(0,s.Q3)('\tTODO: FIX THE "IS-CLOSED", as we have just put false'),a.levelNumber<=3?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(i.filteredGanttChartData,((t,e)=>((0,s.uX)(),(0,s.Wv)(o,{key:e,description:t.description,"end-date":t.end_date,"is-closed":!1,"level-number":a.levelNumber+1,"object-id":t.object_id,"object-type":t.object_type,"parent-object-id":t.parent_object_id,"parent-object-type":t.parent_object_type,"higher-order-status":t.higher_order_status,"start-date":t.start_date,"status-id":t.status_id,title:t.title},null,8,["description","end-date","level-number","object-id","object-type","parent-object-id","parent-object-type","higher-order-status","start-date","status-id","title"])))),128)):(0,s.Q3)("v-if",!0)],64)}]]),ConfirmObjectRemove:b,RenderBlankGanttRow:E,RenderGanttDaysHeader:I,RenderGanttMonthlyHeader:S},props:{destination:{type:String,default:""},ganttEndDate:{type:String,default:""},ganttStartDate:{type:String,default:""},locationId:{type:Number,default:0},parentStatus:{type:String,default:""},rootUrl:{type:String,default:"/"},theme:{type:String,default:"light"}},data:()=>({endDateIssues:[],ganttStyle:"",startDateIssues:[]}),watch:{deltaDays:{handler(){this.updateGanttStyle()}},ganttChartData:{handler(){this.checkAllObjectsAreWithinDates()},deep:!0,immediate:!1}},created(){window.addEventListener("resize",this.updateGanttStyle)},unmounted(){window.removeEventListener("resize",this.updateGanttStyle)},computed:{...(0,d.L8)({deltaDays:"getDeltaDays",ganttChartData:"getGanttChartData",isMouseDown:"getIsMouseDown",mdClientXInitial:"getMdClientXInitial",mdIndex:"getMdIndex",mdObjectId:"getMdObjectId",mdObjectType:"getMdObjectType",mdParentObjectId:"getMdParentObjectId",mdParentObjectType:"getMdParentObjectType",mdColumn:"getMdColumn",mdEndDateInitial:"getMdEndDateInitial",mdHigherOrderStatus:"getMdHigherOrderStatus",mdStartDateInitial:"getMdStartDateInitial",mdStatus:"getMdStatus",mdStatusId:"getMdStatusId",mdTitle:"getMdTitle"}),filteredGanttChartData(){return this.ganttChartData("","")}},methods:{useNBTheme:C.p,checkAllObjectsAreWithinDates(){const t=o.c9.fromISO(this.ganttEndDate),e=o.c9.fromISO(this.ganttStartDate);this.endDateIssues=this.ganttChartData.filter((e=>e.end_date>t.ts)),this.startDateIssues=this.ganttChartData.filter((t=>t.start_date<e.ts))},initialiseData(){""!==this.destination&&0!==this.locationId&&this.axios.post(`${this.rootUrl}gantt_data/${this.destination}/${this.locationId}/get_data/`).then((t=>{let e=o.c9.fromISO(this.ganttEndDate),a=o.c9.fromISO(this.ganttStartDate);e=e.set({hour:0,minute:0,second:0,millisecond:0}),a=a.set({hour:0,minute:0,second:0,millisecond:0}),this.$store.commit({type:"updateGanttStatusList",ganttStatusList:t.data.status_results}),this.$store.dispatch("initialiseGanttChartData",{ganttChartData:t.data.object_results,endDateGantt:e.ts,startDateGantt:a.ts})})).catch((t=>{this.$store.dispatch("newToast",{header:"Error fetching Gantt Data",message:`Can not retrieve gantt data. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))},isParentClosed(){return["finished","closed"].includes(this.parentStatus.toLowerCase())},mouseLeave(t){t.preventDefault(),this.$store.commit("updateMouseDown",{isMouseDown:!1}),0!==this.mdObjectId&&this.updateGanttData()},mouseMove(t){if(t.preventDefault(),this.isParentClosed())return;if(matchMedia("(hover: none)").matches)return;if(!0!==this.isMouseDown)return;const e=t.clientX,a=36e5*Math.floor((e-this.mdClientXInitial)/2);switch(this.mdColumn){case"end":this.updateEnd(a);break;case"middle":this.updateMiddle(a);break;case"start":this.updateStart(a)}},mouseUp(t){t.preventDefault(),this.$store.commit("updateMouseDown",{isMouseDown:!1}),0!==this.mdObjectId&&this.updateGanttData()},updateEnd(t){const e=new Date(this.mdEndDateInitial+t),a=o.c9.fromISO(this.ganttEndDate).set({hour:23,minute:59,second:59,millisecond:999});this.mdEndDateInitial+t>a.ts||this.mdEndDateInitial+t<=this.mdStartDateInitial||this.$store.dispatch("updateGanttChartSingleRow",{end_date:e.getTime(),higher_order_status:this.mdHigherOrderStatus,object_id:this.mdObjectId,object_type:this.mdObjectType,start_date:this.mdStartDateInitial,status_id:this.mdStatusId,title:this.mdTitle})},updateGanttData(){if(!["end","middle","start"].includes(this.mdColumn))return;const t=this.$store.getters.getGanttChartDataSingleRow(this.mdObjectId,this.mdObjectType,this.mdParentObjectId,this.mdParentObjectType);if(void 0===t)return void this.$store.dispatch("newToast",{header:"Error Updating Gantt Data",message:"We have had an issue isolating that particular record.",extra_classes:"bg-danger",delay:0});const e=new FormData;e.set("status_id",t.status_id);const a=new Date(t.end_date),s=new Date(t.start_date);e.set("end_date",a.toISOString()),e.set("start_date",s.toISOString()),this.axios.post(`${this.rootUrl}gantt_data/${t.object_type}/${t.object_id}/update_data/`,e).catch((t=>{this.$store.dispatch("newToast",{header:"Error Updating the Object",message:`Sorry, we could not update the object's information. Error -> ${t}`,extra_classes:"bg-danger",delay:0})})),this.$store.commit("updateMouseDown",{mdObjectId:0})},updateGanttStyle(){const t=900+48*(this.deltaDays+1),e=document.getElementsByClassName("container-wide")[0];if(void 0===e)return;const a=e.clientWidth;parseInt(a)>parseInt(t)?this.ganttStyle=`width:${t}px; margin: 0 10;`:this.ganttStyle="width: calc(100vw - 10px);"},updateMiddle(t){const e=o.c9.fromISO(this.ganttStartDate).set({hour:0,minute:0,second:0,millisecond:0});if(this.mdStartDateInitial+t<e.ts)return;const a=o.c9.fromISO(this.ganttEndDate).set({hour:23,minute:59,second:59,millisecond:999});if(this.mdEndDateInitial+t>a.ts)return;const s=new Date(this.mdEndDateInitial+t),n=new Date(this.mdStartDateInitial+t);this.$store.dispatch("updateGanttChartSingleRow",{end_date:s.getTime(),higher_order_status:this.mdHigherOrderStatus,object_id:this.mdObjectId,object_type:this.mdObjectType,start_date:n.getTime(),status_id:this.mdStatusId,title:this.mdTitle})},updateStart(t){const e=new Date(this.mdStartDateInitial+t),a=o.c9.fromISO(this.ganttStartDate).set({hour:0,minute:0,second:0,millisecond:0});this.mdStartDateInitial+t<a.ts||this.mdStartDateInitial+t>=this.mdEndDateInitial||this.$store.dispatch("updateGanttChartSingleRow",{end_date:this.mdEndDateInitial,higher_order_status:this.mdHigherOrderStatus,object_id:this.mdObjectId,object_type:this.mdObjectType,start_date:e.getTime(),status_id:this.mdStatusId,title:this.mdTitle})}},mounted(){this.initialiseData()}},lt=(0,p.A)(ot,[["render",function(t,e,a,d,o,l){const c=(0,s.g2)("render-gantt-monthly-header"),h=(0,s.g2)("render-gantt-days-header"),u=(0,s.g2)("render-gantt-group"),m=(0,s.g2)("render-blank-gantt-row"),p=(0,s.g2)("n-config-provider"),b=(0,s.g2)("confirm-object-remove");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(p,{theme:l.useNBTheme(a.theme)},{default:(0,s.k6)((()=>[(0,s.Lk)("div",{class:"gantt-chart",style:(0,n.normalizeStyle)(o.ganttStyle),onMouseup:e[0]||(e[0]=(...t)=>l.mouseUp&&l.mouseUp(...t)),onMouseleave:e[1]||(e[1]=(...t)=>l.mouseLeave&&l.mouseLeave(...t)),onMousemove:e[2]||(e[2]=(...t)=>l.mouseMove&&l.mouseMove(...t))},[(0,s.bF)(c),(0,s.bF)(h),(0,s.Q3)(" RENDER EACH GANTT ROW"),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.filteredGanttChartData,((t,e)=>((0,s.uX)(),(0,s.Wv)(u,{key:e,description:t.description,"end-date":t.end_date,"is-closed":l.isParentClosed(),"level-number":0,"object-id":t.object_id,"object-type":t.object_type,"parent-object-id":0,"parent-object-type":t.parent_object_type,"higher-order-status":t.higher_order_status,"start-date":t.start_date,"status-id":t.status_id,title:t.title},null,8,["description","end-date","is-closed","object-id","object-type","parent-object-type","higher-order-status","start-date","status-id","title"])))),128)),(0,s.bF)(m)],36)])),_:1},8,["theme"]),o.startDateIssues.length>=1?((0,s.uX)(),(0,s.CE)("div",r,[e[3]||(e[3]=(0,s.eW)(" The following Objects have start dates BEFORE the gantt chart's start date. ")),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.startDateIssues,((t,e)=>((0,s.uX)(),(0,s.CE)("li",{key:e},(0,n.toDisplayString)(t.object_type)+(0,n.toDisplayString)(t.object_id)+" - "+(0,n.toDisplayString)(t.title),1)))),128))])])):(0,s.Q3)("v-if",!0),o.endDateIssues.length>=1?((0,s.uX)(),(0,s.CE)("div",i,[e[4]||(e[4]=(0,s.eW)(" The following Objects have end dates AFTER the gantt chart's end date. ")),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.endDateIssues,((t,e)=>((0,s.uX)(),(0,s.CE)("li",{key:e},(0,n.toDisplayString)(t.object_type)+(0,n.toDisplayString)(t.object_id)+" - "+(0,n.toDisplayString)(t.title),1)))),128))])])):(0,s.Q3)("v-if",!0),(0,s.bF)(b)],64)}]])},9581:(t,e,a)=>{a.d(e,{p:()=>r});var s=a(953),n=a(166);function r(t){return"dark"===(0,s.BA)(t)?n.a:null}}}]);