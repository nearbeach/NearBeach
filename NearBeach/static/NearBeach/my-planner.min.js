"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[9738],{7033:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ye});var s=a(641),o=a(33);const l=(0,s.Lk)("h1",{class:"planner-header"},"My Planner",-1),r={class:"my-planner"},n={class:"my-planner--header"},d=(0,s.Lk)("br",null,null,-1),i={class:"text-instructions"},c={class:"my-planner--body"},u=["data-user-job-id"],b={key:0,class:"card-priority-line priority-normal"},h={class:"text-instructions"},m={class:"text-instructions"};var y=a(432),p=a.n(y),k=a(6285),g=a(9336);const j={class:"modal fade",id:"confirmUserJobDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmUserJobDelete","aria-hidden":"true"},v={class:"modal-dialog"},L={class:"modal-content"},_=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"confirmUserJobDelete"}," Please confirm User Job Deletion "),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmUserJobDeleteButton"})],-1),f=(0,s.Lk)("div",{class:"modal-body"}," Are you sure you want to remove the current object from your planner? ",-1),w={class:"modal-footer"};var M=a(2124);const C={name:"confirmUserJobDelete",emits:["remove_user_job"],props:{userJobId:{type:Number,default:0}},computed:{...(0,M.L8)({rootUrl:"getRootUrl"})},methods:{deleteUserJob(){const e=new FormData;e.set("user_job_id",`${this.userJobId}`),this.axios.post(`${this.rootUrl}my_planner/delete_user_job/`,e).then((()=>{this.$emit("remove_user_job",{})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error removing user job from my planner",message:`We encounted an error removing user job from the planner. Error -> ${e}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmUserJobDeleteButton").click()}}};var D=a(6262);const S=(0,D.A)(C,[["render",function(e,t,a,o,l,r){return(0,s.uX)(),(0,s.CE)("div",j,[(0,s.Lk)("div",v,[(0,s.Lk)("div",L,[_,f,(0,s.Lk)("div",w,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>r.closeModal&&r.closeModal(...e))}," No "),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>r.deleteUserJob&&r.deleteUserJob(...e))}," Yes ")])])])])}]]);var E=a(3751);const U={class:"modal fade",id:"newPlannerObjectWizardModal",tabindex:"-1","aria-labelledby":"newPlannerObjectModel","aria-hidden":"true"},T={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},x={class:"modal-content"},O=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h2",null," New Planner Object Wizard "),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"newPlannerObjectButton"},[(0,s.Lk)("span",{"aria-hidden":"true"})])],-1),I={class:"modal-body"},$={class:"row"},A=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Object Selector"),(0,s.Lk)("p",{class:"text-instructions"}," Please select which object you would like to link to this requirement. ")],-1),F={class:"col-md-8"},P={key:1,class:"alert alert-success"},J=(0,s.Lk)("hr",null,null,-1),R={class:"row"},B=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Select Day"),(0,s.Lk)("p",{class:"text-instructions"}," Select the appropriate day for this object. ")],-1),X={class:"col-md-8"},W={class:"row"},N={class:"col-md-6 mt-4"},Q=(0,s.Lk)("label",null,"Day",-1),z=(0,s.Lk)("hr",null,null,-1),H={class:"row"},K=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Select Links"),(0,s.Lk)("p",{class:"text-instructions"}," Please select which of the objects you want to connect to this requirement. ")],-1),q={class:"col-md-8"},G={key:0,class:"alert alert-info"},Y={key:1,class:"alert alert-warning"},V={key:2,class:"form-group mb-4"},Z=(0,s.Lk)("label",null,"Search Terms",-1),ee={key:3,class:"wizard-results"},te={class:"wizard-results--card--tick"},ae=["value","id"],se={class:"wizard-results--card--content"},oe={class:"text-instructions"},le={class:"text-instructions"},re={class:"modal-footer"},ne=(0,s.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),de=["disabled"],ie={name:"NewPlannerObjectWizard",components:{NSelect:a(1080).A},emits:["update_date_array"],props:{},computed:{...(0,M.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},data:()=>({dayModel:"",isSearching:!1,linkModel:[],listOfDays:[],objectModel:null,objectFilteredResults:[],objectResults:[],objectSelection:[{value:"kanban_card",label:"Kanban Card"},{value:"project",label:"Project"},{value:"task",label:"Task"}],searchTermModel:""}),methods:{renderObjectId(e){switch(e.destination){case"kanban_card":return`Card${e.location_id}`;case"project":return`Pro${e.location_id}`;case"task":return`Task${e.location_id}`;default:return"----"}},saveLinks(){if(0===this.linkModel.length)return;this.$store.dispatch("newToast",{header:"Currenty updating your Planner",message:"Currently updating your planner. Please wait",extra_classes:"bg-warning",delay:0,unique_type:"add-objects-to-planner"});const e=new FormData;e.set("destination",this.objectModel),this.linkModel.forEach((t=>{e.append(this.objectModel,t)})),e.set("job_date",this.dayModel),this.axios.post(`${this.rootUrl}my_planner/add_object/`,e).then((e=>{this.$emit("update_date_array",e.data),this.objectModel=null,document.getElementById("newPlannerObjectButton").click(),this.$store.dispatch("newToast",{header:"Updated your Planner",message:"We have successfully updated your planner",extra_classes:"bg-success",unique_type:"add-objects-to-planner"})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error adding objects to your planner",message:`Sorry we could not add any objects to your planner. ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"add-objects-to-planner"})}))}},watch:{objectModel(){this.linkModel=[],null!==this.objectModel?(this.isSearching=!0,this.axios.post(`${this.rootUrl}my_planner/get_object_list/${this.objectModel}/`).then((e=>{this.objectResults=e.data,this.objectFilteredResults=e.data,this.isSearching=!1,this.searchTermModel=""})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Object List",message:`We had an issue getting Object List. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))):this.isSearching=!1},searchTermModel(){""!==this.searchTermModel&&null!==this.searchTermModel?this.objectFilteredResults=this.objectResults.filter((e=>e.title.toLowerCase().includes(this.searchTermModel.toLowerCase()))):this.objectFilteredResults=this.objectResults}},mounted(){const e=k.c9.now();for(let t=0;t<7;t++){const a=e.plus({days:t}),s=a.toFormat("yyyy-LL-dd"),o=a.toFormat("cccc");this.listOfDays.push({label:`${o} - ${s}`,value:s})}this.dayModel=this.listOfDays[0].value}},ce=(0,D.A)(ie,[["render",function(e,t,a,l,r,n){const d=(0,s.g2)("n-select");return(0,s.uX)(),(0,s.CE)("div",U,[(0,s.Lk)("div",T,[(0,s.Lk)("div",x,[O,(0,s.Lk)("div",I,[(0,s.Q3)(" CHOOSING A OBJECT TYPE "),(0,s.Lk)("div",$,[A,(0,s.Lk)("div",F,[r.isSearching?((0,s.uX)(),(0,s.CE)("div",P," Searching for "+(0,o.toDisplayString)(r.objectModel)+"s ",1)):((0,s.uX)(),(0,s.Wv)(d,{key:0,options:r.objectSelection,value:r.objectModel,"onUpdate:value":t[0]||(t[0]=e=>r.objectModel=e),class:"object-selection"},null,8,["options","value"]))])]),(0,s.Q3)(" OBJECT LOCATION "),J,(0,s.Lk)("div",R,[B,(0,s.Lk)("div",X,[(0,s.Lk)("div",W,[(0,s.Lk)("div",N,[Q,(0,s.bF)(d,{options:r.listOfDays,label:"column",value:r.dayModel,"onUpdate:value":t[1]||(t[1]=e=>r.dayModel=e)},null,8,["options","value"])])])])]),(0,s.Q3)(" SELECTING WHICH OBJECTS TO LINK TO "),z,(0,s.Lk)("div",H,[K,(0,s.Lk)("div",q,[(0,s.Q3)(" LOADING PLACEHOLDER "),r.isSearching||null==r.objectModel?((0,s.uX)(),(0,s.CE)("div",G," Please select the object type. ")):(0,s.Q3)("v-if",!0),0===r.objectResults.length&&null!=r.objectModel?((0,s.uX)(),(0,s.CE)("div",Y," Sorry. It currently looks like there are no "+(0,o.toDisplayString)(this.objectModel)+"s assigned to you. Only assigned "+(0,o.toDisplayString)(this.objectModel)+"s will show up here. ",1)):(0,s.Q3)("v-if",!0),(0,s.Q3)(" SEARCH RESULTS "),!r.isSearching&&r.objectResults.length>0&&null!=r.objectModel?((0,s.uX)(),(0,s.CE)("div",V,[Z,(0,s.bo)((0,s.Lk)("input",{id:"search_terms",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>r.searchTermModel=e),type:"text"},null,512),[[E.vModelText,r.searchTermModel]])])):(0,s.Q3)("v-if",!0),!r.isSearching&&r.objectFilteredResults.length>0&&null!=r.objectModel?((0,s.uX)(),(0,s.CE)("div",ee,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.objectFilteredResults,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"wizard-results--card",key:e.location_id},[(0,s.Lk)("div",te,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",name:"link-option",value:e.location_id,id:`checkbox_${e.location_id}`,"onUpdate:modelValue":t[3]||(t[3]=e=>r.linkModel=e)},null,8,ae),[[E.vModelCheckbox,r.linkModel]])]),(0,s.Lk)("div",se,[(0,s.Lk)("div",oe,(0,o.toDisplayString)(n.renderObjectId(e)),1),(0,s.Lk)("div",null,[(0,s.Lk)("strong",null,(0,o.toDisplayString)(e.title),1)]),(0,s.Lk)("div",null,[(0,s.eW)(" Status: "),(0,s.Lk)("span",le,(0,o.toDisplayString)(e.status),1)])])])))),128))])):(0,s.Q3)("v-if",!0)])])]),(0,s.Lk)("div",re,[ne,(0,s.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0===r.linkModel.length,onClick:t[4]||(t[4]=(...e)=>n.saveLinks&&n.saveLinks(...e))}," Save changes ",8,de)])])])])}]]);var ue=a(3980),be=a(246),he=a(9581);const me={name:"MyPlanner",components:{CarbonTrashCan:ue.dA,ConfirmUserJobDelete:S,draggable:p(),NewPlannerObjectWizard:ce},props:{rootUrl:{type:String,default:"/"},objectData:{type:Array,default:()=>[]},staticUrl:{type:String,default:"/"},theme:{type:String,default:""}},data:()=>({confirmIdToDelete:0,confirmIndex:0,dateArray:[]}),methods:{useNBTheme:he.p,confirmCardDelete(e,t){this.confirmIdToDelete=e,this.confirmIndex=t,new g.aF(document.getElementById("confirmUserJobDeleteModal")).show()},getClass:e=>"Closed"===e?"text-decoration-line-through":"",formatObjectId(e){const t=(0,be.y)(e.end_date);switch(e.object_type){case"card":return`Card${e.location_id}`;case"project":return`Pro${e.location_id} - ${t}`;case"task":return`Task${e.location_id} - ${t}`;default:return"----"}},removeUserJob(){this.dateArray[this.confirmIndex].data=this.dateArray[this.confirmIndex].data.filter((e=>e.user_job_id!==this.confirmIdToDelete))},onEnd(e){const t=e.to,a=e.from,s=e.item.dataset.userJobId,o=new FormData;o.set("user_job_id",s),o.set("job_date",t.dataset.jobDate);const l=t.dataset.index,r=a.dataset.index;this.dateArray[l].data.forEach((e=>{o.append("new_destination",e.user_job_id)})),l!==r&&this.dateArray[r].data.forEach((e=>{o.append("old_destination",e.user_job_id)})),this.axios.post(`${this.rootUrl}my_planner/update_object_list/`,o).catch((e=>{this.$store.dispatch("newToast",{header:"Error updating my planner",message:`Sorry, we could not update your planner. ${e}`,extra_classes:"bg-danger",delay:0})}))},showModal(){new g.aF(document.getElementById("newPlannerObjectWizardModal")).show()},updateDateArray(e){this.dateArray=this.dateArray.map((t=>{const a=e.filter((e=>e.job_date===t.date));return{date:t.date,day:t.day,data:a}}))}},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl});const e=k.c9.now();for(let t=0;t<7;t++){const a=e.plus({days:t}),s=this.objectData.filter((e=>e.job_date===a.toFormat("yyyy-LL-dd")));this.dateArray.push({date:a.toFormat("yyyy-LL-dd"),day:a.toFormat("cccc"),data:s})}}},ye=(0,D.A)(me,[["render",function(e,t,a,y,p,k){const g=(0,s.g2)("carbon-trash-can"),j=(0,s.g2)("draggable"),v=(0,s.g2)("confirm-user-job-delete"),L=(0,s.g2)("new-planner-object-wizard"),_=(0,s.g2)("n-config-provider");return(0,s.uX)(),(0,s.Wv)(_,{theme:k.useNBTheme(a.theme)},{default:(0,s.k6)((()=>[l,(0,s.Lk)("button",{class:"btn btn-primary planner-button",onClick:t[0]||(t[0]=(...e)=>k.showModal&&k.showModal(...e))},"Add Object"),(0,s.Lk)("div",r,[(0,s.Q3)(" HEADER "),(0,s.Lk)("div",n,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.dateArray,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.date,class:"my-planner--header-single-day"},[(0,s.Lk)("p",null,[(0,s.eW)((0,o.toDisplayString)(e.day),1),d,(0,s.Lk)("span",i,(0,o.toDisplayString)(e.date),1)])])))),128))]),(0,s.Q3)(" BODY "),(0,s.Lk)("div",c,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.dateArray,((e,a)=>((0,s.uX)(),(0,s.Wv)(j,{class:"my-planner--single-day list-group",group:"objects","ghost-class":"ghost",itemKey:"user_job_id","data-job-date":e.date,"data-index":a,key:e.date,list:e.data,onEnd:t[1]||(t[1]=e=>k.onEnd(e))},{item:(0,s.k6)((({element:e})=>[(0,s.Lk)("div",{class:"list-group-item","data-user-job-id":e.user_job_id},["Closed"!==e.higher_order_status?((0,s.uX)(),(0,s.CE)("div",b)):(0,s.Q3)("v-if",!0),(0,s.Lk)("div",h,(0,o.toDisplayString)(k.formatObjectId(e)),1),(0,s.Lk)("div",null,[(0,s.Lk)("strong",{class:(0,o.normalizeClass)(k.getClass(e.higher_order_status))},(0,o.toDisplayString)(e.title),3)]),(0,s.Lk)("div",null,[(0,s.eW)("Status: "),(0,s.Lk)("span",m,(0,o.toDisplayString)(e.status),1)]),(0,s.bF)(g,{class:"kanban-card-info-icon",style:{color:"red"},onClick:t=>k.confirmCardDelete(e.user_job_id,a),onDblclick:t=>k.confirmCardDelete(e.user_job_id,a)},null,8,["onClick","onDblclick"])],8,u)])),_:2},1032,["data-job-date","data-index","list"])))),128))])]),(0,s.bF)(v,{"user-job-id":p.confirmIdToDelete,onRemove_user_job:k.removeUserJob},null,8,["user-job-id","onRemove_user_job"]),(0,s.bF)(L,{onUpdate_date_array:t[2]||(t[2]=e=>k.updateDateArray(e))})])),_:1},8,["theme"])}]])},246:(e,t,a)=>{a.d(t,{y:()=>l});var s=a(6285),o=a(953);function l(e){const t=(0,o.BA)(e);return""===t||null==t?"":s.c9.fromISO(t).toLocaleString(s.c9.DATETIME_MED)}},9581:(e,t,a)=>{a.d(t,{p:()=>l});var s=a(953),o=a(7413);function l(e){return"dark"===(0,s.BA)(e)?o.a:null}}}]);