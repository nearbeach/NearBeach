"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[9738],{246:(e,t,a)=>{a.d(t,{y:()=>l});var s=a(6285),o=a(953);function l(e){const t=(0,o.BA)(e);return""===t||null==t?"":s.c9.fromISO(t).toLocaleString(s.c9.DATETIME_MED)}},3781:(e,t,a)=>{function s(e,t){return 0===t?[]:t<=7?Array.from({length:t},((e,t)=>({destinationPage:t+1,text:`${t+1}`}))):e<=4?[{destinationPage:1,text:"1"},{destinationPage:2,text:"2"},{destinationPage:3,text:"3"},{destinationPage:4,text:"4"},{destinationPage:5,text:"5"},{destinationPage:6,text:">"},{destinationPage:t,text:">>"}]:e>t-4?[{destinationPage:1,text:"<<"},{destinationPage:t-5,text:"<"},{destinationPage:t-4,text:""+(t-4)},{destinationPage:t-3,text:""+(t-3)},{destinationPage:t-2,text:""+(t-2)},{destinationPage:t-1,text:""+(t-1)},{destinationPage:t,text:`${t}`}]:[{destinationPage:1,text:"<<"},{destinationPage:e-2,text:"<"},{destinationPage:e-1,text:""+(e-1)},{destinationPage:e,text:`${e}`},{destinationPage:e+1,text:`${e+1}`},{destinationPage:e+2,text:">"},{destinationPage:t,text:">>"}]}a.d(t,{k:()=>s})},9534:(e,t,a)=>{a.r(t),a.d(t,{default:()=>de});var s=a(641),o=a(33);const l={class:"my-planner"},n={class:"my-planner--header"},r={class:"text-instructions"},i={class:"my-planner--body"},d=["data-user-job-id","data-object-type","data-location-id"],c={key:0,class:"card-priority-line priority-normal"},u={class:"text-instructions"},h={class:"text-instructions"};var b=a(432),y=a.n(b),p=a(6285),m=a(9336);const g={class:"modal fade",id:"confirmUserJobDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmUserJobDelete","aria-hidden":"true"},k={class:"modal-dialog"},v={class:"modal-content"},j={class:"modal-footer"};var f=a(2124);const L={name:"confirmUserJobDelete",emits:["remove_user_job"],props:{userJobId:{type:Number,default:0}},computed:{...(0,f.L8)({rootUrl:"getRootUrl"})},methods:{deleteUserJob(){const e=new FormData;e.set("user_job_id",`${this.userJobId}`),this.axios.post(`${this.rootUrl}my_planner/delete_user_job/`,e).then((()=>{this.$emit("remove_user_job",{})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error removing user job from my planner",message:`We encounted an error removing user job from the planner. Error -> ${e}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmUserJobDeleteButton").click()}}};var _=a(6262);const w=(0,_.A)(L,[["render",function(e,t,a,o,l,n){return(0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("div",k,[(0,s.Lk)("div",v,[t[2]||(t[2]=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"confirmUserJobDelete"}," Please confirm User Job Deletion "),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmUserJobDeleteButton"})],-1)),t[3]||(t[3]=(0,s.Lk)("div",{class:"modal-body"}," Are you sure you want to remove the current object from your planner? ",-1)),(0,s.Lk)("div",j,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>n.closeModal&&n.closeModal(...e))}," No "),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>n.deleteUserJob&&n.deleteUserJob(...e))}," Yes ")])])])])}]]);var M=a(3751);const C={class:"modal fade",id:"newPlannerObjectWizardModal",tabindex:"-1","aria-labelledby":"newPlannerObjectModel","aria-hidden":"true"},P={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},x={class:"modal-content"},D={class:"modal-body"},S={class:"row"},T={class:"col-md-8"},E={class:"row"},O={class:"col-md-8"},A={class:"row"},I={class:"col-md-6 mt-4"},U={class:"row"},$={key:0,class:"form-group mb-4"},z={key:1,class:"alert alert-info"},F={key:2,class:"wizard-results"},J={key:3,class:"alert alert-warning"},R={key:4,class:"wizard-results"},X={class:"wizard-results--card--tick"},B=["value","id"],W={class:"wizard-results--card--content"},N={class:"text-instructions"},Q={class:"text-instructions"},H={class:"row"},K={class:"col-md-8"},q={key:0,"aria-label":"Pagination for New Link Sprint Wizard"},G={class:"pagination justify-content-center"},Y=["onClick"],V={key:1,class:"page-link"},Z={class:"modal-footer"},ee=["disabled"];var te=a(1080),ae=a(3781);const se={name:"NewPlannerObjectWizard",components:{NSelect:te.A},emits:["update_date_array"],props:{},computed:{...(0,f.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},data:()=>({currentPage:1,dayModel:null,isSearching:!1,linkModel:[],listOfDays:[],numberOfPages:0,objectModel:null,objectResults:[],objectSelection:[{value:"kanban_card",label:"Kanban Card"},{value:"project",label:"Project"},{value:"task",label:"Task"}],searchTermModel:"",setOfPages:[],styleHeight:""}),methods:{changePage(e){this.getObjectResults(this.dayModel,e)},getClasses(e){return parseInt(e)===this.currentPage?"page-item active":"page-item"},getObjectResults(e,t){const a=this.$refs.wizard.offsetHeight>182?this.$refs.wizard.offsetHeight:182;this.styleHeight=`height:${a}px`,this.objectResults=[],this.isSearching=!0;const s=new FormData;s.set("object_type",this.objectModel),s.set("job_date",e),s.set("destination_page",t),s.set("search",this.searchTermModel),this.axios.post(`${this.rootUrl}my_planner/get_object_list/`,s).then((e=>{this.objectResults=e.data[this.objectModel.toLowerCase()],this.numberOfPages=e.data[`${this.objectModel.toLowerCase()}_number_of_pages`],this.currentPage=e.data[`${this.objectModel.toLowerCase()}_current_page`],this.setOfPages=(0,ae.k)(this.currentPage,this.numberOfPages),this.styleHeight="",this.isSearching=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Object List",message:`We had an issue getting Object List. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},renderObjectId(e){switch(e.destination){case"kanban_card":return`Card${e.location_id}`;case"project":return`Pro${e.location_id}`;case"task":return`Task${e.location_id}`;default:return"----"}},saveLinks(){if(0===this.linkModel.length)return;this.$store.dispatch("newToast",{header:"Currenty updating your Planner",message:"Currently updating your planner. Please wait",extra_classes:"bg-warning",delay:0,unique_type:"add-objects-to-planner"});const e=new FormData;e.set("destination",this.objectModel),this.linkModel.forEach((t=>{e.append(this.objectModel,t)})),e.set("job_date",this.dayModel),this.axios.post(`${this.rootUrl}my_planner/add_object/`,e).then((e=>{this.$emit("update_date_array",e.data),this.objectModel=null,this.dayModel=null,this.linkModel=[],this.objectResults=[],document.getElementById("newPlannerObjectButton").click(),this.$store.dispatch("newToast",{header:"Updated your Planner",message:"We have successfully updated your planner",extra_classes:"bg-success",unique_type:"add-objects-to-planner"})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error adding objects to your planner",message:`Sorry we could not add any objects to your planner. ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"add-objects-to-planner"})}))}},watch:{dayModel(e){null!==e&&null!==this.objectModel?this.getObjectResults(e,1):this.isSearching=!1},objectModel(e){null!==e?(this.linkModel=[],null!==this.dayModel&&this.getObjectResults(this.dayModel,1)):this.isSearching=!1},searchTermModel(e){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),(e.length>=3||0===e.length)&&(this.searchTimeout=setTimeout((()=>{this.getObjectResults(this.dayModel,1)}),500))}},mounted(){const e=p.c9.now();for(let t=0;t<7;t++){const a=e.plus({days:t}),s=a.toFormat("yyyy-LL-dd"),o=a.toFormat("cccc");this.listOfDays.push({label:`${o} - ${s}`,value:s})}}},oe=(0,_.A)(se,[["render",function(e,t,a,l,n,r){const i=(0,s.g2)("n-select");return(0,s.uX)(),(0,s.CE)("div",C,[(0,s.Lk)("div",P,[(0,s.Lk)("div",x,[t[16]||(t[16]=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h2",null," New Planner Object Wizard "),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"newPlannerObjectButton"},[(0,s.Lk)("span",{"aria-hidden":"true"})])],-1)),(0,s.Lk)("div",D,[(0,s.Q3)(" CHOOSING A OBJECT TYPE "),(0,s.Lk)("div",S,[t[5]||(t[5]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Object Selector"),(0,s.Lk)("p",{class:"text-instructions"}," Please select which object you would like to link to this requirement. ")],-1)),(0,s.Lk)("div",T,[(0,s.bF)(i,{options:n.objectSelection,value:n.objectModel,"onUpdate:value":t[0]||(t[0]=e=>n.objectModel=e),class:"object-selection"},null,8,["options","value"])])]),(0,s.Q3)(" OBJECT LOCATION "),t[13]||(t[13]=(0,s.Lk)("hr",null,null,-1)),(0,s.Lk)("div",E,[t[7]||(t[7]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Select Day"),(0,s.Lk)("p",{class:"text-instructions"}," Select the appropriate day for this object. ")],-1)),(0,s.Lk)("div",O,[(0,s.Lk)("div",A,[(0,s.Lk)("div",I,[t[6]||(t[6]=(0,s.Lk)("label",null,"Day",-1)),(0,s.bF)(i,{options:n.listOfDays,label:"column",value:n.dayModel,"onUpdate:value":t[1]||(t[1]=e=>n.dayModel=e)},null,8,["options","value"])])])])]),(0,s.Q3)(" SELECTING WHICH OBJECTS TO LINK TO "),t[14]||(t[14]=(0,s.Lk)("hr",null,null,-1)),(0,s.Lk)("div",U,[t[11]||(t[11]=(0,s.Lk)("div",{class:"col-md-4"},[(0,s.Lk)("strong",null,"Select Links"),(0,s.Lk)("p",{class:"text-instructions"}," Please select which of the objects you want to connect to this requirement. ")],-1)),(0,s.Lk)("div",{class:"col-md-8",ref:"wizard",style:(0,o.normalizeStyle)(n.styleHeight)},[(0,s.Q3)(" SEARCH RESULTS "),null!==n.objectModel&&null!==n.dayModel?((0,s.uX)(),(0,s.CE)("div",$,[t[8]||(t[8]=(0,s.Lk)("label",null,"Search Terms",-1)),(0,s.bo)((0,s.Lk)("input",{id:"search_terms",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>n.searchTermModel=e),type:"text"},null,512),[[M.vModelText,n.searchTermModel]])])):(0,s.Q3)("v-if",!0),(0,s.Q3)(" LOADING PLACEHOLDER "),null==n.objectModel||null==n.dayModel?((0,s.uX)(),(0,s.CE)("div",z," Please make sure you have populated the Object Type, and the Day. ")):(0,s.Q3)("v-if",!0),n.isSearching?((0,s.uX)(),(0,s.CE)("div",F,t[9]||(t[9]=[(0,s.Fv)('<div class="wizard-results--card"><div class="wizard-results--card--tick"></div><div class="wizard-results--card--content"><span class="placeholder col-1"></span><br><span class="placeholder col-11"></span><span class="placeholder col-8"></span></div></div>',1)]))):(0,s.Q3)("v-if",!0),0===n.objectResults.length&&!1===n.isSearching&&null!=n.objectModel&&null!=n.dayModel?((0,s.uX)(),(0,s.CE)("div",J," Sorry. It currently looks like there are no "+(0,o.toDisplayString)(this.objectModel)+"s assigned to you. Only assigned "+(0,o.toDisplayString)(this.objectModel)+"s will show up here. ",1)):(0,s.Q3)("v-if",!0),!n.isSearching&&n.objectResults.length>0&&null!=n.objectModel?((0,s.uX)(),(0,s.CE)("div",R,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.objectResults,(e=>((0,s.uX)(),(0,s.CE)("div",{class:"wizard-results--card",key:e.location_id},[(0,s.Lk)("div",X,[(0,s.bo)((0,s.Lk)("input",{class:"form-check-input",type:"checkbox",name:"link-option",value:e.location_id,id:`checkbox_${e.location_id}`,"onUpdate:modelValue":t[3]||(t[3]=e=>n.linkModel=e)},null,8,B),[[M.vModelCheckbox,n.linkModel]])]),(0,s.Lk)("div",W,[(0,s.Lk)("div",N,(0,o.toDisplayString)(r.renderObjectId(e)),1),(0,s.Lk)("div",null,[(0,s.Lk)("strong",null,(0,o.toDisplayString)(e.title),1)]),(0,s.Lk)("div",null,[t[10]||(t[10]=(0,s.eW)(" Status: ")),(0,s.Lk)("span",Q,(0,o.toDisplayString)(e.status),1)])])])))),128))])):(0,s.Q3)("v-if",!0)],4)]),(0,s.Lk)("div",H,[t[12]||(t[12]=(0,s.Lk)("div",{class:"col-md-4"},null,-1)),(0,s.Lk)("div",K,[n.setOfPages.length>1?((0,s.uX)(),(0,s.CE)("nav",q,[(0,s.Lk)("ul",G,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.setOfPages,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.destinationPage,class:(0,o.normalizeClass)(r.getClasses(e.destinationPage))},[parseInt(e.destinationPage)!==parseInt(n.currentPage)?((0,s.uX)(),(0,s.CE)("a",{key:0,class:"page-link",href:"javascript:void(0)",onClick:t=>r.changePage(e.destinationPage)},(0,o.toDisplayString)(e.text),9,Y)):((0,s.uX)(),(0,s.CE)("span",V,(0,o.toDisplayString)(e.text),1))],2)))),128))])])):(0,s.Q3)("v-if",!0)])])]),(0,s.Lk)("div",Z,[t[15]||(t[15]=(0,s.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0===n.linkModel.length,onClick:t[4]||(t[4]=(...e)=>r.saveLinks&&r.saveLinks(...e))}," Save changes ",8,ee)])])])])}]]);var le=a(3980),ne=a(246),re=a(9581);const ie={name:"MyPlanner",components:{CarbonTrashCan:le.dA,ConfirmUserJobDelete:w,draggable:y(),NewPlannerObjectWizard:oe},props:{rootUrl:{type:String,default:"/"},objectData:{type:Array,default:()=>[]},staticUrl:{type:String,default:"/"},theme:{type:String,default:""}},data:()=>({confirmIdToDelete:0,confirmIndex:0,dateArray:[]}),methods:{useNBTheme:re.p,confirmCardDelete(e,t){this.confirmIdToDelete=e,this.confirmIndex=t,new m.aF(document.getElementById("confirmUserJobDeleteModal")).show()},getClass:e=>"Closed"===e?"text-decoration-line-through":"",formatObjectId(e){const t=(0,ne.y)(e.end_date);switch(e.object_type){case"kanban_card":return`Card${e.location_id}`;case"project":return`Pro${e.location_id} - ${t}`;case"task":return`Task${e.location_id} - ${t}`;default:return"----"}},move(e){return this.dateArray[e.to.dataset.index].allowMoveTo},removeUserJob(){this.dateArray[this.confirmIndex].data=this.dateArray[this.confirmIndex].data.filter((e=>e.user_job_id!==this.confirmIdToDelete))},resetAllowToMove(){for(let e=0;e<this.dateArray.length;e++)this.dateArray[e].allowMoveTo=!0},onEnd(e){this.resetAllowToMove();const t=e.to,a=e.from,s=e.item.dataset.userJobId,o=new FormData;o.set("user_job_id",s),o.set("job_date",t.dataset.jobDate);const l=t.dataset.index,n=a.dataset.index;this.dateArray[l].data.forEach((e=>{o.append("new_destination",e.user_job_id)})),l!==n&&this.dateArray[n].data.forEach((e=>{o.append("old_destination",e.user_job_id)})),this.axios.post(`${this.rootUrl}my_planner/update_object_list/`,o).catch((e=>{this.$store.dispatch("newToast",{header:"Error updating my planner",message:`Sorry, we could not update your planner. ${e}`,extra_classes:"bg-danger",delay:0})}))},onStart(e){this.updateAllowMoveTo(e.item.dataset.objectType,e.item.dataset.locationId,e.from.dataset.jobDate)},showModal(){new m.aF(document.getElementById("newPlannerObjectWizardModal")).show()},updateAllowMoveTo(e,t,a){for(let s=0;s<this.dateArray.length;s++){if(this.dateArray[s].date===a)continue;const o=this.dateArray[s]?.data?.some((a=>{const s=parseInt(t)===parseInt(a.location_id),o=e.toLowerCase()===a.object_type.toLowerCase();return s&&o}));void 0!==this.dateArray[s]?.allowMoveTo&&o&&(this.dateArray[s].allowMoveTo=!1)}},updateDateArray(e){this.dateArray=this.dateArray.map((t=>{const a=e.filter((e=>e.job_date===t.date));return{date:t.date,day:t.day,data:a}}))}},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl});const e=p.c9.now();for(let t=0;t<7;t++){const a=e.plus({days:t}),s=this.objectData.filter((e=>e.job_date===a.toFormat("yyyy-LL-dd")));this.dateArray.push({date:a.toFormat("yyyy-LL-dd"),day:a.toFormat("cccc"),allowMoveTo:!0,data:s})}}},de=(0,_.A)(ie,[["render",function(e,t,a,b,y,p){const m=(0,s.g2)("carbon-trash-can"),g=(0,s.g2)("draggable"),k=(0,s.g2)("confirm-user-job-delete"),v=(0,s.g2)("new-planner-object-wizard"),j=(0,s.g2)("n-config-provider");return(0,s.uX)(),(0,s.Wv)(j,{theme:p.useNBTheme(a.theme)},{default:(0,s.k6)((()=>[t[6]||(t[6]=(0,s.Lk)("h1",{class:"planner-header"},"My Planner",-1)),(0,s.Lk)("button",{class:"btn btn-primary planner-button",onClick:t[0]||(t[0]=(...e)=>p.showModal&&p.showModal(...e))},"Add Object"),(0,s.Lk)("div",l,[(0,s.Q3)(" HEADER "),(0,s.Lk)("div",n,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.dateArray,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.date,class:"my-planner--header-single-day"},[(0,s.Lk)("p",null,[(0,s.eW)((0,o.toDisplayString)(e.day),1),t[4]||(t[4]=(0,s.Lk)("br",null,null,-1)),(0,s.Lk)("span",r,(0,o.toDisplayString)(e.date),1)])])))),128))]),(0,s.Q3)(" BODY "),(0,s.Lk)("div",i,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.dateArray,((e,a)=>((0,s.uX)(),(0,s.Wv)(g,{class:"my-planner--single-day list-group",group:"objects","ghost-class":"ghost",itemKey:"user_job_id","data-job-date":e.date,"data-index":a,move:p.move,key:e.date,list:e.data,onEnd:t[1]||(t[1]=e=>p.onEnd(e)),onStart:t[2]||(t[2]=e=>p.onStart(e))},{item:(0,s.k6)((({element:e})=>[(0,s.Lk)("div",{class:"list-group-item","data-user-job-id":e.user_job_id,"data-object-type":e.object_type,"data-location-id":e.location_id},["Closed"!==e.higher_order_status?((0,s.uX)(),(0,s.CE)("div",c)):(0,s.Q3)("v-if",!0),(0,s.Lk)("div",u,(0,o.toDisplayString)(p.formatObjectId(e)),1),(0,s.Lk)("div",null,[(0,s.Lk)("strong",{class:(0,o.normalizeClass)(p.getClass(e.higher_order_status))},(0,o.toDisplayString)(e.title),3)]),(0,s.Lk)("div",null,[t[5]||(t[5]=(0,s.eW)("Status: ")),(0,s.Lk)("span",h,(0,o.toDisplayString)(e.status),1)]),(0,s.bF)(m,{class:"kanban-card-info-icon",style:{color:"red"},onClick:t=>p.confirmCardDelete(e.user_job_id,a),onDblclick:t=>p.confirmCardDelete(e.user_job_id,a)},null,8,["onClick","onDblclick"])],8,d)])),_:2},1032,["data-job-date","data-index","move","list"])))),128))])]),(0,s.bF)(k,{"user-job-id":y.confirmIdToDelete,onRemove_user_job:p.removeUserJob},null,8,["user-job-id","onRemove_user_job"]),(0,s.bF)(v,{"date-array":y.dateArray,onUpdate_date_array:t[3]||(t[3]=e=>p.updateDateArray(e))},null,8,["date-array"])])),_:1},8,["theme"])}]])},9581:(e,t,a)=>{a.d(t,{p:()=>l});var s=a(953),o=a(166);function l(e){return"dark"===(0,s.BA)(e)?o.a:null}}}]);