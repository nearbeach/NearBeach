"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[8067],{1390:(e,t,s)=>{s.d(t,{A:()=>b});var i=s(641),n=s(33);const a={key:0},l={class:"col-md-10 object-link--details"},o=["href"],r={class:"object-link--link"},d={class:"object-link--title"},c={class:"col-md-2 object-link--status"},u={key:0,class:"object-link--remove"},m={key:1,class:"spacer-extra"};var p=s(2124),k=s(9336);const h={name:"SubObjectLinks",components:{CarbonTrashCan:s(3980).dA},emits:["update_link_results"],props:{canDelete:{type:Boolean,default:!0},linkResults:{type:Array,default:()=>[]},title:{type:String,default:"Relates"}},computed:{...(0,p.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{confirmRemoveLink(e){this.$store.commit("updateObjectLink",{objectLink:e}),new k.aF(document.getElementById("confirmLinkDeleteModal")).show()}}},b=(0,s(6262).A)(h,[["render",function(e,t,s,p,k,h){const b=(0,i.g2)("carbon-trash-can");return(0,i.uX)(),(0,i.CE)(i.FK,null,[s.linkResults.length>0?((0,i.uX)(),(0,i.CE)("h3",a,(0,n.toDisplayString)(s.title),1)):(0,i.Q3)("v-if",!0),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.linkResults,(a=>((0,i.uX)(),(0,i.CE)("div",{key:a.pk,class:"row object-link"},[(0,i.Q3)(" Object ID + Title "),(0,i.Lk)("div",l,[(0,i.Lk)("a",{href:`${this.rootUrl}${a.object_type}_information/${a.object_id}/`,target:"_blank",rel:"noopener noreferrer"},[(0,i.Lk)("div",r,(0,n.toDisplayString)(a.object_type)+" - "+(0,n.toDisplayString)(a.object_id),1),(0,i.Lk)("div",d,(0,n.toDisplayString)(a.object_title),1)],8,o)]),(0,i.Q3)(" Object Status "),(0,i.Lk)("div",c,[t[0]||(t[0]=(0,i.Lk)("span",null,"Object Status: ",-1)),(0,i.Lk)("span",null,(0,n.toDisplayString)(a.object_status),1)]),(0,i.Q3)(" Object Delete "),e.userLevel>=2&&!0===s.canDelete?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.bF)(b,{onClick:e=>h.confirmRemoveLink(a)},null,8,["onClick"])])):(0,i.Q3)("v-if",!0)])))),128)),s.linkResults.length>0?((0,i.uX)(),(0,i.CE)("div",m)):(0,i.Q3)("v-if",!0)],64)}]])},3703:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ei});var i=s(641);const n={class:"card"},a={class:"card-body"},l={class:"nav nav-tabs",id:"misc_module_tabs",role:"tablist"},o={key:0,class:"nav-item",role:"presentation"},r={key:1,class:"nav-item",role:"presentation"},d={key:2,class:"nav-item",role:"presentation"},c={key:3,class:"nav-item",role:"presentation"},u={key:4,class:"nav-item",role:"presentation"},m={key:5,class:"nav-item",role:"presentation"},p={key:6,class:"nav-item",role:"presentation"},k={class:"tab-content",id:"misc_module_content"},h={key:0,class:"tab-pane fade show active",id:"group-and-users",role:"tabpanel","aria-labelledby":"contact-tab"},b={key:1,class:"tab-pane fade",id:"requirement-items",role:"tabpanel","aria-labelledby":"home-tab"},L={key:2,class:"tab-pane fade",id:"requirement-links",role:"tabpanel","aria-labelledby":"profile-tab"},g={key:3,class:"tab-pane fade",id:"requirement-item-links",role:"tabpanel","aria-labelledby":"profile-tab"},v={class:"tab-pane fade",id:"documents",role:"tabpanel","aria-labelledby":"contact-tab"},y={class:"tab-pane fade",id:"object-links",role:"tabpanel","aria-labelledby":"contact-tab"},_={class:"tab-pane fade",id:"customers",role:"tabpanel","aria-labelledby":"contact-tab"},f={class:"tab-pane fade",id:"sprints",role:"tabpanel","aria-labelledby":"tabpanel"},S={class:"tab-pane fade",id:"misc",role:"tabpanel","aria-labelledby":"contact-tab"},C={class:"tab-pane fade",id:"notes",role:"tabpanel","aria-labelledby":"contact-tab"},j={key:4,class:"tab-pane fade bg-danger",id:"admin",role:"tabpanel","aria-labelledby":"contact-tab"};var w=s(1500);const I={key:0,class:"requirement-item-spacer"},R={key:1},E={key:2},M={key:3,class:"row submit-row"},T={class:"col-md-12"};var $=s(9336),D=s(3751);const O={class:"modal fade",id:"newItemModal",tabindex:"-1","aria-labelledby":"requirementItemModal","aria-hidden":"true"},U={class:"modal-dialog modal-xl modal-fullscreen-lg-down"},q={class:"modal-content"},x={class:"modal-body"},F={class:"row"},N={class:"col-md-8"},Q={for:"id_requirement_item_title"},A={class:"row"},X={class:"col-md-4"},P={class:"form-group"},B={class:"col-md-4"},z={class:"form-group"},W={class:"modal-footer"};var K=s(1080),H=s(8838),V=s(9639),G=s(3855),Y=s(404),J=s(2124);const Z={name:"NewRequirementItemWizard",setup:()=>({v$:(0,V.Ay)()}),components:{editor:H.A,NSelect:K.A,ValidationRendering:Y.A},emits:["new_item_added"],data:()=>({requirementItemScopeModel:"",requirementItemTitleModel:"",statusItemFixList:[],statusItemModel:"",typeItemFixList:[],typeItemModel:""}),computed:{...(0,J.L8)({contentCss:"getContentCss",locationId:"getLocationId",rootUrl:"getRootUrl",skin:"getSkin"})},validations:{requirementItemScopeModel:{required:G.mw,maxLength:(0,G.Ru)(63e4)},requirementItemTitleModel:{required:G.mw},statusItemModel:{required:G.mw},typeItemModel:{required:G.mw}},methods:{saveItem(){if(this.v$.$touch(),this.v$.$invalid)return;const e=new FormData;e.set("requirement_item_title",this.requirementItemTitleModel),e.set("requirement_item_scope",this.requirementItemScopeModel),e.set("requirement_item_status",this.statusItemModel),e.set("requirement_item_type",this.typeItemModel),this.axios.post(`${this.rootUrl}new_requirement_item/save/${this.locationId}/`,e).then((e=>{this.requirementItemScopeModel="",this.requirementItemTitleModel="",this.statusItemModel="",this.typeItemModel="",this.$emit("new_item_added",e.data),document.getElementById("requirementItemCloseButton").click()})).catch((e=>{this.$store.dispatch("newToast",{header:"Failed to save item",message:`Failed to save item. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},updateStatusList(){this.axios.post(`${this.rootUrl}requirement_information/data/list_of_item_status_values/`).then((e=>{this.statusItemFixList=e.data.map((e=>({value:e.pk,label:e.fields.requirement_item_status})))})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Updating Status List",message:`There was an error updating the status list - error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},updateTypeList(){this.axios.post(`${this.rootUrl}requirement_information/data/list_of_item_type_values/`).then((e=>{this.typeItemFixList=e.data.map((e=>({value:e.pk,label:e.fields.requirement_item_type})))})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Updating Type List",message:`There was an error updating the type list - error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.$nextTick((()=>{this.updateStatusList(),this.updateTypeList()}))}};var ee=s(6262);const te=(0,ee.A)(Z,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("validation-rendering"),r=(0,i.g2)("editor"),d=(0,i.g2)("n-select");return(0,i.uX)(),(0,i.CE)("div",O,[(0,i.Lk)("div",U,[(0,i.Lk)("div",q,[t[15]||(t[15]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h2",null," New Requirement Item Wizard "),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"requirementItemCloseButton"},[(0,i.Lk)("span",{"aria-hidden":"true"})])],-1)),(0,i.Lk)("div",x,[(0,i.Lk)("div",F,[t[9]||(t[9]=(0,i.Lk)("div",{class:"col-md-4"},[(0,i.Lk)("strong",null,"Description"),(0,i.Lk)("p",{class:"text-instructions"}," Place in a detailed description of this requirement item. This particular item can be then connected to Project or Tasks. ")],-1)),(0,i.Lk)("div",N,[(0,i.Lk)("label",Q,[t[5]||(t[5]=(0,i.eW)("Requirement Item Title: ")),(0,i.bF)(o,{"error-list":n.v$.requirementItemTitleModel.$errors},null,8,["error-list"])]),(0,i.bo)((0,i.Lk)("input",{id:"id_requirement_item_title",class:"form-control",name:"requirement_item_title",type:"text",required:"true",maxlength:"255","onUpdate:modelValue":t[0]||(t[0]=e=>a.requirementItemTitleModel=e)},null,512),[[D.vModelText,a.requirementItemTitleModel]]),t[7]||(t[7]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("label",null,[t[6]||(t[6]=(0,i.eW)(" Requirement Item Scope: ")),(0,i.bF)(o,{"error-list":n.v$.requirementItemTitleModel.$errors},null,8,["error-list"])]),t[8]||(t[8]=(0,i.Lk)("br",null,null,-1)),(0,i.bF)(r,{"license-key":"gpl",init:{license_key:"gpl",height:500,menubar:!1,plugins:["lists","codesample","table"],toolbar:"undo redo | blocks | bold italic strikethrough underline backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | table image codesample",skin:`${this.skin}`,content_css:`${this.contentCss}`,relative_urls:!1},modelValue:a.requirementItemScopeModel,"onUpdate:modelValue":t[1]||(t[1]=e=>a.requirementItemScopeModel=e)},null,8,["init","modelValue"])])]),(0,i.Q3)(" Status "),t[13]||(t[13]=(0,i.Lk)("hr",null,null,-1)),(0,i.Lk)("div",A,[t[12]||(t[12]=(0,i.Lk)("div",{class:"col-md-4"},[(0,i.Lk)("h2",null,"Status"),(0,i.Lk)("p",{class:"text-instructions"}," Set the Requirement Status and Type here. ")],-1)),(0,i.Lk)("div",X,[(0,i.Lk)("div",P,[(0,i.Lk)("label",null,[t[10]||(t[10]=(0,i.eW)("Requirement Status ")),(0,i.bF)(o,{"error-list":n.v$.requirementItemTitleModel.$errors},null,8,["error-list"])]),(0,i.bF)(d,{options:a.statusItemFixList,label:"status",value:a.statusItemModel,"onUpdate:value":t[2]||(t[2]=e=>a.statusItemModel=e)},null,8,["options","value"])])]),(0,i.Lk)("div",B,[(0,i.Lk)("div",z,[(0,i.Lk)("label",null,[t[11]||(t[11]=(0,i.eW)("Requirement Type ")),(0,i.bF)(o,{"error-list":n.v$.typeItemModel.$errors},null,8,["error-list"])]),(0,i.bF)(d,{options:a.typeItemFixList,label:"type",value:a.typeItemModel,"onUpdate:value":t[3]||(t[3]=e=>a.typeItemModel=e)},null,8,["options","value"])])])])]),(0,i.Q3)(" FOOTERS "),(0,i.Lk)("div",W,[t[14]||(t[14]=(0,i.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=(...e)=>l.saveItem&&l.saveItem(...e))}," Save Requirement Item ")])])])])}]]),se={name:"RequirementItemsModule",components:{RenderObjectCard:s(9724).A,NewRequirementItemWizard:te},data:()=>({requirementItemVariables:{header:"Requirement Items",prefix:"RI-",id:"requirement_item_id",title:"requirement_item_title",status:"requirement_item_status_text",end_date:""},itemResults:[],itemStatusList:[],itemTypeList:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{createNewItem(){new $.aF(document.getElementById("newItemModal")).show()},newItemAdded(e){this.itemResults=e},updateItemResults(){this.axios.post("data/items/").then((e=>{this.itemResults=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Updating Item Results",message:`We are having issues updating item results: Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.updateItemResults()}},ie=(0,ee.A)(se,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("render-object-card"),r=(0,i.g2)("new-requirement-item-wizard");return(0,i.uX)(),(0,i.CE)("div",null,[t[3]||(t[3]=(0,i.Lk)("h2",null," Requirement Items ",-1)),t[4]||(t[4]=(0,i.Lk)("p",{class:"text-instructions"}," Requirements should be broken down into smaller components called Requirement Items. ",-1)),(0,i.Q3)(" TABLE OF REQUIREMENT ITEMS "),0===a.itemResults.length?((0,i.uX)(),(0,i.CE)("div",I,t[2]||(t[2]=[(0,i.Lk)("div",{class:"alert alert-dark"}," Sorry - there are no Items for this requirement. ",-1)]))):((0,i.uX)(),(0,i.CE)("div",R,[(0,i.bF)(o,{"import-variables":a.requirementItemVariables,"search-results":a.itemResults,destination:"requirement_item"},null,8,["import-variables","search-results"])])),(0,i.Q3)(" Submit Button "),(0,i.Q3)(" TO DO - limit it to certain users "),e.userLevel>1?((0,i.uX)(),(0,i.CE)("hr",E)):(0,i.Q3)("v-if",!0),e.userLevel>1?((0,i.uX)(),(0,i.CE)("div",M,[(0,i.Lk)("div",T,[(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.createNewItem&&l.createNewItem(...e)),class:"btn btn-primary save-changes"}," Create new Requirement Item ")])])):(0,i.Q3)("v-if",!0),(0,i.Q3)(" NEW REQUIREMENT ITEM MODAL "),(0,i.bF)(r,{"item-status-list":a.itemStatusList,"item-type-list":a.itemTypeList,"location-id":e.locationId,onNew_item_added:t[1]||(t[1]=e=>l.newItemAdded(e))},null,8,["item-status-list","item-type-list","location-id"])])}]]),ne={key:0},ae={key:1},le={key:2},oe={key:3,class:"row submit-row"},re={class:"col-md-12"};var de=s(33);const ce={class:"modal fade",id:"newRequirementLinkModal",tabindex:"-1","aria-labelledby":"requirementLinkModal","aria-hidden":"true"},ue={class:"modal-dialog modal-lg"},me={class:"modal-content"},pe={class:"modal-body"},ke={class:"row"},he={class:"col-md-8"},be={class:"form-group"},Le={class:"col-md-8"},ge={key:0,class:"alert alert-warning"},ve={key:1,class:"form-group"},ye={key:2,class:"wizard-results"},_e={class:"wizard-results--card--tick"},fe=["value","id"],Se={class:"wizard-results--card--content"},Ce={class:"text-instructions"},je={class:"text-instructions"},we={key:0,"aria-label":"Pagination for New Link Wizard"},Ie={class:"pagination justify-content-center"},Re=["onClick"],Ee={key:1,class:"page-link"},Me={class:"modal-footer"},Te=["disabled"],$e={name:"NewRequirementLinkWizard",components:{NSelect:K.A},emits:["update_module"],props:{destination:{type:String,default:""},locationId:{type:Number,default:0}},computed:{...(0,J.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},data:()=>({currentPage:1,isSearching:!1,linkModel:[],numberOfPages:1,objectModel:null,objectResults:[],objectSelection:[{value:"Project",label:"Project"},{value:"Task",label:"Task"}],searchModel:"",searchTimeout:"",styleHeight:"height: 90px"}),watch:{objectModel(){this.getObjects()},searchModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),(this.searchModel.length>=3||0===this.searchModel.length)&&(this.searchTimeout=setTimeout((()=>{this.getObjects()}),500))}},methods:{changePage(e){this.currentPage=e,this.getObjects()},getClasses(e){return parseInt(e)===this.currentPage?"page-item active":"page-item"},getObjects(){if(this.linkModel=[],null===this.objectModel)return void(this.isSearching=!1);const e=new FormData;e.append("array_of_objects",this.objectModel.toLowerCase()),e.set("destination_page",this.currentPage),e.set("exclude_destination",this.destination),e.set("exclude_location_id",this.locationId),e.set("search",this.searchModel),this.isSearching=!0,this.axios.post(`${this.rootUrl}search/data/`,e).then((e=>{this.objectResults=e.data[this.objectModel.toLowerCase()],this.numberOfPages=e.data[`${this.objectModel.toLowerCase()}_number_of_pages`],this.currentPage=e.data[`${this.objectModel.toLowerCase()}_current_page`],this.isSearching=!1,this.styleHeight="",this.$nextTick((()=>{const e=document.getElementById("select_links");null!=e&&(this.styleHeight=`height: ${e.clientHeight}px`)}))})).catch((()=>{this.$store.dispatch("newToast",{header:"Error retrieving links",message:"We are currently having issues obtaining data",delay:0,extra_classes:"bg-danger"})}))},saveLinks(){const e=new FormData;this.linkModel.forEach((t=>{e.append(`${this.objectModel.toLowerCase()}`,t)})),this.axios.post(`${this.rootUrl}${this.destination}_information/${this.locationId}/add_link/`,e).then((e=>{this.$emit("update_module",e.data),document.getElementById("requirementLinkCloseButton").click(),this.objectModel=null,this.styleHeight="height: 90px"}))}}},De=(0,ee.A)($e,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("n-select");return(0,i.uX)(),(0,i.CE)("div",ce,[(0,i.Lk)("div",ue,[(0,i.Lk)("div",me,[t[12]||(t[12]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h2",null," New Requirement Link Wizard "),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"requirementLinkCloseButton"},[(0,i.Lk)("span",{"aria-hidden":"true"})])],-1)),(0,i.Lk)("div",pe,[(0,i.Q3)(" CHOOSING A OBJECT TYPE "),(0,i.Lk)("div",ke,[t[5]||(t[5]=(0,i.Lk)("div",{class:"col-md-4"},[(0,i.Lk)("strong",null,"Object Selector"),(0,i.Lk)("p",{class:"text-instructions"}," Please select which object you would like to link to this requirement. ")],-1)),(0,i.Lk)("div",he,[(0,i.Lk)("div",be,[t[4]||(t[4]=(0,i.Lk)("label",null,"Object Selection",-1)),(0,i.bF)(o,{options:a.objectSelection,value:a.objectModel,"onUpdate:value":t[0]||(t[0]=e=>a.objectModel=e),class:"object-selection"},null,8,["options","value"])])])]),t[10]||(t[10]=(0,i.Lk)("hr",null,null,-1)),(0,i.Q3)(" SELECTING WHICH OBJECTS TO LINK TO "),(0,i.Lk)("div",{id:"select_links",class:"row",style:(0,de.normalizeStyle)(a.styleHeight)},[t[9]||(t[9]=(0,i.Lk)("div",{class:"col-md-4"},[(0,i.Lk)("strong",null,"Select Links"),(0,i.Lk)("p",{class:"text-instructions"}," Please select which of the objects you want to connect to this requirement. ")],-1)),(0,i.Lk)("div",Le,[0===a.objectResults.length&&null!=a.objectModel?((0,i.uX)(),(0,i.CE)("div",ge," Sorry - there are no results. ")):(0,i.Q3)("v-if",!0),(0,i.Q3)(" SEARCH RESULTS "),null!=a.objectModel?((0,i.uX)(),(0,i.CE)("div",ve,[t[6]||(t[6]=(0,i.Lk)("label",null,"Filter",-1)),(0,i.bo)((0,i.Lk)("input",{id:"search_terms",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>a.searchModel=e),type:"text"},null,512),[[D.vModelText,a.searchModel]])])):(0,i.Q3)("v-if",!0),t[8]||(t[8]=(0,i.Lk)("br",null,null,-1)),!a.isSearching&&a.objectResults.length>0&&null!=a.objectModel?((0,i.uX)(),(0,i.CE)("div",ye,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.objectResults,(e=>((0,i.uX)(),(0,i.CE)("div",{class:"wizard-results--card",key:e.id},[(0,i.Lk)("div",_e,[(0,i.bo)((0,i.Lk)("input",{class:"form-check-input",type:"checkbox",name:"link-option",value:e.id,id:`checkbox_${a.objectModel.toLowerCase()}_${e.pk}`,"onUpdate:modelValue":t[2]||(t[2]=e=>a.linkModel=e)},null,8,fe),[[D.vModelCheckbox,a.linkModel]])]),(0,i.Lk)("div",Se,[(0,i.Lk)("div",Ce,(0,de.toDisplayString)(a.objectModel)+" "+(0,de.toDisplayString)(e.id),1),(0,i.Lk)("div",null,[(0,i.Lk)("strong",null,(0,de.toDisplayString)(e.title),1)]),(0,i.Lk)("div",null,[t[7]||(t[7]=(0,i.eW)(" Status: ")),(0,i.Lk)("span",je,(0,de.toDisplayString)(e.status),1)])])])))),128)),a.numberOfPages>1?((0,i.uX)(),(0,i.CE)("nav",we,[(0,i.Lk)("ul",Ie,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.numberOfPages,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e,class:(0,de.normalizeClass)(l.getClasses(e))},[parseInt(e)!==parseInt(a.currentPage)?((0,i.uX)(),(0,i.CE)("a",{key:0,class:"page-link",href:"javascript:void(0)",onClick:t=>l.changePage(e)},(0,de.toDisplayString)(e),9,Re)):((0,i.uX)(),(0,i.CE)("span",Ee,(0,de.toDisplayString)(e),1))],2)))),128))])])):(0,i.Q3)("v-if",!0)])):(0,i.Q3)("v-if",!0)])],4)]),(0,i.Lk)("div",Me,[t[11]||(t[11]=(0,i.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0==a.linkModel.length,onClick:t[3]||(t[3]=(...e)=>l.saveLinks&&l.saveLinks(...e))}," Save changes ",8,Te)])])])])}]]),Oe={class:"modal fade",id:"confirmLinkDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmLinkDelete","aria-hidden":"true"},Ue={class:"modal-dialog"},qe={class:"modal-content"},xe={class:"modal-footer"},Fe={name:"ConfirmLinkDelete",emits:["update_link_results"],props:{},computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",objectLink:"getObjectLink",rootUrl:"getRootUrl"})},methods:{deleteLink(){const e=new FormData;e.set("link_id",this.objectLink.object_id),e.set("link_connection",this.objectLink.object_type===this.destination?"meta_object":this.objectLink.object_type),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_link/`,e).then((()=>{this.$emit("update_link_results",{})})),this.closeModal()},closeModal(){document.getElementById("confirmLinkDeleteButton").click()}}},Ne=(0,ee.A)(Fe,[["render",function(e,t,s,n,a,l){return(0,i.uX)(),(0,i.CE)("div",Oe,[(0,i.Lk)("div",Ue,[(0,i.Lk)("div",qe,[t[2]||(t[2]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title",id:"confirmLinkDelete"}," Please confirm Link Deletion "),(0,i.Q3)(" TASK INFORMATION "),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmLinkDeleteButton"})],-1)),t[3]||(t[3]=(0,i.Lk)("div",{class:"modal-body"}," Are you sure you want to delete the link? ",-1)),(0,i.Lk)("div",xe,[(0,i.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>l.closeModal&&l.closeModal(...e))}," No "),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>l.deleteLink&&l.deleteLink(...e))}," Yes ")])])])])}]]);var Qe=s(1390);const Ae={name:"RequirementItemLinksModule",components:{ConfirmLinkDelete:Ne,NewRequirementLinkWizard:De,SubObjectLinks:Qe.A},data:()=>({itemLinkProject:[],itemLinkTask:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{updateLinkResults(){this.axios.post(`${this.rootUrl}object_data/requirement_item/${this.locationId}/object_link_list/`).then((e=>{this.itemLinkProject=e.data.filter((e=>"project"===e.object_type)),this.itemLinkTask=e.data.filter((e=>"task"===e.object_type))})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Updating Link Results",message:`We have had issues updating link results - error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},newRequirementItemLink(){new $.aF(document.getElementById("newRequirementLinkModal")).show()}},mounted(){this.$nextTick((()=>{this.updateLinkResults()}))}},Xe=(0,ee.A)(Ae,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("sub-object-links"),r=(0,i.g2)("new-requirement-link-wizard"),d=(0,i.g2)("confirm-link-delete");return(0,i.uX)(),(0,i.CE)("div",null,[t[6]||(t[6]=(0,i.Lk)("h2",null," Requirement Item Links ",-1)),t[7]||(t[7]=(0,i.Lk)("p",{class:"text-instructions"}," The following are links for the Items to other projects/tasks. ",-1)),(0,i.Q3)(" ITEM LINKS "),a.itemLinkProject.length+a.itemLinkTask.length===0?((0,i.uX)(),(0,i.CE)("div",ne,t[5]||(t[5]=[(0,i.Lk)("div",{class:"alert alert-dark"}," Sorry - there are no Item Links. Please navigate to the Item you wish to add a link too. ",-1)]))):((0,i.uX)(),(0,i.CE)("div",ae,[(0,i.Q3)(" Project Links "),(0,i.bF)(o,{title:"Project Links","link-results":a.itemLinkProject,onUpdate_link_results:t[0]||(t[0]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Task Links "),(0,i.bF)(o,{title:"Task Links","link-results":a.itemLinkTask,onUpdate_link_results:t[1]||(t[1]=e=>l.updateLinkResults(e))},null,8,["link-results"])])),(0,i.Q3)(" Submit Button "),e.userLevel>1?((0,i.uX)(),(0,i.CE)("hr",le)):(0,i.Q3)("v-if",!0),e.userLevel>1?((0,i.uX)(),(0,i.CE)("div",oe,[(0,i.Lk)("div",re,[(0,i.Lk)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[2]||(t[2]=(...e)=>l.newRequirementItemLink&&l.newRequirementItemLink(...e))},"Create new Link")])])):(0,i.Q3)("v-if",!0),(0,i.Q3)(" LINKING MODAL "),(0,i.Q3)(" need to build something that resets the requirement links when adding links "),(0,i.bF)(r,{"location-id":e.locationId,destination:e.destination,onUpdate_module:t[3]||(t[3]=e=>l.updateLinkResults(e))},null,8,["location-id","destination"]),(0,i.Q3)(" MODAL FOR CONFIRM DELETE LINK "),(0,i.bF)(d,{onUpdate_link_results:t[4]||(t[4]=e=>l.updateLinkResults(e))})])}]]),Pe={key:0,class:"requirement-item-spacer"},Be={key:1},ze={key:2,class:"row submit-row"},We={class:"col-md-12"},Ke={key:3},He={key:4},Ve={name:"RequirementLinksModule",components:{ConfirmLinkDelete:Ne,SubObjectLinks:Qe.A,NewRequirementLinkWizard:De},data:()=>({itemLinkProject:[],itemLinkTask:[],linkProject:[],linkTask:[],linkModel:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{newRequirementLink(){new $.aF(document.getElementById("newRequirementLinkModal")).show()},updateLinkResults(){this.axios.post(`${this.rootUrl}object_data/requirement/${this.locationId}/object_link_list/`).then((e=>{this.linkProject=e.data.filter((e=>"project"===e.object_type)),this.linkTask=e.data.filter((e=>"task"===e.object_type))})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Updating Link Results",message:`We have had issues updating link results - error -> ${e}`,extra_classes:"bg-danger",delay:0})})),this.axios.post(`${this.rootUrl}requirement_information/${this.locationId}/data/item_links/`).then((e=>{this.itemLinkProject=e.data.filter((e=>"project"===e.object_type)).map((e=>({link_relationship:null,parent_link:null,object_id:e.object_id,object_title:`Item-${e.requirement_item_id} - ${e.object_title}`,object_status:e.object_status,object_type:e.object_type,reverse_relation:!1}))),this.itemLinkTask=e.data.filter((e=>"task"===e.object_type)).map((e=>({link_relationship:null,parent_link:null,object_id:e.object_id,object_title:`Item-${e.requirement_item_id} - ${e.object_title}`,object_status:e.object_status,object_type:e.object_type,reverse_relation:!1})))})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Updating Link Results",message:`We have had issues updating link results - error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.$nextTick((()=>{this.updateLinkResults()}))}},Ge=(0,ee.A)(Ve,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("sub-object-links"),r=(0,i.g2)("new-requirement-link-wizard"),d=(0,i.g2)("confirm-link-delete");return(0,i.uX)(),(0,i.CE)("div",null,[t[5]||(t[5]=(0,i.Lk)("h2",null," Requirement Links ",-1)),t[6]||(t[6]=(0,i.Lk)("p",{class:"text-instructions"}," The following are links to other projects/tasks. You can link a Requirement to these other objects to symbolise a connection between the two. ",-1)),(0,i.Q3)(" REQUIREMENT LINKS "),a.linkProject.length+a.linkTask.length===0?((0,i.uX)(),(0,i.CE)("div",Pe,t[3]||(t[3]=[(0,i.Lk)("div",{class:"alert alert-dark"}," Sorry - there are no Links for this requirement. ",-1)]))):((0,i.uX)(),(0,i.CE)("div",Be,[(0,i.Q3)(" Project Links "),(0,i.bF)(o,{title:"Project Links","link-results":a.linkProject,onUpdate_link_results:t[0]||(t[0]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Task Links "),(0,i.bF)(o,{title:"Task Links","link-results":a.linkTask,onUpdate_link_results:t[1]||(t[1]=e=>l.updateLinkResults(e))},null,8,["link-results"])])),(0,i.Q3)(" Submit Button "),e.userLevel>1?((0,i.uX)(),(0,i.CE)("div",ze,[(0,i.Lk)("div",We,[e.userLevel>1?((0,i.uX)(),(0,i.CE)("a",{key:0,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[2]||(t[2]=(...e)=>l.newRequirementLink&&l.newRequirementLink(...e))},"Create new Link")):(0,i.Q3)("v-if",!0)])])):(0,i.Q3)("v-if",!0),t[7]||(t[7]=(0,i.Lk)("hr",null,null,-1)),t[8]||(t[8]=(0,i.Lk)("h2",null," Requirement Item Links ",-1)),t[9]||(t[9]=(0,i.Lk)("p",{class:"text-instructions"}," The following are links for the Items to other projects/tasks. ",-1)),(0,i.Q3)(" ITEM LINKS "),a.itemLinkProject.length+a.itemLinkTask.length===0?((0,i.uX)(),(0,i.CE)("div",Ke,t[4]||(t[4]=[(0,i.Lk)("div",{class:"alert alert-dark"}," Sorry - there are no Item Links. Please navigate to the Item you wish to add a link too. ",-1)]))):((0,i.uX)(),(0,i.CE)("div",He,[(0,i.Q3)(" Project Links "),(0,i.bF)(o,{title:"Project Links","link-results":a.itemLinkProject,"can-delete":!1},null,8,["link-results"]),(0,i.Q3)(" Task Links "),(0,i.bF)(o,{title:"Task Links","link-results":a.itemLinkTask,"can-delete":!1},null,8,["link-results"])])),(0,i.Q3)(" LINKING MODAL "),(0,i.bF)(r,{"location-id":e.locationId,destination:"requirement",onUpdate_module:l.updateLinkResults},null,8,["location-id","onUpdate_module"]),(0,i.Q3)(" MODAL FOR CONFIRM DELETE LINK "),(0,i.bF)(d,{onUpdate_link_results:l.updateLinkResults},null,8,["onUpdate_link_results"])])}]]);var Ye=s(2806);const Je={class:"text-instructions"},Ze={key:0,class:"requirement-item-spacer"},et={key:1},tt={key:2},st={class:"row submit-row"},it={class:"col-md-12"},nt={class:"modal fade",id:"newLinkModal",tabindex:"-1","aria-labelledby":"linkModal","aria-hidden":"true"},at={class:"modal-dialog modal-lg"},lt={class:"modal-content"},ot={class:"modal-header"},rt={class:"modal-body"},dt={class:"row"},ct={class:"col-md-4"},ut={class:"text-instructions"},mt={class:"col-md-8"},pt={key:1,class:"alert alert-success"},kt={class:"row"},ht={class:"col-md-8"},bt={class:"col-md-4"},Lt={class:"text-instructions"},gt={class:"col-md-8"},vt={key:0,class:"row"},yt={class:"form-group"},_t={key:1,class:"alert alert-warning"},ft={key:2,class:"wizard-results"},St={class:"wizard-results--card--tick"},Ct=["value","id"],jt={class:"wizard-results--card--content"},wt={class:"text-instructions"},It={class:"text-instructions"},Rt={key:0,"aria-label":"Pagination for New Link Wizard"},Et={class:"pagination justify-content-center"},Mt=["onClick"],Tt={key:1,class:"page-link"},$t={class:"modal-footer"},Dt=["disabled"],Ot={name:"NewLinkWizard",components:{NSelect:K.A},emits:["update_link_results"],props:{destination:{type:String,default:""},locationId:{type:Number,default:0}},computed:{...(0,J.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},data:()=>({currentPage:1,isSearching:!1,objectModel:null,objectRelation:[{value:"relates",label:"Relates To"}],objectRelationModel:"relates",objectResults:[],objectSelection:[{value:"Project",label:"Project"},{value:"Requirement",label:"Requirement"},{value:"Requirement_Item",label:"Requirement_Item"},{value:"Task",label:"Task"}],linkModel:[],numberOfPages:1,searchModel:"",searchTimeout:"",styleHeight:"height: 90px"}),watch:{objectModel(){this.currentPage=1,this.getObjects()},searchModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),(this.searchModel.length>=3||0===this.searchModel.length)&&(this.searchTimeout=setTimeout((()=>{this.changePage(1)}),500))}},methods:{changePage(e){this.currentPage=e,this.getObjects()},getClasses(e){return parseInt(e)===this.currentPage?"page-item active":"page-item"},getObjects(){if(this.linkModel=[],this.handleRelationship(),null===this.objectModel)return void(this.isSearching=!1);const e=new FormData;e.append("array_of_objects",this.objectModel.toLowerCase()),e.set("destination_page",this.currentPage),e.set("exclude_destination",this.destination),e.set("exclude_location_id",this.locationId),e.set("search",this.searchModel),this.isSearching=!0,this.axios.post(`${this.rootUrl}search/data/`,e).then((e=>{this.objectResults=e.data[this.objectModel.toLowerCase()],this.numberOfPages=e.data[`${this.objectModel.toLowerCase()}_number_of_pages`],this.currentPage=e.data[`${this.objectModel.toLowerCase()}_current_page`],this.isSearching=!1,this.styleHeight="",this.$nextTick((()=>{const e=document.getElementById("select_links");void 0!==e&&(this.styleHeight=`height: ${e.clientHeight}px`)}))})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Searching",message:`We got an error searching. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},handleRelationship(){if("Requirement"===this.objectModel||"Requirement_Item"===this.objectModel)return this.objectRelation=[{value:"parent_object_of",label:"Is Parent Object Of"}],void(this.objectRelationModel="parent_object_of");this.objectRelation=[{value:"relates",label:"Relates To"},{value:"blocked_by",label:"Is Blocked By"},{value:"blocking",label:"Is Currently Blocking"},{value:"sub_object_of",label:"Is Sub Object Of"},{value:"parent_object_of",label:"Is Parent Object Of"},{value:"has_duplicate",label:"Has Duplicate Object Of"},{value:"duplicate_object",label:"Is Duplicate Object Of"}],this.objectRelationModel="relates"},saveLinks(){const e=new FormData;this.linkModel.forEach((t=>{e.append(`${this.objectModel.toLowerCase()}`,t)})),e.set("object_relation",this.objectRelationModel),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_link/`,e).then((()=>{this.$emit("update_link_results",{}),this.objectModel=null,document.getElementById("linkCloseButton").click(),this.styleHeight="height: 90px"}))}},mounted(){this.handleRelationship()}},Ut={name:"ObjectLinks",components:{ConfirmLinkDelete:Ne,NewLinkWizard:(0,ee.A)(Ot,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("n-select");return(0,i.uX)(),(0,i.CE)("div",nt,[(0,i.Lk)("div",at,[(0,i.Lk)("div",lt,[(0,i.Lk)("div",ot,[(0,i.Lk)("h2",null," New "+(0,de.toDisplayString)(s.destination)+" Link Wizard ",1),t[5]||(t[5]=(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"linkCloseButton"},[(0,i.Lk)("span",{"aria-hidden":"true"})],-1))]),(0,i.Lk)("div",rt,[(0,i.Q3)(" CHOOSING A OBJECT TYPE "),(0,i.Lk)("div",dt,[(0,i.Lk)("div",ct,[t[6]||(t[6]=(0,i.Lk)("strong",null,"Object Selector",-1)),(0,i.Lk)("p",ut," Please select which object you would like to link to this "+(0,de.toDisplayString)(s.destination)+". ",1)]),(0,i.Lk)("div",mt,[a.isSearching?((0,i.uX)(),(0,i.CE)("div",pt," Searching for "+(0,de.toDisplayString)(a.objectModel)+"s ",1)):((0,i.uX)(),(0,i.Wv)(o,{key:0,options:a.objectSelection,value:a.objectModel,"onUpdate:value":t[0]||(t[0]=e=>a.objectModel=e),class:"object-selection"},null,8,["options","value"]))])]),t[12]||(t[12]=(0,i.Lk)("hr",null,null,-1)),(0,i.Q3)(" CHOOSE RELATIONSHIP TYPE "),(0,i.Lk)("div",kt,[t[8]||(t[8]=(0,i.Lk)("div",{class:"col-md-4"},[(0,i.Lk)("strong",null,"Relationship"),(0,i.Lk)("p",{class:"text-instructions"},' Please select an appropriate relation for the objects. Default is "Relates" ')],-1)),(0,i.Lk)("div",ht,[t[7]||(t[7]=(0,i.Lk)("label",{for:"object-relation"},"Current object",-1)),(0,i.bF)(o,{id:"object-relation",options:a.objectRelation,value:a.objectRelationModel,"onUpdate:value":t[1]||(t[1]=e=>a.objectRelationModel=e),class:"object-selection",disabled:null===a.objectModel},null,8,["options","value","disabled"])])]),t[13]||(t[13]=(0,i.Lk)("hr",null,null,-1)),(0,i.Q3)(" SELECTING WHICH OBJECTS TO LINK TO "),(0,i.Lk)("div",{id:"select_links",class:"row",style:(0,de.normalizeStyle)(a.styleHeight)},[(0,i.Lk)("div",bt,[t[9]||(t[9]=(0,i.Lk)("strong",null,"Select Links",-1)),(0,i.Lk)("p",Lt," Please select which of the objects you want to connect to this "+(0,de.toDisplayString)(s.destination)+". ",1)]),(0,i.Lk)("div",gt,[""!==a.objectModel&&null!==a.objectModel?((0,i.uX)(),(0,i.CE)("div",vt,[(0,i.Lk)("div",yt,[t[10]||(t[10]=(0,i.Lk)("label",null,"Search",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>a.searchModel=e)},null,512),[[D.vModelText,a.searchModel]])])])):(0,i.Q3)("v-if",!0),0===a.objectResults.length&&null!=a.objectModel?((0,i.uX)(),(0,i.CE)("div",_t," Sorry - there are no results. ")):(0,i.Q3)("v-if",!0),!a.isSearching&&a.objectResults.length>0&&null!=a.objectModel?((0,i.uX)(),(0,i.CE)("div",ft,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.objectResults,(e=>((0,i.uX)(),(0,i.CE)("div",{class:"wizard-results--card",key:e.id},[(0,i.Lk)("div",St,[(0,i.bo)((0,i.Lk)("input",{class:"form-check-input",type:"checkbox",name:"link-option",value:e.id,id:`checkbox_${a.objectModel.toLowerCase()}_${e.pk}`,"onUpdate:modelValue":t[3]||(t[3]=e=>a.linkModel=e)},null,8,Ct),[[D.vModelCheckbox,a.linkModel]])]),(0,i.Lk)("div",jt,[(0,i.Lk)("div",wt,(0,de.toDisplayString)(a.objectModel)+" "+(0,de.toDisplayString)(e.id),1),(0,i.Lk)("div",null,[(0,i.Lk)("strong",null,(0,de.toDisplayString)(e.title),1)]),(0,i.Lk)("div",null,[t[11]||(t[11]=(0,i.eW)(" Status: ")),(0,i.Lk)("span",It,(0,de.toDisplayString)(e.status),1)])])])))),128)),a.numberOfPages>1?((0,i.uX)(),(0,i.CE)("nav",Rt,[(0,i.Lk)("ul",Et,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.numberOfPages,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e,class:(0,de.normalizeClass)(l.getClasses(e))},[parseInt(e)!==parseInt(a.currentPage)?((0,i.uX)(),(0,i.CE)("a",{key:0,class:"page-link",href:"javascript:void(0)",onClick:t=>l.changePage(e)},(0,de.toDisplayString)(e),9,Mt)):((0,i.uX)(),(0,i.CE)("span",Tt,(0,de.toDisplayString)(e),1))],2)))),128))])])):(0,i.Q3)("v-if",!0)])):(0,i.Q3)("v-if",!0)])],4)]),(0,i.Lk)("div",$t,[t[14]||(t[14]=(0,i.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0===a.linkModel.length,onClick:t[4]||(t[4]=(...e)=>l.saveLinks&&l.saveLinks(...e))}," Save changes ",8,Dt)])])])])}]]),SubObjectLinks:Qe.A},data:()=>({hasDuplicateObjectOf:[],isBlockedBy:[],isCurrentlyBlocking:[],isDuplicateObjectOf:[],isParentOf:[],isSubObjectOf:[],kanbanCard:[],linkResults:[],relatesTo:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{isLinkedObject(e){let t=!1;return null!==e.fields.project&&(t=!0),null!==e.fields.task&&(t=!0),null!==e.fields.requirement&&(t=!0),t},newLink(){new $.aF(document.getElementById("newLinkModal")).show()},updateLinkResults(){this.linkResults=[],this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/object_link_list/`).then((e=>{this.linkResults=e.data,this.relatesTo=e.data.filter((e=>"Relate"===e.link_relationship||null===e.link_relationship)),this.isBlockedBy=e.data.filter((e=>{const t="Block"===e.link_relationship&&e.parent_link!==this.destination&&!1===e.reverse_relation,s="Block"===e.link_relationship&&e.parent_link===this.destination&&!0===e.reverse_relation;return t||s})),this.kanbanCard=e.data.filter((e=>"Card"===e.link_relationship)),this.isCurrentlyBlocking=e.data.filter((e=>{const t="Block"===e.link_relationship&&e.parent_link===this.destination&&!1===e.reverse_relation,s="Block"===e.link_relationship&&e.parent_link!==this.destination&&!0===e.reverse_relation;return t||s})),this.isSubObjectOf=e.data.filter((e=>{const t="Subobject"===e.link_relationship&&e.parent_link!==this.destination&&!1===e.reverse_relation,s="Subobject"===e.link_relationship&&e.parent_link===this.destination&&!0===e.reverse_relation;return t||s})),this.isParentOf=e.data.filter((e=>{const t="Subobject"===e.link_relationship&&e.parent_link===this.destination&&!1===e.reverse_relation,s="Subobject"===e.link_relationship&&e.parent_link!==this.destination&&!0===e.reverse_relation;return t||s})),this.hasDuplicateObjectOf=e.data.filter((e=>{const t="Duplicate"===e.link_relationship&&e.parent_link===this.destination&&!1===e.reverse_relation,s="Duplicate"===e.link_relationship&&e.parent_link!==this.destination&&!0===e.reverse_relation;return t||s})),this.isDuplicateObjectOf=e.data.filter((e=>{const t="Duplicate"===e.link_relationship&&e.parent_link!==this.destination&&!1===e.reverse_relation,s="Duplicate"===e.link_relationship&&e.parent_link===this.destination&&!0===e.reverse_relation;return t||s}))})).catch((e=>{this.$store.dispatch("newToast",{heading:"Object Links failed to get data",message:`Failed to get data - Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.$nextTick((()=>{this.updateLinkResults()}))}},qt=(0,ee.A)(Ut,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("sub-object-links"),r=(0,i.g2)("new-link-wizard"),d=(0,i.g2)("confirm-link-delete");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("h2",null,(0,de.toDisplayString)(e.destination)+" Links ",1),(0,i.Lk)("p",Je," The following are links to other objects like projects/tasks/requirements. You can link a "+(0,de.toDisplayString)(e.destination)+" to these other objects to symbolise a connection between the two. ",1),(0,i.Q3)(" OBJECT LINKS "),0===a.linkResults.length?((0,i.uX)(),(0,i.CE)("div",Ze,t[8]||(t[8]=[(0,i.Lk)("div",{class:"alert alert-dark"}," Sorry - there are no Links for this requirement. ",-1)]))):((0,i.uX)(),(0,i.CE)("div",et,[(0,i.Q3)(" Relates To "),(0,i.bF)(o,{title:"Relates To","link-results":a.relatesTo,onUpdate_link_results:t[0]||(t[0]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Kanban Cards "),(0,i.bF)(o,{title:"Kanban Cards","link-results":a.kanbanCard,"can-delete":!1},null,8,["link-results"]),(0,i.Q3)(" Is Blocked By "),(0,i.bF)(o,{title:"Is Blocked By","link-results":a.isBlockedBy,onUpdate_link_results:t[1]||(t[1]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Is Currently Blocking "),(0,i.bF)(o,{title:"Is Currently Blocking","link-results":a.isCurrentlyBlocking,onUpdate_link_results:t[2]||(t[2]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Is Sub Object Of "),(0,i.bF)(o,{title:"Is Subobject Of","link-results":a.isSubObjectOf,onUpdate_link_results:t[3]||(t[3]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Is Parent Object Of "),(0,i.bF)(o,{title:"Is Parent Object Of","link-results":a.isParentOf,onUpdate_link_results:t[4]||(t[4]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Has Duplicate Object Of "),(0,i.bF)(o,{title:"Has Duplicate Object Of","link-results":a.hasDuplicateObjectOf,onUpdate_link_results:t[5]||(t[5]=e=>l.updateLinkResults(e))},null,8,["link-results"]),(0,i.Q3)(" Is Duplicate Object Of "),(0,i.bF)(o,{title:"Is Duplicate Object Of","link-results":a.isDuplicateObjectOf,onUpdate_link_results:t[6]||(t[6]=e=>l.updateLinkResults(e))},null,8,["link-results"])])),(0,i.Q3)(" Submit Button "),e.userLevel>1?((0,i.uX)(),(0,i.CE)("hr",tt)):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",st,[(0,i.Lk)("div",it,[e.userLevel>1?((0,i.uX)(),(0,i.CE)("a",{key:0,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[7]||(t[7]=(...e)=>l.newLink&&l.newLink(...e))},"Create new Link")):(0,i.Q3)("v-if",!0)])]),(0,i.Q3)(" MODAL FOR NEW OBJECT LINKS "),(0,i.bF)(r,{destination:e.destination,"location-id":e.locationId,onUpdate_link_results:l.updateLinkResults},null,8,["destination","location-id","onUpdate_link_results"]),(0,i.Q3)(" MODAL FOR CONFIRM DELETE LINK "),(0,i.bF)(d,{onUpdate_link_results:l.updateLinkResults},null,8,["onUpdate_link_results"])])}]]),xt={class:"text-instructions"},Ft={key:0},Nt={key:1},Qt={class:"row submit-row"},At={class:"col-md-12"};var Xt=s(3233);const Pt={class:"modal fade",id:"addCustomerModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Bt={class:"modal-dialog modal-lg"},zt={class:"modal-content"},Wt={class:"modal-body"},Kt={key:0,class:"row"},Ht={class:"col-md-4"},Vt={class:"text-instructions"},Gt={class:"col-md-8"},Yt={key:1,class:"row"},Jt={class:"col-md-6 no-search"},Zt=["src"],es={class:"modal-footer"},ts=["diabled"],ss={name:"AddCustomerWizard",components:{NSelect:K.A},emits:["update_customer_results"],props:{destination:{type:String,default:""},locationId:{type:Number,default:0},excludeCustomers:{type:Array,default:()=>[]}},computed:{...(0,J.L8)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},data:()=>({customerModel:"",customerList:[],customerFixList:[]}),methods:{addCustomer(){const e=new FormData;e.set("customer",this.customerModel),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_customer/`,e).then((e=>{this.$emit("update_customer_results",e.data),this.customerModel="",document.getElementById("addCustomerCloseButton").click()})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Adding Customer",message:`We had an issue adding customers. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},getCustomerList(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/customer_list_all/`).then((e=>{this.customerList=e.data,this.updateCustomerFixList()})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Customer List",message:`We had an issue getting customer list. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},updateCustomerFixList(){if(0===this.customerList.length)return;const e=[];this.excludeCustomers.forEach((t=>{e.push(t.pk)})),this.customerFixList=this.customerList.filter((t=>!e.includes(t.pk))).map((e=>({value:e.pk,label:`${e.fields.customer_first_name} ${e.fields.customer_last_name}`})))}},mounted(){!["requirement_item"].indexOf(this.locationId)<0||this.$nextTick((()=>{this.getCustomerList()}))},watch:{excludeCustomers(){this.updateCustomerFixList()}}},is={name:"CustomersModule",components:{AddCustomerWizard:(0,ee.A)(ss,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("n-select");return(0,i.uX)(),(0,i.CE)("div",Pt,[(0,i.Lk)("div",Bt,[(0,i.Lk)("div",zt,[t[5]||(t[5]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h2",null," Add Customers Wizard "),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addCustomerCloseButton"},[(0,i.Lk)("span",{"aria-hidden":"true"})])],-1)),(0,i.Lk)("div",Wt,[a.customerFixList.length>0?((0,i.uX)(),(0,i.CE)("div",Kt,[(0,i.Lk)("div",Ht,[t[2]||(t[2]=(0,i.Lk)("strong",null,"Select Customer",-1)),(0,i.Lk)("p",Vt," Search for a customer who has not been added to this "+(0,de.toDisplayString)(s.destination)+". If the search is blank there are either no customers that match that search, or all customer have already been added to the "+(0,de.toDisplayString)(s.destination)+". ",1)]),(0,i.Lk)("div",Gt,[(0,i.bF)(o,{options:a.customerFixList,label:"customerName",value:a.customerModel,"onUpdate:value":t[0]||(t[0]=e=>a.customerModel=e)},null,8,["options","value"])])])):((0,i.uX)(),(0,i.CE)("div",Yt,[t[3]||(t[3]=(0,i.Lk)("div",{class:"col-md-6"},[(0,i.Lk)("strong",null,"Sorry - no results"),(0,i.Lk)("p",{class:"text-instructions"}," This could be because "),(0,i.Lk)("ul",{class:"text-instructions"},[(0,i.Lk)("li",null,"There are no more customers left to add"),(0,i.Lk)("li",null," There are no customers for this organisation ")])],-1)),(0,i.Lk)("div",Jt,[(0,i.Lk)("img",{src:`${e.staticUrl}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,Zt)])]))]),(0,i.Lk)("div",es,[t[4]||(t[4]=(0,i.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",diabled:""==a.customerModel,onClick:t[1]||(t[1]=(...e)=>l.addCustomer&&l.addCustomer(...e))}," Save changes ",8,ts)])])])])}]]),CustomersListModule:Xt.A},data:()=>({customerResults:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",userLevel:"getUserLevel",rootUrl:"getRootUrl"})},methods:{addNewCustomer(){new $.aF(document.getElementById("addCustomerModal")).show()},loadCustomerResults(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/customer_list/`).then((e=>{this.customerResults=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Loading Customer Results",message:`We had an issue loading customer results. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},removeCustomer(e){this.customerResults=this.customerResults.filter((t=>t.pk!==e))},updateCustomerResults(e){this.customerResults=e}},mounted(){["requirement_item"].indexOf(this.destination)>=0||this.$nextTick((()=>{this.loadCustomerResults()}))}},ns=(0,ee.A)(is,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("customers-list-module"),r=(0,i.g2)("add-customer-wizard");return(0,i.uX)(),(0,i.CE)("div",null,[t[4]||(t[4]=(0,i.Lk)("h2",null," Customers ",-1)),(0,i.Lk)("p",xt," Below are a list of customers who are stakeholders to this "+(0,de.toDisplayString)(e.destination)+". ",1),(0,i.Q3)(" CUSTOMER RESULTS CARDS "),0==a.customerResults.length?((0,i.uX)(),(0,i.CE)("div",Ft,t[3]||(t[3]=[(0,i.Lk)("div",{class:"customers-module-spacer"},[(0,i.Lk)("div",{class:"alert alert-dark"}," Sorry - there are no customers. Please add them by clicking on the button below ")],-1)]))):((0,i.uX)(),(0,i.CE)("div",Nt,[(0,i.bF)(o,{"customer-results":a.customerResults,onRemove_customer:t[0]||(t[0]=e=>l.removeCustomer(e))},null,8,["customer-results"])])),(0,i.Q3)(" ADD CUSTOMER BUTTON "),t[5]||(t[5]=(0,i.Lk)("hr",null,null,-1)),(0,i.Lk)("div",Qt,[(0,i.Lk)("div",At,[e.userLevel>1?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"btn btn-primary save-changes",onClick:t[1]||(t[1]=(...e)=>l.addNewCustomer&&l.addNewCustomer(...e))}," Add Customer ")):(0,i.Q3)("v-if",!0)])]),(0,i.Q3)(" MODALS "),(0,i.bF)(r,{"location-id":e.locationId,destination:e.destination,"exclude-customers":a.customerResults,onUpdate_customer_results:t[2]||(t[2]=e=>l.updateCustomerResults(e))},null,8,["location-id","destination","exclude-customers"])])}]]);var as=s(1367),ls=s(384),os=s(9142);const rs={name:"MiscModule",components:{AddTagWizard:as.A,ListPublicLinks:ls.A,ListTagsModule:os.A},computed:{...(0,J.L8)({destination:"getDestination"})}},ds=(0,ee.A)(rs,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("list-tags-module"),r=(0,i.g2)("add-tag-wizard"),d=(0,i.g2)("list-public-links");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(o),(0,i.bF)(r),t[0]||(t[0]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(d)],64)}]]);var cs=s(5738),us=s(1614),ms=s(6191),ps=s(310),ks=s(7954),hs=s(9981);const bs={key:0},Ls={key:0,class:"alert alert-info"},gs={key:1,class:"row submit-row"},vs={class:"col-md-12"},ys={key:2,class:"mt-4"},_s={class:"modal fade",id:"createNewSprintModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"createNewSprint","aria-hidden":"true"},fs={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},Ss={class:"modal-content"},Cs={class:"modal-body"},js={class:"row"},ws={class:"col-md-8"},Is={class:"form-group"},Rs={class:"row"},Es={class:"col-md-6"},Ms={class:"form-group"},Ts={class:"col-md-6"},$s={class:"form-group"},Ds={class:"modal-footer"},Os={name:"NewSprintWizard",components:{NDatePicker:s(3728).A},props:{sprintResultsLength:{type:Number,default:0}},computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},data:()=>({sprintEndDate:0,sprintNameModel:"",sprintStartDate:0}),watch:{sprintResultsLength(){this.updateSprintNameModel()}},methods:{closeModal(){document.getElementById("createNewSprintButton").click()},createNewSprint(){this.$store.dispatch("newToast",{header:"Creating New Toast",message:"Please wait - we are creating the new toast. It will automatically navigate you to the new sprint information page",extra_classes:"bg-warning text-dark",delay:0,unique_type:"create_sprint"});const e=new Date(this.sprintStartDate),t=new Date(this.sprintEndDate),s=new FormData;s.set("sprint_name",this.sprintNameModel),s.set("sprint_start_date",e.toISOString()),s.set("sprint_end_date",t.toISOString()),this.axios.post(`${this.rootUrl}new_sprint/${this.destination}/${this.locationId}/save/`,s).then((e=>{window.location=`${this.rootUrl}sprint_information/${e.data.id}/`})).catch((e=>{this.$store.dispatch("newToast",{header:"Error creating new sprint",message:`Could not create new sprint. Error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"create_sprint"})}))},updateSprintNameModel(){const e=this.sprintResultsLength+1,t=(new Date).toLocaleDateString("en-au",{year:"numeric",month:"short",day:"numeric"});this.sprintNameModel=`${this.destination}-${this.locationId} - Sprint ${e} - ${t}`}},mounted(){this.sprintStartDate=(new Date).getTime(),this.sprintEndDate=this.sprintStartDate+6048e5,this.$nextTick((()=>{this.updateSprintNameModel()}))}},Us=(0,ee.A)(Os,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("n-date-picker");return(0,i.uX)(),(0,i.CE)("div",_s,[(0,i.Lk)("div",fs,[(0,i.Lk)("div",Ss,[t[10]||(t[10]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title"}," Please confirm Link Deletion "),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"createNewSprintButton"})],-1)),(0,i.Lk)("div",Cs,[(0,i.Lk)("div",js,[t[9]||(t[9]=(0,i.Lk)("div",{class:"col-md-4"},[(0,i.Lk)("strong",null,"Sprint Information"),(0,i.Lk)("p",{class:"text-instructions"}," Please use an appropriate name, start date, and finish date. ")],-1)),(0,i.Lk)("div",ws,[(0,i.Lk)("div",Is,[t[5]||(t[5]=(0,i.Lk)("label",null,"Sprint Name",-1)),(0,i.bo)((0,i.Lk)("input",{class:"form-control",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.sprintNameModel=e)},null,512),[[D.vModelText,a.sprintNameModel]])]),t[8]||(t[8]=(0,i.Lk)("div",{class:"spacer"},null,-1)),(0,i.Lk)("div",Rs,[(0,i.Lk)("div",Es,[(0,i.Lk)("div",Ms,[t[6]||(t[6]=(0,i.Lk)("label",null,"Start Date",-1)),(0,i.bF)(o,{value:a.sprintStartDate,"onUpdate:value":t[1]||(t[1]=e=>a.sprintStartDate=e),type:"date"},null,8,["value"])])]),(0,i.Lk)("div",Ts,[(0,i.Lk)("div",$s,[t[7]||(t[7]=(0,i.Lk)("label",null,"End Date",-1)),(0,i.bF)(o,{value:a.sprintEndDate,"onUpdate:value":t[2]||(t[2]=e=>a.sprintEndDate=e),type:"date"},null,8,["value"])])])])])])]),(0,i.Lk)("div",Ds,[(0,i.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[3]||(t[3]=(...e)=>l.closeModal&&l.closeModal(...e))}," Cancel "),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=(...e)=>l.createNewSprint&&l.createNewSprint(...e))}," Create New Sprint ")])])])])}]]),qs={class:"col-md-10 object-link--details"},xs=["href"],Fs={class:"object-link--link"},Ns={class:"object-link--title"},Qs={class:"object-link--link"},As={class:"object-link--link"},Xs={class:"col-md-2 object-link--status"},Ps={key:0,class:"object-link--remove"};var Bs=s(3980),zs=s(6285),Ws=s(953);const Ks={name:"RenderSprintCard",components:{CarbonTrashCan:Bs.dA},props:{canDelete:{type:Boolean,default:!0},sprintResults:{type:Array,default:()=>[]}},computed:{...(0,J.L8)({rootUrl:"getRootUrl",userLevel:"getUserLevel"})},emits:["confirm_remove_sprint"],methods:{useNiceDate:function(e){const t=(0,Ws.BA)(e);return""===t||null==t?"":zs.c9.fromISO(t).toLocaleString(zs.c9.DATE_MED_WITH_WEEKDAY)},confirmRemoveSprintFunction(e){this.$emit("confirm_remove_sprint",e)}}},Hs=(0,ee.A)(Ks,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("carbon-trash-can");return(0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.sprintResults,(n=>((0,i.uX)(),(0,i.CE)("div",{key:n.sprint_id,class:"row object-link"},[(0,i.Q3)(" Sprint ID + Sprint Name "),(0,i.Lk)("div",qs,[(0,i.Lk)("a",{href:`${this.rootUrl}sprint_information/${n.sprint_id}/`,target:"_blank",rel:"noopener noreferrer"},[(0,i.Lk)("div",Fs,"Sprint- "+(0,de.toDisplayString)(n.sprint_id),1),(0,i.Lk)("div",Ns,(0,de.toDisplayString)(n.sprint_name),1),(0,i.Lk)("div",Qs," Story Point Progression: "+(0,de.toDisplayString)(n.completed_story_points)+" out of "+(0,de.toDisplayString)(n.total_story_points),1),(0,i.Lk)("div",As," Dates: "+(0,de.toDisplayString)(l.useNiceDate(n.sprint_start_date))+" till "+(0,de.toDisplayString)(l.useNiceDate(n.sprint_end_date)),1)],8,xs)]),(0,i.Q3)(" Sprint Status "),(0,i.Lk)("div",Xs,[t[0]||(t[0]=(0,i.Lk)("span",null,"Sprint Status: ",-1)),(0,i.Lk)("span",null,(0,de.toDisplayString)(n.sprint_status),1)]),(0,i.Q3)(" Object Delete "),e.userLevel>=2&&!0===s.canDelete?((0,i.uX)(),(0,i.CE)("div",Ps,[(0,i.bF)(o,{onClick:e=>l.confirmRemoveSprintFunction(n)},null,8,["onClick"])])):(0,i.Q3)("v-if",!0)])))),128)}]]),Vs={name:"ChildSprints",components:{RenderSprintCard:Hs,NewSprintWizard:Us},data:()=>({allowedObjects:["project","requirement"],sprintResults:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{closeModal(){document.getElementById("createNewSprintButton").click()},getSprints(){const e=`${this.rootUrl}object_data/${this.destination}/${this.locationId}/sprint_list/child/`;this.axios.post(e).then((e=>{this.sprintResults=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Sprint List",message:`Sorry, could not get child sprints. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},openCreateModal(){new $.aF(document.getElementById("createNewSprintModal")).show()}},mounted(){this.$nextTick((()=>{this.allowedObjects.includes(this.destination)&&this.getSprints()}))}},Gs=(0,ee.A)(Vs,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("render-sprint-card"),r=(0,i.g2)("new-sprint-wizard");return(0,i.uX)(),(0,i.CE)(i.FK,null,[t[1]||(t[1]=(0,i.Lk)("h2",null,"List Sprints",-1)),t[2]||(t[2]=(0,i.Lk)("p",{class:"text-instructions"}," Lists out all the sprints associated with this particular object. ",-1)),a.allowedObjects.includes(e.destination)?((0,i.uX)(),(0,i.CE)("div",bs,[0===a.sprintResults.length?((0,i.uX)(),(0,i.CE)("div",Ls," Currently there are no current sprints. ")):(0,i.Q3)("v-if",!0),(0,i.Q3)(" CURRENT SPRINTS"),(0,i.bF)(o,{"sprint-results":a.sprintResults,"can-delete":!1},null,8,["sprint-results"]),(0,i.Q3)(" BUTTONS"),e.userLevel>=2?((0,i.uX)(),(0,i.CE)("div",gs,[(0,i.Lk)("div",vs,[(0,i.Lk)("button",{class:"btn btn-primary save-changes",onClick:t[0]||(t[0]=(...e)=>l.openCreateModal&&l.openCreateModal(...e))}," Create New Sprint ")])])):(0,i.Q3)("v-if",!0),"project"===e.destination?((0,i.uX)(),(0,i.CE)("hr",ys)):(0,i.Q3)("v-if",!0)])):(0,i.Q3)("v-if",!0),a.allowedObjects.includes(e.destination)?((0,i.uX)(),(0,i.Wv)(r,{key:1,"sprint-results-length":a.sprintResults.length},null,8,["sprint-results-length"])):(0,i.Q3)("v-if",!0)],64)}]]),Ys={key:0},Js={key:1},Zs={key:2,class:"alert alert-info"},ei={class:"row submit-row"},ti={class:"col-md-12"},si={class:"modal fade",id:"addSprintWizardModal",tabindex:"-1","aria-labelledby":"addSprintWizard","aria-hidden":"true"},ii={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},ni={class:"modal-content"},ai={class:"modal-body"},li={class:"row"},oi={class:"col-md-8"},ri={class:"form-group"},di={class:"col-md-12 mb-4"},ci={class:"modal-footer"},ui=["disabled"];var mi=s(246);const pi={name:"AddSprintWizard",components:{NSelect:K.A},emits:["update_sprint_list"],data:()=>({selectedSprintObject:{},sprintModel:void 0,sprintOptions:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},watch:{sprintModel(e){this.selectedSprintObject=this.sprintOptions.filter((t=>parseInt(t.value)===parseInt(e)))}},methods:{useNiceDatetime:mi.y,addSprint(){this.$store.dispatch("newToast",{header:"Adding object to sprint",message:"Adding current object to sprint, please wait.",extra_classes:"bg-warning text-dark",delay:0,unique_type:"add_sprint_wizard"});const e=new FormData;e.set("sprint_id",this.sprintModel),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_sprint/${this.sprintModel}/`,e).then((e=>{this.$emit("update_sprint_list",e.data),document.getElementById("addSprintWizardButton").click(),this.$store.dispatch("newToast",{header:"Added to Sprint",message:"Successfully added current object to Sprint",extra_classes:"bg-success",unique_type:"add_sprint_wizard"})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error adding current object to sprint",message:`Error adding the current object to sprint. Error -> ${e}`,extra_classes:"bg-danger",delay:0,unique_type:"add_sprint_wizard"})}))},getSprintOptions(){this.axios.post(`${this.rootUrl}object_data/sprint_list/`).then((e=>{this.sprintOptions=e.data.map((e=>({value:e.sprint_id,label:e.sprint_name,sprint_start_date:e.sprint_start_date,sprint_end_date:e.sprint_end_date})))})).catch((e=>{this.$store.dispatch("newToast",{header:"Error fetching Potential Sprint List",message:`Can not retrieve sprint list. ${e}`,extra_classes:"bg-warning text-dark",delay:0})}))}},mounted(){this.$nextTick((()=>{this.getSprintOptions()}))}},ki=(0,ee.A)(pi,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("n-select");return(0,i.uX)(),(0,i.CE)("div",si,[(0,i.Lk)("div",ii,[(0,i.Lk)("div",ni,[t[9]||(t[9]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title",id:"addSprintWizard"},"Add Object to Sprint"),(0,i.Lk)("button",{id:"addSprintWizardButton",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,i.Lk)("div",ai,[(0,i.Lk)("div",li,[t[7]||(t[7]=(0,i.Lk)("div",{class:"col-md-4"},[(0,i.Lk)("strong",null,"Sprint Wizard"),(0,i.Lk)("p",{class:"text-instructions"}," Please select the appropriate sprint to add this current object too. ")],-1)),(0,i.Lk)("div",oi,[(0,i.Lk)("div",ri,[t[2]||(t[2]=(0,i.Lk)("label",null,"Sprint",-1)),(0,i.bF)(o,{value:a.sprintModel,"onUpdate:value":t[0]||(t[0]=e=>a.sprintModel=e),options:a.sprintOptions,filterable:"",placeholder:"Please select a sprint from the list"},null,8,["value","options"])]),t[6]||(t[6]=(0,i.Lk)("div",{class:"spacer"},null,-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.selectedSprintObject,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.value,class:"row"},[(0,i.Lk)("div",di,[t[3]||(t[3]=(0,i.Lk)("strong",null,"Sprint Name: ",-1)),(0,i.eW)((0,de.toDisplayString)(e.label),1),t[4]||(t[4]=(0,i.Lk)("br",null,null,-1)),t[5]||(t[5]=(0,i.Lk)("strong",null,"Sprint Start Date: ",-1)),(0,i.eW)((0,de.toDisplayString)(l.useNiceDatetime(e.sprint_start_date)),1)])])))),128))])])]),(0,i.Lk)("div",ci,[t[8]||(t[8]=(0,i.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,i.Lk)("button",{disabled:void 0===a.sprintModel,onClick:t[1]||(t[1]=(...e)=>l.addSprint&&l.addSprint(...e)),type:"button",class:"btn btn-primary"}," Add to Sprint ",8,ui)])])])])}]]),hi={class:"modal fade",id:"confirmSprintRemoveModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmSprintRemoveLabel","aria-hidden":"true"},bi={class:"modal-dialog"},Li={class:"modal-content"},gi={class:"modal-footer"},vi={name:"ConfirmRemoveSprint",emits:["update_sprint_list"],props:{confirmRemoveSprint:{type:Object,default:()=>({sprint_name:"",sprint_id:0})}},computed:{...(0,J.L8)({destination:"getDestination",documentRemoveKey:"getDocumentRemoveKey",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{removeSprint(){const e=this.confirmRemoveSprint.sprint_id,t=new FormData;t.set("sprint_id",e),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_sprint/${e}/`,t).then((e=>{this.$emit("update_sprint_list",e.data),document.getElementById("confirmSprintRemovalButton").click()})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Removing Sprint",message:`Sorry, we could not remove the sprint from the current object. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},closeModal(){document.getElementById("confirmSprintRemovalButton").click()}}},yi={name:"AssignedSprints",components:{ConfirmRemoveSprint:(0,ee.A)(vi,[["render",function(e,t,s,n,a,l){return(0,i.uX)(),(0,i.CE)("div",hi,[(0,i.Lk)("div",bi,[(0,i.Lk)("div",Li,[t[2]||(t[2]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title",id:"confirmSprintRemoveLabel"}," Please confirm the sprint removal "),(0,i.Q3)(" TASK INFORMATION "),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmSprintRemovalButton"})],-1)),t[3]||(t[3]=(0,i.Lk)("div",{class:"modal-body"}," Are you sure you want to remove the sprint from the current object. ",-1)),(0,i.Lk)("div",gi,[(0,i.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>l.closeModal&&l.closeModal(...e))}," No "),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>l.removeSprint&&l.removeSprint(...e))}," Yes ")])])])])}]]),RenderSprintCard:Hs,AddSprintWizard:ki},data:()=>({allowedObjects:["requirement_item","project","task"],confirmRemoveSprint:{sprint_id:0,sprint_name:""},currentImportVariables:{header:"List of Current Sprints",prefix:"sprint",id:"sprint_id",title:"sprint_name",status:"sprint_status"},currentSprints:[],finishedImportVariables:{header:"List of Finished Sprints",prefix:"sprint",id:"sprint_id",title:"sprint_name",status:"sprint_status"},finishedSprints:[]}),computed:{...(0,J.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{addToSprint(){new $.aF(document.getElementById("addSprintWizardModal")).show()},confirmRemoveSprintFunction(e){this.confirmRemoveSprint=e,new $.aF(document.getElementById("confirmSprintRemoveModal")).show()},getAssignedSprints(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/sprint_list/assigned/`).then((e=>{this.updateSprintList(e.data)})).catch((e=>{this.$store.dispatch("newToast",{headers:"Error fetching assigned sprints",message:`Could not get the data. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))},updateSprintList(e){this.currentSprints=e.filter((e=>"Finished"!==e.sprint_status)),this.finishedSprints=e.filter((e=>"Finished"===e.sprint_status))}},mounted(){this.$nextTick((()=>{this.allowedObjects.includes(this.destination)&&this.getAssignedSprints()}))}},_i={name:"ListSprints",components:{AssignedSprints:(0,ee.A)(yi,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("render-sprint-card"),r=(0,i.g2)("add-sprint-wizard"),d=(0,i.g2)("confirm-remove-sprint");return(0,i.uX)(),(0,i.CE)(i.FK,null,[t[5]||(t[5]=(0,i.Lk)("h2",null,"AssignedSprints",-1)),t[6]||(t[6]=(0,i.Lk)("p",{class:"text-instructions"}," Lists all sprints that contains this object. ",-1)),a.currentSprints.length>0?((0,i.uX)(),(0,i.CE)("h3",Ys," Current ")):(0,i.Q3)("v-if",!0),(0,i.bF)(o,{"sprint-results":a.currentSprints,onConfirm_remove_sprint:t[0]||(t[0]=e=>l.confirmRemoveSprintFunction(e))},null,8,["sprint-results"]),a.finishedSprints.length>0?((0,i.uX)(),(0,i.CE)("h3",Js," Finished ")):(0,i.Q3)("v-if",!0),(0,i.bF)(o,{"sprint-results":a.finishedSprints,onConfirm_remove_sprint:t[1]||(t[1]=e=>l.confirmRemoveSprintFunction(e))},null,8,["sprint-results"]),a.currentSprints.length+a.finishedSprints.length===0?((0,i.uX)(),(0,i.CE)("div",Zs," Currently this object has not been assigned to any sprints. ")):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",ei,[(0,i.Lk)("div",ti,[e.userLevel>=2?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"btn btn-primary save-changes",onClick:t[2]||(t[2]=(...e)=>l.addToSprint&&l.addToSprint(...e))}," Add Object To Sprint ")):(0,i.Q3)("v-if",!0)])]),(0,i.bF)(r,{onUpdate_sprint_list:t[3]||(t[3]=e=>l.updateSprintList(e))}),(0,i.bF)(d,{"confirm-remove-sprint":a.confirmRemoveSprint,onUpdate_sprint_list:t[4]||(t[4]=e=>l.updateSprintList(e))},null,8,["confirm-remove-sprint"])],64)}]]),ChildSprints:Gs},data:()=>({assignedSprintAllowedDestination:["requirement_item","project","task"],childSprintsAllowedDestination:["requirement","project"]}),computed:{...(0,J.L8)({destination:"getDestination"})}},fi=(0,ee.A)(_i,[["render",function(e,t,s,n,a,l){const o=(0,i.g2)("child-sprints"),r=(0,i.g2)("assigned-sprints");return(0,i.uX)(),(0,i.CE)(i.FK,null,[a.childSprintsAllowedDestination.includes(e.destination)?((0,i.uX)(),(0,i.Wv)(o,{key:0})):(0,i.Q3)("v-if",!0),a.assignedSprintAllowedDestination.includes(e.destination)?((0,i.uX)(),(0,i.Wv)(r,{key:1})):(0,i.Q3)("v-if",!0)],64)}]]);var Si=s(2899),Ci=s(2787),ji=s(6434),wi=s(9581),Ii=s(4077);const Ri={name:"ParentModules",components:{DeleteObject:s(4325).A,ConfirmPublicLinkDelete:Ii.A,ConfirmNoteDelete:ji.A,AddFolderWizard:hs.A,ConfirmFileDeleteVue:ps.A,AddLinkWizard:ms.A,ConfirmFolderDelete:ks.A,CustomersModule:ns,DocumentsModule:Ye.A,EditHistoryNoteWizard:Si.A,GroupsAndUsersModule:w.A,ListSprints:fi,NewHistoryNoteWizard:Ci.A,NotesModule:cs.A,ObjectLinks:qt,RequirementItemLinksModule:Xe,RequirementItemsModule:ie,RequirementLinksModule:Ge,UploadDocumentWizard:us.A,MiscModule:ds},props:{destination:{type:String,default:""},isReadOnly:{type:Boolean,default:!1},locationId:{type:Number,default:0},rootUrl:{type:String,default:"/"},staticUrl:{type:String,default:"/"},theme:{type:String,default:""},userExtraPermissions:{type:Array,default:()=>[]},userLevel:{type:Number,default:0}},data:()=>({}),methods:{useNBTheme:wi.p},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateDestination",destination:this.destination,locationId:this.locationId}),this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.isReadOnly?this.$store.commit({type:"updateUserLevel",userLevel:1}):(this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.$store.commit({type:"updateUserExtraPermissions",userExtraPermissions:this.userExtraPermissions}))}},Ei=(0,ee.A)(Ri,[["render",function(e,t,s,w,I,R){const E=(0,i.g2)("groups-and-users-module"),M=(0,i.g2)("requirement-items-module"),T=(0,i.g2)("requirement-links-module"),$=(0,i.g2)("requirement-item-links-module"),D=(0,i.g2)("documents-module"),O=(0,i.g2)("upload-document-wizard"),U=(0,i.g2)("add-folder-wizard"),q=(0,i.g2)("add-link-wizard"),x=(0,i.g2)("confirm-file-delete-vue"),F=(0,i.g2)("confirm-folder-delete"),N=(0,i.g2)("object-links"),Q=(0,i.g2)("customers-module"),A=(0,i.g2)("list-sprints"),X=(0,i.g2)("misc-module"),P=(0,i.g2)("confirm-public-link-delete"),B=(0,i.g2)("notes-module"),z=(0,i.g2)("edit-history-note-wizard"),W=(0,i.g2)("new-history-note-wizard"),K=(0,i.g2)("confirm-note-delete"),H=(0,i.g2)("delete-object"),V=(0,i.g2)("n-config-provider");return(0,i.uX)(),(0,i.Wv)(V,{theme:R.useNBTheme(s.theme)},{default:(0,i.k6)((()=>[(0,i.Lk)("div",n,[(0,i.Lk)("div",a,[(0,i.Lk)("ul",l,[(0,i.Q3)(" GROUPS AND USERS "),(0,i.Q3)(" Don't need to show to requirement items - as permissions are gained from parent requirement "),"requirement_item"!==s.destination?((0,i.uX)(),(0,i.CE)("li",o,t[0]||(t[0]=[(0,i.Lk)("button",{class:"nav-link active",id:"group-and-user-tab","data-bs-toggle":"tab","data-bs-target":"#group-and-users",type:"button",role:"tab","aria-controls":"home","aria-selected":"true"}," Groups and Users ",-1)]))):(0,i.Q3)("v-if",!0),(0,i.Q3)(" REQUIREMENT ITEMS "),"requirement"===s.destination?((0,i.uX)(),(0,i.CE)("li",r,t[1]||(t[1]=[(0,i.Lk)("button",{class:"nav-link",id:"requirement-item-tab","data-bs-toggle":"tab","data-bs-target":"#requirement-items",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Requirement Item ",-1)]))):(0,i.Q3)("v-if",!0),(0,i.Q3)(" REQUIREMENT LINKS "),"requirement"===s.destination?((0,i.uX)(),(0,i.CE)("li",d,t[2]||(t[2]=[(0,i.Lk)("button",{class:"nav-link",id:"requirement-link-tab","data-bs-toggle":"tab","data-bs-target":"#requirement-links",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Requirement Links ",-1)]))):(0,i.Q3)("v-if",!0),(0,i.Q3)(" REQUIREMENT ITEM LINKS "),"requirement_item"===s.destination?((0,i.uX)(),(0,i.CE)("li",c,t[3]||(t[3]=[(0,i.Lk)("button",{class:"nav-link",id:"requirement-item-link-tab","data-bs-toggle":"tab","data-bs-target":"#requirement-item-links",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Links ",-1)]))):(0,i.Q3)("v-if",!0),(0,i.Q3)(" DOCUMENTS "),t[7]||(t[7]=(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link",id:"documents-tab","data-bs-toggle":"tab","data-bs-target":"#documents",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Documents ")],-1)),(0,i.Q3)(" LINKED OBJECTS "),"requirement"!==s.destination&&"requirement_item"!==s.destination?((0,i.uX)(),(0,i.CE)("li",u,t[4]||(t[4]=[(0,i.Lk)("button",{class:"nav-link",id:"object-link-tabs","data-bs-toggle":"tab","data-bs-target":"#object-links",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Linked Objects ",-1)]))):(0,i.Q3)("v-if",!0),(0,i.Q3)(" CUSTOMERS "),(0,i.Q3)(" Customers are not needed by requirement items as the parent requirements take care of this "),"requirement_item"!==s.destination?((0,i.uX)(),(0,i.CE)("li",m,t[5]||(t[5]=[(0,i.Lk)("button",{class:"nav-link",id:"customer-tab","data-bs-toggle":"tab","data-bs-target":"#customers",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Customers ",-1)]))):(0,i.Q3)("v-if",!0),(0,i.Q3)(" SPRINTS "),t[8]||(t[8]=(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link",id:"sprints-tab","data-bs-toggle":"tab","data-bs-target":"#sprints",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Sprints ")],-1)),(0,i.Q3)(" MISC "),t[9]||(t[9]=(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link",id:"misc-tab","data-bs-toggle":"tab","data-bs-target":"#misc",type:"button",role:"tab","aria-controls":"home","aria-selected":"false"}," Misc ")],-1)),(0,i.Q3)(" Notes "),t[10]||(t[10]=(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link",id:"notes-tab","data-bs-toggle":"tab","data-bs-target":"#notes",type:"button",role:"tab","aria-controls":"home","aria-select":"false"}," Notes ")],-1)),(0,i.Q3)(" ADMIN "),4===s.userLevel?((0,i.uX)(),(0,i.CE)("li",p,t[6]||(t[6]=[(0,i.Lk)("button",{class:"nav-link",id:"admin-tab","data-bs-toggle":"tab","data-bs-target":"#admin",type:"button",role:"tab","aria-controls":"home","aria-select":"false"}," Admin ",-1)]))):(0,i.Q3)("v-if",!0)]),t[11]||(t[11]=(0,i.Lk)("hr",null,null,-1)),(0,i.Lk)("div",k,["requirement_item"!==s.destination?((0,i.uX)(),(0,i.CE)("div",h,[(0,i.bF)(E)])):(0,i.Q3)("v-if",!0),"requirement"===s.destination?((0,i.uX)(),(0,i.CE)("div",b,[(0,i.bF)(M)])):(0,i.Q3)("v-if",!0),"requirement"===s.destination?((0,i.uX)(),(0,i.CE)("div",L,[(0,i.bF)(T)])):"requirement_item"===s.destination?((0,i.uX)(),(0,i.CE)("div",g,[(0,i.bF)($)])):(0,i.Q3)("v-if",!0),(0,i.Lk)("div",v,[(0,i.bF)(D),(0,i.bF)(O),(0,i.bF)(U,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,i.bF)(q,{destination:s.destination,"location-id":s.locationId},null,8,["destination","location-id"]),(0,i.bF)(x),(0,i.bF)(F)]),(0,i.Lk)("div",y,[(0,i.bF)(N)]),(0,i.Lk)("div",_,[(0,i.bF)(Q)]),(0,i.Lk)("div",f,[(0,i.bF)(A)]),(0,i.Lk)("div",S,[(0,i.bF)(X),(0,i.bF)(P)]),(0,i.Lk)("div",C,[(0,i.bF)(B),(0,i.Q3)(" Modals for Notes section "),(0,i.bF)(z),(0,i.bF)(W,{"location-id":s.locationId,destination:s.destination},null,8,["location-id","destination"]),(0,i.bF)(K)]),4===s.userLevel?((0,i.uX)(),(0,i.CE)("div",j,[(0,i.bF)(H)])):(0,i.Q3)("v-if",!0)])])])])),_:1},8,["theme"])}]])}}]);