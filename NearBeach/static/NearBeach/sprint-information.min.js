"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1154],{246:(t,e,s)=>{s.d(e,{y:()=>n});var a=s(6285),i=s(953);function n(t){const e=(0,i.BA)(t);return""===e||null==e?"":a.c9.fromISO(e).toLocaleString(a.c9.DATETIME_MED)}},3781:(t,e,s)=>{function a(t,e){return 0===e?[]:e<=7?Array.from({length:e},((t,e)=>({destinationPage:e+1,text:`${e+1}`}))):t<=4?[{destinationPage:1,text:"1"},{destinationPage:2,text:"2"},{destinationPage:3,text:"3"},{destinationPage:4,text:"4"},{destinationPage:5,text:"5"},{destinationPage:6,text:">"},{destinationPage:e,text:">>"}]:t>e-4?[{destinationPage:1,text:"<<"},{destinationPage:e-5,text:"<"},{destinationPage:e-4,text:""+(e-4)},{destinationPage:e-3,text:""+(e-3)},{destinationPage:e-2,text:""+(e-2)},{destinationPage:e-1,text:""+(e-1)},{destinationPage:e,text:`${e}`}]:[{destinationPage:1,text:"<<"},{destinationPage:t-2,text:"<"},{destinationPage:t-1,text:""+(t-1)},{destinationPage:t,text:`${t}`},{destinationPage:t+1,text:`${t+1}`},{destinationPage:t+2,text:">"},{destinationPage:e,text:">>"}]}s.d(e,{k:()=>a})},6528:(t,e,s)=>{s.r(e),s.d(e,{default:()=>it});var a=s(641),i=s(33);const n={class:"sprint-header"},o={class:"dropdown"},r={class:"dropdown-menu"},l=["href"],d={key:0},c={key:1},p={key:2},u={key:3},h={key:4},b=["href"],g={key:5},m={class:"modal fade",id:"confirmSprintDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmSprintDelete","aria-hidden":"true"},k={class:"modal-dialog"},f={class:"modal-content"},y={class:"modal-footer"};var L=s(2124);const j={name:"confirmSprintDelete",props:{parentObjectLocationId:{type:Number,default:0},parentObjectDestination:{type:String,default:""}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{deleteSprint(){this.$store.dispatch("newToast",{header:"Deleting Sprint",message:"Please wait, whilst we delete the sprint",extra_classes:"bg-warning text-dark",delay:0,unique_type:"delete_sprint"}),this.axios.post(`${this.rootUrl}sprint_information/${this.locationId}/delete/`).then((()=>{window.location=`${this.rootUrl}${this.parentObjectDestination}_information/${this.parentObjectLocationId}/`})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Deleting Sprint",message:`Sorry, could not delete the sprint. Error -> ${t}`,extra_classes:"bg-warning text-dark",delay:0,unique_type:"delete_sprint"})}))},closeModal(){document.getElementById("confirmSprintDeleteButton").click()}}};var v=s(6262);const S=(0,v.A)(j,[["render",function(t,e,s,i,n,o){return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",k,[(0,a.Lk)("div",f,[e[2]||(e[2]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"confirmSprintDelete"}," Please confirm Sprint Deletion "),(0,a.Q3)(" TASK INFORMATION "),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmSprintDeleteButton"})],-1)),e[3]||(e[3]=(0,a.Lk)("div",{class:"modal-body"}," Are you sure you want to delete the sprint? ",-1)),(0,a.Lk)("div",y,[(0,a.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>o.closeModal&&o.closeModal(...t))}," No "),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>o.deleteSprint&&o.deleteSprint(...t))}," Yes ")])])])])}]]);var w=s(3751);const _={class:"modal fade",id:"addObjectWizardModal",tabindex:"-1","aria-labelledby":"addObjectWizardLabel","aria-hidden":"true"},O={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},x={class:"modal-content"},P={class:"modal-body"},C={class:"row"},$={class:"col-md-8"},M={class:"row"},D={key:0,class:"alert alert-info"},E={key:1,class:"row"},I={class:"col-12"},z={key:2,class:"wizard-results"},T={key:3,class:"wizard-results"},A={class:"wizard-results--card--tick"},R=["value","id"],U={class:"wizard-results--card--content"},X={class:"text-instructions"},W={class:"text-instructions"},F={class:"row"},B={class:"col-md-8"},Q={key:0,"aria-label":"Pagination for New Link Sprint Wizard"},N={class:"pagination justify-content-center"},q=["onClick"],H={key:1,class:"page-link"},K={class:"modal-footer"};var G=s(1080),V=s(6285),J=s(3781);const Y={name:"AddObjectWizard",components:{NSelect:G.A},data:()=>({currentPage:1,linkModel:[],objectModel:"",objectOptions:[{value:"project",label:"Project"},{value:"requirement_item",label:"Requirement Item"},{value:"task",label:"Task"}],objectResults:[],searchModel:"",searchStatus:"",searchTimeout:"",setOfPages:[],styleHeight:""}),watch:{objectModel(t){this.linkModel=[],this.setOfPages=[],this.getObjectList(t,1)},searchModel(){""!==this.searchTimeout&&clearTimeout(this.searchTimeout),(this.searchModel.length>=3||0===this.searchModel.length)&&(this.styleHeight=`height: ${this.$refs.wizardResults.offsetHeight}px`,this.searchTimeout=setTimeout((()=>{this.getObjectList(this.objectModel,1)}),500))}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{addObjects(){this.$store.dispatch("newToast",{header:"Adding objects to Sprint",message:"Currently adding object to sprint. Please wait",extra_classes:"bg-warning text-dark",delay:0,unique_type:"add_objects_to_sprint"});const t=new FormData;t.set("object_type",this.objectModel),this.linkModel.forEach((e=>{t.append("object_id",e)})),this.axios.post(`${this.rootUrl}api/v0/sprint/${this.locationId}/link/`,t).then((t=>{const e=t.data.map((t=>{const e=V.c9.fromISO(t.end_date),s=V.c9.fromISO(t.start_date);return t.end_date=e.toMillis(),t.start_date=s.toMillis(),t}));this.$store.commit({type:"updateGanttChartData",ganttChartData:e}),this.$store.dispatch("newToast",{header:"Added Objects to Sprint",message:"Objects successfully added to Sprint",extra_classes:"bg-success",unique_type:"add_objects_to_sprint",delay:600}),document.getElementById("addObjectWizardButton").click()})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Adding Objects to Sprint",message:`Sorry - we came across an issue adding objects to the sprint. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"add_objects_to_sprint"})}))},changePage(t){this.styleHeight=`height: ${this.$refs.wizardResults.offsetHeight}px`,this.getObjectList(this.objectModel,t)},getClasses(t){return parseInt(t)===this.currentPage?"page-item active":"page-item"},getObjectList(t,e){this.searchStatus="currently_searching",this.objectResults=[];const s=new FormData;s.set("object_lookup",t),s.set("destination_page",e),s.set("search",this.searchModel),this.axios.post(`${this.rootUrl}sprint_information/${this.locationId}/potential_object_list/`,s).then((t=>{this.objectResults=t.data[this.objectModel.toLowerCase()],this.numberOfPages=t.data[`${this.objectModel.toLowerCase()}_number_of_pages`],this.currentPage=t.data[`${this.objectModel.toLowerCase()}_current_page`],this.setOfPages=(0,J.k)(this.currentPage,this.numberOfPages),this.styleHeight="",this.searchStatus="search_completed"})).catch((t=>{this.$store.dispatch("newToast",{header:"Error getting potential object list",message:`Sorry, we could not get a list of potential objects. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}}},Z=(0,v.A)(Y,[["render",function(t,e,s,n,o,r){const l=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",_,[(0,a.Lk)("div",O,[(0,a.Lk)("div",x,[e[12]||(e[12]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"addObjectWizardLabel"}," Add Objects to Sprint Wizard "),(0,a.Lk)("button",{id:"addObjectWizardButton",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,a.Lk)("div",P,[(0,a.Q3)(" OBJECT SELECTOR"),(0,a.Lk)("div",C,[e[4]||(e[4]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Object Selector"),(0,a.Lk)("p",{class:"text-instructions"}," Please select which object you would like to link to this task. ")],-1)),(0,a.Lk)("div",$,[(0,a.bF)(l,{filterable:"",placeholder:"Please select an object",value:o.objectModel,"onUpdate:value":e[0]||(e[0]=t=>o.objectModel=t),options:o.objectOptions,disabled:"currently_searching"===o.searchStatus},null,8,["value","options","disabled"])])]),e[10]||(e[10]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",M,[e[8]||(e[8]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Select Links"),(0,a.Lk)("p",{class:"text-instructions"}," Please select which of the objects you want to connect to this sprint. ")],-1)),(0,a.Lk)("div",{class:"col-md-8",style:(0,i.normalizeStyle)(o.styleHeight),ref:"wizardResults"},[""===o.objectModel?((0,a.uX)(),(0,a.CE)("div",D," Please select an object. ")):(0,a.Q3)("v-if",!0),""!==o.objectModel?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("div",I,[e[5]||(e[5]=(0,a.Lk)("label",{class:"form-label"},"Search Terms",-1)),(0,a.bo)((0,a.Lk)("input",{id:"search_terms",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>o.searchModel=t),type:"text"},null,512),[[w.vModelText,o.searchModel]])])])):(0,a.Q3)("v-if",!0),"currently_searching"===o.searchStatus?((0,a.uX)(),(0,a.CE)("div",z,e[6]||(e[6]=[(0,a.Fv)('<div class="wizard-results--card"><div class="wizard-results--card--tick"></div><div class="wizard-results--card--content"><span class="placeholder col-1"></span><br><span class="placeholder col-11"></span><span class="placeholder col-8"></span></div></div>',1)]))):(0,a.Q3)("v-if",!0),o.objectResults.length>0&&null!=o.objectModel?((0,a.uX)(),(0,a.CE)("div",T,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.objectResults,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"wizard-results--card",key:t.id},[(0,a.Lk)("div",A,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox",name:"link-option",value:t.id,id:`checkbox_${o.objectModel.toLowerCase()}_${t.pk}`,"onUpdate:modelValue":e[2]||(e[2]=t=>o.linkModel=t)},null,8,R),[[w.vModelCheckbox,o.linkModel]])]),(0,a.Lk)("div",U,[(0,a.Lk)("div",X,(0,i.toDisplayString)(o.objectModel)+" "+(0,i.toDisplayString)(t.id),1),(0,a.Lk)("div",null,[(0,a.Lk)("strong",null,(0,i.toDisplayString)(t.description),1)]),(0,a.Lk)("div",null,[e[7]||(e[7]=(0,a.eW)(" Status: ")),(0,a.Lk)("span",W,(0,i.toDisplayString)(t.status),1)])])])))),128))])):(0,a.Q3)("v-if",!0)],4)]),(0,a.Lk)("div",F,[e[9]||(e[9]=(0,a.Lk)("div",{class:"col-md-4"},null,-1)),(0,a.Lk)("div",B,[o.setOfPages.length>=1?((0,a.uX)(),(0,a.CE)("nav",Q,[(0,a.Lk)("ul",N,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.setOfPages,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t.destinationPage,class:(0,i.normalizeClass)(r.getClasses(t.destinationPage))},[parseInt(t.destinationPage)!==parseInt(o.currentPage)?((0,a.uX)(),(0,a.CE)("a",{key:0,class:"page-link",href:"javascript:void(0)",onClick:e=>r.changePage(t.destinationPage)},(0,i.toDisplayString)(t.text),9,q)):((0,a.uX)(),(0,a.CE)("span",H,(0,i.toDisplayString)(t.text),1))],2)))),128))])])):(0,a.Q3)("v-if",!0)])])]),(0,a.Lk)("div",K,[e[11]||(e[11]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[3]||(e[3]=(...t)=>r.addObjects&&r.addObjects(...t))}," Add Objects ")])])])])}]]);var tt=s(246),et=s(9581),st=s(9336);const at={name:"SprintInformation",components:{AddObjectWizard:Z,ConfirmSprintDelete:S},props:{rootUrl:{type:String,default:"/"},sprintResults:{type:Array,default:()=>[]},theme:{type:String,default:""},userLevel:{type:Number,default:1}},data(){return{parentObjectDestination:"",parentObjectLocationId:0,sprintId:this.sprintResults[0].sprint_id,sprintStatus:this.sprintResults[0].sprint_status}},methods:{useNBTheme:et.p,useNiceDatetime:tt.y,confirmDeleteSprint(){new st.aF(document.getElementById("confirmSprintDeleteModal")).show()},finishSprint(){this.axios.post(`${this.rootUrl}sprint_information/${this.sprintResults[0].sprint_id}/finish_sprint/`).then((()=>{window.location.reload()})).catch((t=>{this.$store.dispatch("newToast",{header:"Can not start sprint",message:`Sorry, there was an error starting the sprint. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))},getParentUrl(){return`${this.rootUrl}${this.parentObjectDestination}_information/${this.parentObjectLocationId}`},showAddObjectWizard(){new st.aF(document.getElementById("addObjectWizardModal")).show()},startSprint(){this.axios.post(`${this.rootUrl}sprint_information/${this.sprintResults[0].sprint_id}/start_sprint/`).then((()=>{window.location.reload()})).catch((t=>{this.$store.dispatch("newToast",{header:"Can not start sprint",message:`Sorry, there was an error starting the sprint. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl}),this.$store.commit({type:"updateDestination",destination:"sprint",locationId:this.sprintResults[0].sprint_id}),this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.$store.commit({type:"updateTitle",title:this.sprintResults[0].sprint_name});const t=this.sprintResults[0].project,e=this.sprintResults[0].requirement_id;null!=t&&""!==t?(this.parentObjectLocationId=t,this.parentObjectDestination="project"):null!=e&&""!==e&&(this.parentObjectLocationId=e,this.parentObjectDestination="requirement")}},it=(0,v.A)(at,[["render",function(t,e,s,m,k,f){const y=(0,a.g2)("confirm-sprint-delete"),L=(0,a.g2)("add-object-wizard"),j=(0,a.g2)("n-config-provider");return(0,a.uX)(),(0,a.Wv)(j,{theme:f.useNBTheme(s.theme)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,[(0,a.Lk)("h1",null,(0,i.toDisplayString)(s.sprintResults[0].sprint_name),1),e[7]||(e[7]=(0,a.Lk)("strong",null,"Sprint Status:",-1)),(0,a.eW)(" "+(0,i.toDisplayString)(k.sprintStatus)+" ",1),(0,a.Lk)("div",o,[e[6]||(e[6]=(0,a.Lk)("button",{class:"btn btn-secondary btn-sm dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Sprint Menu ",-1)),(0,a.Lk)("ul",r,[(0,a.Lk)("li",null,[(0,a.Lk)("a",{class:"dropdown-item",href:f.getParentUrl()}," Go to Parent Object ",8,l)]),s.userLevel>=2&&"Finished"!==k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",d,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[0]||(e[0]=(...t)=>f.showAddObjectWizard&&f.showAddObjectWizard(...t))}," Add Object Wizard ")])):(0,a.Q3)("v-if",!0),s.userLevel>=2&&("Draft"===k.sprintStatus||"Current"===k.sprintStatus)?((0,a.uX)(),(0,a.CE)("li",c,e[4]||(e[4]=[(0,a.Lk)("hr",{class:"dropdown-divider"},null,-1)]))):(0,a.Q3)("v-if",!0),s.userLevel>=2&&"Draft"===k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",p,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=(...t)=>f.startSprint&&f.startSprint(...t))}," Start Sprint ")])):(0,a.Q3)("v-if",!0),s.userLevel>=2&&"Current"===k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",u,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=(...t)=>f.finishSprint&&f.finishSprint(...t))}," Finish Sprint ")])):(0,a.Q3)("v-if",!0),s.userLevel>=2?((0,a.uX)(),(0,a.CE)("li",h,[e[5]||(e[5]=(0,a.Lk)("hr",{class:"dropdown-divider"},null,-1)),(0,a.Lk)("a",{class:"dropdown-item",href:`${this.rootUrl}sprint_information/${this.sprintId}/edit/`},"Edit Sprint",8,b)])):(0,a.Q3)("v-if",!0),s.userLevel>=2&&"Finished"!==k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",g,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[3]||(e[3]=(...t)=>f.confirmDeleteSprint&&f.confirmDeleteSprint(...t))}," Delete Sprint ")])):(0,a.Q3)("v-if",!0)])])]),(0,a.bF)(y,{"parent-object-destination":k.parentObjectDestination,"parent-object-location-id":k.parentObjectLocationId},null,8,["parent-object-destination","parent-object-location-id"]),(0,a.bF)(L)])),_:1},8,["theme"])}]])},9581:(t,e,s)=>{s.d(e,{p:()=>n});var a=s(953),i=s(166);function n(t){return"dark"===(0,a.BA)(t)?i.a:null}}}]);