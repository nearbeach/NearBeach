"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1154],{7055:(t,e,s)=>{s.r(e),s.d(e,{default:()=>V});var a=s(641),i=s(33);const n={class:"sprint-header"},r={class:"dropdown"},o={class:"dropdown-menu"},l=["href"],d={key:0},c={key:1},p={key:2},u={key:3},h={key:4},b={key:5},m={class:"modal fade",id:"confirmSprintDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmSprintDelete","aria-hidden":"true"},k={class:"modal-dialog"},g={class:"modal-content"},y={class:"modal-footer"};var L=s(2124);const f={name:"confirmSprintDelete",props:{parentObjectLocationId:{type:Number,default:0},parentObjectDestination:{type:String,default:""}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{deleteSprint(){this.$store.dispatch("newToast",{header:"Deleting Sprint",message:"Please wait, whilst we delete the sprint",extra_classes:"bg-warning text-dark",delay:0,unique_type:"delete_sprint"}),this.axios.post(`${this.rootUrl}sprint_information/${this.locationId}/delete/`).then((()=>{window.location=`${this.rootUrl}${this.parentObjectDestination}_information/${this.parentObjectLocationId}/`})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Deleting Sprint",message:`Sorry, could not delete the sprint. Error -> ${t}`,extra_classes:"bg-warning text-dark",delay:0,unique_type:"delete_sprint"})}))},closeModal(){document.getElementById("confirmSprintDeleteButton").click()}}};var j=s(6262);const S=(0,j.A)(f,[["render",function(t,e,s,i,n,r){return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",k,[(0,a.Lk)("div",g,[e[2]||(e[2]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"confirmSprintDelete"}," Please confirm Sprint Deletion "),(0,a.Q3)(" TASK INFORMATION "),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmSprintDeleteButton"})],-1)),e[3]||(e[3]=(0,a.Lk)("div",{class:"modal-body"}," Are you sure you want to delete the sprint? ",-1)),(0,a.Lk)("div",y,[(0,a.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>r.closeModal&&r.closeModal(...t))}," No "),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>r.deleteSprint&&r.deleteSprint(...t))}," Yes ")])])])])}]]);var v=s(3751);const w={class:"modal fade",id:"addObjectWizardModal",tabindex:"-1","aria-labelledby":"addObjectWizardLabel","aria-hidden":"true"},_={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},O={class:"modal-content"},C={class:"modal-body"},D={class:"row"},$={class:"col-md-8"},E={class:"row"},M={class:"col-md-8"},I={key:0,class:"alert alert-info"},x={key:1,class:"alert alert-warning mb-4"},A={key:2,class:"wizard-results"},U={class:"wizard-results--card--tick"},R=["value","id"],T={class:"wizard-results--card--content"},z={class:"text-instructions"},W={class:"text-instructions"},X={key:3,class:"alert alert-info"},B={class:"modal-footer"};var F=s(1080),Q=s(6285);const P={name:"AddObjectWizard",components:{NSelect:F.A},data:()=>({linkModel:[],objectModel:"",objectOptions:[{value:"project",label:"Project"},{value:"requirement_item",label:"Requirement Item"},{value:"task",label:"Task"}],searchResults:[],searchStatus:""}),watch:{objectModel(t){this.linkModel=[],this.getObjectList(t)}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{addObjects(){this.$store.dispatch("newToast",{header:"Adding objects to Sprint",message:"Currently adding object to sprint. Please wait",extra_classes:"bg-warning text-dark",delay:0,unique_type:"add_objects_to_sprint"});const t=new FormData;this.linkModel.forEach((e=>{t.append(`${this.objectModel.toLowerCase()}`,e)})),this.axios.post(`${this.rootUrl}object_data/sprint/${this.locationId}/add_object_to_sprint/`,t).then((t=>{const e=t.data.gantt_chart_data.map((t=>{const e=Q.c9.fromISO(t.end_date),s=Q.c9.fromISO(t.start_date);return t.end_date=e.toMillis(),t.start_date=s.toMillis(),t}));this.$store.commit({type:"updateGanttChartData",ganttChartData:e}),this.$store.dispatch("newToast",{header:"Added Objects to Sprint",message:"Objects successfully added to Sprint",extra_classes:"bg-success",unique_type:"add_objects_to_sprint",delay:600}),document.getElementById("addObjectWizardButton").click()})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Adding Objects to Sprint",message:`Sorry - we came across an issue adding objects to the sprint. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"add_objects_to_sprint"})}))},getObjectList(t){this.searchStatus="currently_searching",this.axios.post(`${this.rootUrl}object_data/sprint/${this.locationId}/${t}/potential_object_list/`).then((t=>{this.searchResults=t.data,this.searchStatus="search_completed"})).catch((t=>{this.$store.dispatch("newToast",{header:"Error getting potential object list",message:`Sorry, we could not get a list of potential objects. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}}},q=(0,j.A)(P,[["render",function(t,e,s,n,r,o){const l=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",w,[(0,a.Lk)("div",_,[(0,a.Lk)("div",O,[e[8]||(e[8]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"addObjectWizardLabel"}," Add Objects to Sprint Wizard "),(0,a.Lk)("button",{id:"addObjectWizardButton",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,a.Lk)("div",C,[(0,a.Q3)(" OBJECT SELECTOR"),(0,a.Lk)("div",D,[e[3]||(e[3]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Object Selector"),(0,a.Lk)("p",{class:"text-instructions"}," Please select which object you would like to link to this task. ")],-1)),(0,a.Lk)("div",$,[(0,a.bF)(l,{filterable:"",placeholder:"Please select an object",value:r.objectModel,"onUpdate:value":e[0]||(e[0]=t=>r.objectModel=t),options:r.objectOptions,disabled:"currently_searching"===r.searchStatus},null,8,["value","options","disabled"])])]),e[6]||(e[6]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",E,[e[5]||(e[5]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Select Links"),(0,a.Lk)("p",{class:"text-instructions"}," Please select which of the objects you want to connect to this sprint. ")],-1)),(0,a.Lk)("div",M,[""===r.objectModel?((0,a.uX)(),(0,a.CE)("div",I," Please select an object. ")):(0,a.Q3)("v-if",!0),"currently_searching"===r.searchStatus?((0,a.uX)(),(0,a.CE)("div",x," Currently searching for potential objects... ")):(0,a.Q3)("v-if",!0),r.searchResults.length>0&&null!=r.objectModel?((0,a.uX)(),(0,a.CE)("div",A,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.searchResults,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"wizard-results--card",key:t.id},[(0,a.Lk)("div",U,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox",name:"link-option",value:t.id,id:`checkbox_${r.objectModel.toLowerCase()}_${t.pk}`,"onUpdate:modelValue":e[1]||(e[1]=t=>r.linkModel=t)},null,8,R),[[v.vModelCheckbox,r.linkModel]])]),(0,a.Lk)("div",T,[(0,a.Lk)("div",z,(0,i.toDisplayString)(r.objectModel)+" "+(0,i.toDisplayString)(t.id),1),(0,a.Lk)("div",null,[(0,a.Lk)("strong",null,(0,i.toDisplayString)(t.description),1)]),(0,a.Lk)("div",null,[e[4]||(e[4]=(0,a.eW)(" Status: ")),(0,a.Lk)("span",W,(0,i.toDisplayString)(t.status),1)])])])))),128))])):(0,a.Q3)("v-if",!0),0===r.searchResults.length&&null!=r.objectModel?((0,a.uX)(),(0,a.CE)("div",X," Sorry, could not find any applicable "+(0,i.toDisplayString)(r.objectModel)+"s ",1)):(0,a.Q3)("v-if",!0)])])]),(0,a.Lk)("div",B,[e[7]||(e[7]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=(...t)=>o.addObjects&&o.addObjects(...t))}," Add Objects ")])])])])}]]);var N=s(246),G=s(9581),K=s(9336);const J={name:"SprintInformation",components:{AddObjectWizard:q,ConfirmSprintDelete:S},props:{rootUrl:{type:String,default:"/"},sprintResults:{type:Array,default:()=>[]},theme:{type:String,default:""},userLevel:{type:Number,default:1}},data(){return{parentObjectDestination:"",parentObjectLocationId:0,sprintStatus:this.sprintResults[0].sprint_status}},methods:{useNBTheme:G.p,useNiceDatetime:N.y,confirmDeleteSprint(){new K.aF(document.getElementById("confirmSprintDeleteModal")).show()},finishSprint(){this.axios.post(`${this.rootUrl}sprint_information/${this.sprintResults[0].sprint_id}/finish_sprint/`).then((()=>{window.location.reload()})).catch((t=>{this.$store.dispatch("newToast",{header:"Can not start sprint",message:`Sorry, there was an error starting the sprint. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))},getParentUrl(){return`${this.rootUrl}${this.parentObjectDestination}_information/${this.parentObjectLocationId}`},showAddObjectWizard(){new K.aF(document.getElementById("addObjectWizardModal")).show()},startSprint(){this.axios.post(`${this.rootUrl}sprint_information/${this.sprintResults[0].sprint_id}/start_sprint/`).then((()=>{window.location.reload()})).catch((t=>{this.$store.dispatch("newToast",{header:"Can not start sprint",message:`Sorry, there was an error starting the sprint. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl}),this.$store.commit({type:"updateDestination",destination:"sprint",locationId:this.sprintResults[0].sprint_id}),this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.$store.commit({type:"updateTitle",title:this.sprintResults[0].sprint_name});const t=this.sprintResults[0].project,e=this.sprintResults[0].requirement_id;null!=t&&""!==t?(this.parentObjectLocationId=t,this.parentObjectDestination="project"):null!=e&&""!==e&&(this.parentObjectLocationId=e,this.parentObjectDestination="requirement")}},V=(0,j.A)(J,[["render",function(t,e,s,m,k,g){const y=(0,a.g2)("confirm-sprint-delete"),L=(0,a.g2)("add-object-wizard"),f=(0,a.g2)("n-config-provider");return(0,a.uX)(),(0,a.Wv)(f,{theme:g.useNBTheme(s.theme)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,[(0,a.Lk)("h1",null,(0,i.toDisplayString)(s.sprintResults[0].sprint_name),1),e[7]||(e[7]=(0,a.Lk)("strong",null,"Sprint Status:",-1)),(0,a.eW)(" "+(0,i.toDisplayString)(k.sprintStatus)+" ",1),(0,a.Lk)("div",r,[e[6]||(e[6]=(0,a.Lk)("button",{class:"btn btn-secondary btn-sm dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Sprint Menu ",-1)),(0,a.Lk)("ul",o,[(0,a.Lk)("li",null,[(0,a.Lk)("a",{class:"dropdown-item",href:g.getParentUrl()}," Go to Parent Object ",8,l)]),s.userLevel>=2&&"Finished"!==k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",d,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[0]||(e[0]=(...t)=>g.showAddObjectWizard&&g.showAddObjectWizard(...t))}," Add Object Wizard ")])):(0,a.Q3)("v-if",!0),s.userLevel>=2&&("Draft"===k.sprintStatus||"Current"===k.sprintStatus)?((0,a.uX)(),(0,a.CE)("li",c,e[4]||(e[4]=[(0,a.Lk)("hr",{class:"dropdown-divider"},null,-1)]))):(0,a.Q3)("v-if",!0),s.userLevel>=2&&"Draft"===k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",p,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=(...t)=>g.startSprint&&g.startSprint(...t))}," Start Sprint ")])):(0,a.Q3)("v-if",!0),s.userLevel>=2&&"Current"===k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",u,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=(...t)=>g.finishSprint&&g.finishSprint(...t))}," Finish Sprint ")])):(0,a.Q3)("v-if",!0),s.userLevel>=2&&"Finished"!==k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",h,e[5]||(e[5]=[(0,a.Lk)("hr",{class:"dropdown-divider"},null,-1)]))):(0,a.Q3)("v-if",!0),s.userLevel>=2&&"Finished"!==k.sprintStatus?((0,a.uX)(),(0,a.CE)("li",b,[(0,a.Lk)("a",{class:"dropdown-item",href:"#",onClick:e[3]||(e[3]=(...t)=>g.confirmDeleteSprint&&g.confirmDeleteSprint(...t))}," Delete Sprint ")])):(0,a.Q3)("v-if",!0)])])]),(0,a.bF)(y,{"parent-object-destination":k.parentObjectDestination,"parent-object-location-id":k.parentObjectLocationId},null,8,["parent-object-destination","parent-object-location-id"]),(0,a.bF)(L)])),_:1},8,["theme"])}]])},246:(t,e,s)=>{s.d(e,{y:()=>n});var a=s(6285),i=s(953);function n(t){const e=(0,i.BA)(t);return""===e||null==e?"":a.c9.fromISO(e).toLocaleString(a.c9.DATETIME_MED)}},9581:(t,e,s)=>{s.d(e,{p:()=>n});var a=s(953),i=s(166);function n(t){return"dark"===(0,a.BA)(t)?i.a:null}}}]);