"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[6792],{5145:(t,s,e)=>{e.r(s),e.d(s,{default:()=>ct});var a=e(641),l=e(33);const o={class:"card"},d={class:"card-body"},i=(0,a.Lk)("br",null,null,-1),u=["href"],r=(0,a.Lk)("hr",null,null,-1),n={class:"row"},c=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Editing Status"),(0,a.Lk)("p",{class:"text-instructions"}," Move the status' around to reorder them. Double click to edit text and settings. ")],-1),h={class:"col-md-8"},p=(0,a.Lk)("strong",null,"Status List",-1),m={key:0,class:"error"},g=(0,a.Lk)("br",null,null,-1),S=["data-id"],b=["data-id"],k=["data-id"],_=["onClick"],L=(0,a.Lk)("div",{class:"spacer"},null,-1);var y=e(432),v=e.n(y),w=e(9336);const f={class:"modal fade",id:"confirmStatusDeleteModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},C={class:"modal-dialog"},M={class:"modal-content"},I=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title"},"Confirm Deletion"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmStatusDeleteModalClose"})],-1),D={class:"modal-body"},O=(0,a.Lk)("div",{class:"alert alert-warning"},[(0,a.Lk)("h4",null,"WARNING"),(0,a.Lk)("p",null," This process can not be reversed. Deleting a status will remove it completely. "),(0,a.Lk)("p",null," All objects connected with this status will have to migrate to a new status. This is also permanent and can not be reversed. ")],-1),x={class:"row"},$=(0,a.Lk)("strong",null,"Status: ",-1),E=(0,a.Lk)("strong",null,"Higher Order Status: ",-1),j=(0,a.Lk)("div",{class:"spacer"},null,-1),N={class:"row"},T=(0,a.Lk)("p",null,"Please select an appropriate status to migrate too.",-1),U=(0,a.Lk)("label",null,[(0,a.Lk)("strong",null,"New Status for the objects")],-1),A=(0,a.Lk)("br",null,null,-1),F={class:"modal-footer"},B=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),q=["disabled"];var P=e(1080),R=e(2124);const X={name:"ObjectStatusConfirmDelete",components:{NSelect:P.A},emits:["delete_status"],props:{statusData:{type:Object,default:()=>({higherOrderStatus:"Closed",status:""})},statusId:{type:Number,default:0},statusList:{type:Array,default:()=>[]}},data:()=>({migrationStatusIdModel:"",newStatusList:[]}),watch:{statusId(){this.migrationStatusIdModel="",this.newStatusList=this.statusList.filter((t=>parseInt(t.status_id)!==parseInt(this.statusId))).map((t=>({label:t.status,value:t.status_id})))}},computed:{...(0,R.L8)({destination:"getDestination",rootUrl:"getRootUrl"})},methods:{deleteStatus(){this.$store.dispatch("newToast",{header:"Removing Status",message:"Please wait whilst we remove the status",extra_classes:"bg-warning text-dark",delay:0,unique_type:"remove_status"});const t=new FormData;t.set("status_id",`${this.statusId}`),t.set("migration_status_id",this.migrationStatusIdModel),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/delete/`,t).then((()=>{this.$store.dispatch("newToast",{header:"Status Successfully Removed",message:"Status has been removed",extra_classes:"bg-success",unique_type:"remove_status"}),this.$emit("delete_status"),document.getElementById("confirmStatusDeleteModalClose").click()})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Removing Status",message:`Sorry, we could not remove the status. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"remove_status"})}))}}};var W=e(6262);const Q=(0,W.A)(X,[["render",function(t,s,e,o,d,i){const u=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",C,[(0,a.Lk)("div",M,[I,(0,a.Lk)("div",D,[(0,a.Q3)(" WARNING "),O,(0,a.Lk)("div",x,[(0,a.Lk)("p",null,[$,(0,a.eW)((0,l.toDisplayString)(e.statusData.status),1)]),(0,a.Lk)("p",null,[E,(0,a.eW)((0,l.toDisplayString)(e.statusData.higherOrderStatus),1)])]),j,(0,a.Lk)("div",N,[T,U,(0,a.bF)(u,{options:d.newStatusList,value:d.migrationStatusIdModel,"onUpdate:value":s[0]||(s[0]=t=>d.migrationStatusIdModel=t),style:{"z-index":"9999"},class:"new-card-destination"},null,8,["options","value"])]),A]),(0,a.Lk)("div",F,[B,(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=(...t)=>i.deleteStatus&&i.deleteStatus(...t)),disabled:null===this.migrationStatusIdModel||""===this.migrationStatusIdModel}," Delete Status ",8,q)])])])])}]]);var V=e(3751);const G={class:"modal fade",id:"objectStatusModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true","data-bs-keyboard":"false"},H={class:"modal-dialog"},z={class:"modal-content"},J=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"}," Add/Edit Status "),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"objectStatusModalClose"})],-1),K={class:"modal-body"},Y={class:"form-group"},Z={key:0,class:"error"},tt=(0,a.Lk)("div",{class:"spacer"},null,-1),st={class:"form-group"},et=(0,a.Lk)("label",null,"Higher Order Status",-1),at={class:"modal-footer"},lt=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),ot=["disabled"],dt={name:"ObjectStatusModal",components:{NSelect:P.A},emits:["add_status","update_status"],props:{statusData:{type:Object,default:()=>({higherOrderStatus:"Closed",status:""})},statusId:{type:Number,default:0},statusList:{type:Array,default:()=>[]}},computed:{...(0,R.L8)({destination:"getDestination",rootUrl:"getRootUrl"})},data:()=>({higherOrderStatusList:[{label:"Backlog",value:"Backlog"},{label:"Blocked",value:"Blocked"},{label:"Normal",value:"Normal"},{label:"Closed",value:"Closed"}],higherOrderStatusModel:"Normal",isDuplicate:!1,localStatusModel:""}),watch:{statusId(){this.higherOrderStatusModel=this.statusData.higherOrderStatus,this.localStatusModel=this.statusData.status},localStatusModel(){const t=this.statusList.filter((t=>t.status.toLowerCase()===this.localStatusModel.toLowerCase())).length;this.isDuplicate=t>0}},methods:{editStatus(){this.$store.dispatch("newToast",{header:"Updating Status",message:"Please wait whilst we update the status",extra_classes:"bg-warning text-dark",delay:0,unique_type:"update_status"});const t=new FormData;t.set("status_id",this.statusId.toString()),t.set("status",this.localStatusModel),t.set("higher_order_status",this.higherOrderStatusModel),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/update/`,t).then((()=>{this.$emit("update_status",{statusId:this.statusId,status:this.localStatusModel,higherOrderStatus:this.higherOrderStatusModel}),this.$store.dispatch("newToast",{header:"Successfully updated status",message:"Status has been updated",extra_classes:"bg-success",unique_type:"update_status"}),document.getElementById("objectStatusModalClose").click()})).catch((t=>{this.$store.dispatch("newToast",{header:"Error updating status",message:`Sorry, but we could not update your status. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"update_status"})}))},newStatus(){this.$store.dispatch("newToast",{header:"Creating New Status",message:"Please wait whilst we create new status",extra_classes:"bg-warning text-dark",delay:0,unique_type:"create_status"});const t=new FormData;t.set("status",this.localStatusModel),t.set("higher_order_status",this.higherOrderStatusModel),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/create/`,t).then((t=>{this.$store.dispatch("newToast",{header:"Created New Status",message:"New Status has been created successfully",extra_classes:"bg-success",unique_type:"create_status"}),this.$emit("add_status",t.data),document.getElementById("objectStatusModalClose").click(),this.localStatusModel="",this.higherOrderStatusModel="Normal"})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Creating New Status",message:`Sorry, we could not create the status. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"create_status"})}))},saveChanges(){0===parseInt(this.statusId)?this.newStatus():this.editStatus()}}},it=(0,W.A)(dt,[["render",function(t,s,e,l,o,d){const i=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",G,[(0,a.Lk)("div",H,[(0,a.Lk)("div",z,[J,(0,a.Lk)("div",K,[(0,a.Lk)("div",Y,[(0,a.Lk)("label",null,[(0,a.eW)(" Status "),o.isDuplicate?((0,a.uX)(),(0,a.CE)("span",Z," Sorry, there is a status of that name already ")):(0,a.Q3)("v-if",!0)]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.localStatusModel=t),type:"text",class:"form-control"},null,512),[[V.vModelText,o.localStatusModel]])]),tt,(0,a.Lk)("div",st,[et,(0,a.bF)(i,{value:o.higherOrderStatusModel,"onUpdate:value":s[1]||(s[1]=t=>o.higherOrderStatusModel=t),options:o.higherOrderStatusList},null,8,["value","options"])])]),(0,a.Lk)("div",at,[lt,(0,a.Lk)("button",{type:"button",class:"btn btn-primary",disabled:o.isDuplicate,onClick:s[2]||(s[2]=(...t)=>d.saveChanges&&d.saveChanges(...t))}," Save changes ",8,ot)])])])])}]]);var ut=e(3980),rt=e(9581);const nt={name:"ObjectStatusInformation",props:{destination:{type:String,default:""},nearbeachTitle:{type:String,default:"Status Editor"},objectStatusResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},theme:{type:String,default:""}},components:{CarbonCloseOutline:ut.wo,draggable:v(),ObjectStatusConfirmDelete:Q,ObjectStatusModal:it},data(){return{localStatusList:this.objectStatusResults,statusData:{higherOrderStatus:"Closed",status:""},statusId:0}},methods:{useNBTheme:rt.p,addStatus(t){this.localStatusList.push(t[0])},delete_status(){this.localStatusList=this.localStatusList.filter((t=>t.status_id!==this.statusId))},editStatus(t){const s=parseInt(t.target.dataset.id);this.updateProps(s),new w.aF(document.getElementById("objectStatusModal")).show()},newStatus(){this.statusData={higherOrderStatus:"Normal",status:""},this.statusId=0,new w.aF(document.getElementById("objectStatusModal")).show()},removeStatus(t){this.updateProps(t),new w.aF(document.getElementById("confirmStatusDeleteModal")).show()},updateProps(t){const s=this.localStatusList.filter((s=>parseInt(s.status_id)===t));0!==s.length&&(this.statusData={higherOrderStatus:s[0].higher_order_status,status:s[0].status},this.statusId=t)},updateSortOrder(){this.$store.dispatch("newToast",{header:"Updating Sort Order",message:"Please wait, as we update the sort order",extra_classes:"bg-warning text-dark",delay:0,unique_type:"sort_order"});const t=new FormData;this.localStatusList.forEach((s=>{t.append("status_id",s.status_id)})),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/reorder/`,t).then((()=>{this.$store.dispatch("newToast",{header:"Updated Sort Order",message:"Sort Order has been updated",extra_classes:"bg-success",unique_type:"sort_order"})})).catch((t=>{this.$store.dispatch("newToast",{header:"Failed Updating Sort Order",message:`We've encounted an issue updating the sort order: Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"sort_order"})}))},updateStatus(t){const s=parseInt(t.statusId);if(void 0===s)return void this.$store.dispatch("newToast",{header:"Error updating card",message:"Please reload the page. We have experienced an in page issue",extra_classes:"bg-danger",delay:0});const e=this.localStatusList.findIndex((t=>t.status_id===s));this.localStatusList[e].higher_order_status=t.higherOrderStatus,this.localStatusList[e].status=t.status}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateDestination",destination:this.destination})}},ct=(0,W.A)(nt,[["render",function(t,s,e,y,v,w){const f=(0,a.g2)("carbon-close-outline"),C=(0,a.g2)("draggable"),M=(0,a.g2)("object-status-modal"),I=(0,a.g2)("object-status-confirm-delete"),D=(0,a.g2)("n-config-provider");return(0,a.uX)(),(0,a.Wv)(D,{theme:w.useNBTheme(e.theme)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",o,[(0,a.Lk)("div",d,[(0,a.Lk)("h1",null,(0,l.toDisplayString)(e.nearbeachTitle),1),i,(0,a.Lk)("a",{href:`${this.rootUrl}object_status_list/`}," Go back to object status list ",8,u),r,(0,a.Lk)("div",n,[c,(0,a.Lk)("div",h,[p,0===v.localStatusList.length?((0,a.uX)(),(0,a.CE)("span",m," Please create at least one status ")):(0,a.Q3)("v-if",!0),g,(0,a.bF)(C,{modelValue:v.localStatusList,"onUpdate:modelValue":s[1]||(s[1]=t=>v.localStatusList=t),"item-key":"status_id","ghost-class":"ghost",onChange:w.updateSortOrder},{item:(0,a.k6)((({element:t})=>[((0,a.uX)(),(0,a.CE)("div",{class:"sortable",key:t.status_id,"data-id":t.status_id,onDblclick:s[0]||(s[0]=t=>w.editStatus(t))},[((0,a.uX)(),(0,a.CE)("div",{class:"content",key:t.status_id,"data-id":t.status_id},[((0,a.uX)(),(0,a.CE)("strong",{key:t.status_id,"data-id":t.status_id},(0,l.toDisplayString)(t.status),9,k))],8,b)),v.localStatusList.length>1?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"icon",onClick:s=>w.removeStatus(t.status_id)},[(0,a.bF)(f)],8,_)):(0,a.Q3)("v-if",!0)],40,S))])),_:1},8,["modelValue","onChange"]),L,(0,a.Lk)("button",{onClick:s[2]||(s[2]=(...t)=>w.newStatus&&w.newStatus(...t)),class:"btn btn-primary"}," New Status ")])])])]),(0,a.bF)(M,{"status-data":v.statusData,"status-id":v.statusId,"status-list":v.localStatusList,onAdd_status:s[3]||(s[3]=t=>w.addStatus(t)),onUpdate_status:s[4]||(s[4]=t=>w.updateStatus(t))},null,8,["status-data","status-id","status-list"]),(0,a.bF)(I,{"status-data":v.statusData,"status-id":v.statusId,"status-list":v.localStatusList,onDelete_status:w.delete_status},null,8,["status-data","status-id","status-list","onDelete_status"])])),_:1},8,["theme"])}]])},9581:(t,s,e)=>{e.d(s,{p:()=>o});var a=e(953),l=e(7413);function o(t){return"dark"===(0,a.BA)(t)?l.a:null}}}]);