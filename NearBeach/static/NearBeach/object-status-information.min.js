"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[6792],{3039:(t,s,e)=>{e.r(s),e.d(s,{default:()=>V});var a=e(641),l=e(33);const o={class:"card"},d={class:"card-body"},i=["href"],u={class:"row"},r={class:"col-md-8"},n={key:0,class:"error"},c=["data-id"],h=["data-id"],p=["data-id"],m=["onClick"];var g=e(432),S=e.n(g),b=e(9336);const k={class:"modal fade",id:"confirmStatusDeleteModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_={class:"modal-dialog"},L={class:"modal-content"},y={class:"modal-body"},v={class:"row"},w={class:"row"},f={class:"modal-footer"},C=["disabled"];var M=e(1080),I=e(2124);const D={name:"ObjectStatusConfirmDelete",components:{NSelect:M.A},emits:["delete_status"],props:{statusData:{type:Object,default:()=>({higherOrderStatus:"Closed",status:""})},statusId:{type:Number,default:0},statusList:{type:Array,default:()=>[]}},data:()=>({migrationStatusIdModel:"",newStatusList:[]}),watch:{statusId(){this.migrationStatusIdModel="",this.newStatusList=this.statusList.filter((t=>parseInt(t.status_id)!==parseInt(this.statusId))).map((t=>({label:t.status,value:t.status_id})))}},computed:{...(0,I.L8)({destination:"getDestination",rootUrl:"getRootUrl"})},methods:{deleteStatus(){this.$store.dispatch("newToast",{header:"Removing Status",message:"Please wait whilst we remove the status",extra_classes:"bg-warning text-dark",delay:0,unique_type:"remove_status"});const t=new FormData;t.set("status_id",`${this.statusId}`),t.set("migration_status_id",this.migrationStatusIdModel),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/delete/`,t).then((()=>{this.$store.dispatch("newToast",{header:"Status Successfully Removed",message:"Status has been removed",extra_classes:"bg-success",unique_type:"remove_status"}),this.$emit("delete_status"),document.getElementById("confirmStatusDeleteModalClose").click()})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Removing Status",message:`Sorry, we could not remove the status. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"remove_status"})}))}}};var O=e(6262);const x=(0,O.A)(D,[["render",function(t,s,e,o,d,i){const u=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("div",_,[(0,a.Lk)("div",L,[s[10]||(s[10]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title"},"Confirm Deletion"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmStatusDeleteModalClose"})],-1)),(0,a.Lk)("div",y,[(0,a.Q3)(" WARNING "),s[6]||(s[6]=(0,a.Lk)("div",{class:"alert alert-warning"},[(0,a.Lk)("h4",null,"WARNING"),(0,a.Lk)("p",null," This process can not be reversed. Deleting a status will remove it completely. "),(0,a.Lk)("p",null," All objects connected with this status will have to migrate to a new status. This is also permanent and can not be reversed. ")],-1)),(0,a.Lk)("div",v,[(0,a.Lk)("p",null,[s[2]||(s[2]=(0,a.Lk)("strong",null,"Status: ",-1)),(0,a.eW)((0,l.toDisplayString)(e.statusData.status),1)]),(0,a.Lk)("p",null,[s[3]||(s[3]=(0,a.Lk)("strong",null,"Higher Order Status: ",-1)),(0,a.eW)((0,l.toDisplayString)(e.statusData.higherOrderStatus),1)])]),s[7]||(s[7]=(0,a.Lk)("div",{class:"spacer"},null,-1)),(0,a.Lk)("div",w,[s[4]||(s[4]=(0,a.Lk)("p",null,"Please select an appropriate status to migrate too.",-1)),s[5]||(s[5]=(0,a.Lk)("label",null,[(0,a.Lk)("strong",null,"New Status for the objects")],-1)),(0,a.bF)(u,{options:d.newStatusList,value:d.migrationStatusIdModel,"onUpdate:value":s[0]||(s[0]=t=>d.migrationStatusIdModel=t),style:{"z-index":"9999"},class:"new-card-destination"},null,8,["options","value"])]),s[8]||(s[8]=(0,a.Lk)("br",null,null,-1))]),(0,a.Lk)("div",f,[s[9]||(s[9]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=(...t)=>i.deleteStatus&&i.deleteStatus(...t)),disabled:null===this.migrationStatusIdModel||""===this.migrationStatusIdModel}," Delete Status ",8,C)])])])])}]]);var $=e(3751);const E={class:"modal fade",id:"objectStatusModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true","data-bs-keyboard":"false"},j={class:"modal-dialog"},N={class:"modal-content"},T={class:"modal-body"},U={class:"form-group"},A={key:0,class:"error"},F={class:"form-group"},B={class:"modal-footer"},q=["disabled"],P={name:"ObjectStatusModal",components:{NSelect:M.A},emits:["add_status","update_status"],props:{statusData:{type:Object,default:()=>({higherOrderStatus:"Closed",status:""})},statusId:{type:Number,default:0},statusList:{type:Array,default:()=>[]}},computed:{...(0,I.L8)({destination:"getDestination",rootUrl:"getRootUrl"})},data:()=>({higherOrderStatusList:[{label:"Backlog",value:"Backlog"},{label:"Blocked",value:"Blocked"},{label:"Normal",value:"Normal"},{label:"Closed",value:"Closed"}],higherOrderStatusModel:"Normal",isDuplicate:!1,localStatusModel:""}),watch:{statusId(){this.higherOrderStatusModel=this.statusData.higherOrderStatus,this.localStatusModel=this.statusData.status},localStatusModel(){const t=this.statusList.filter((t=>t.status.toLowerCase()===this.localStatusModel.toLowerCase())).length;this.isDuplicate=t>0}},methods:{editStatus(){this.$store.dispatch("newToast",{header:"Updating Status",message:"Please wait whilst we update the status",extra_classes:"bg-warning text-dark",delay:0,unique_type:"update_status"});const t=new FormData;t.set("status_id",this.statusId.toString()),t.set("status",this.localStatusModel),t.set("higher_order_status",this.higherOrderStatusModel),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/update/`,t).then((()=>{this.$emit("update_status",{statusId:this.statusId,status:this.localStatusModel,higherOrderStatus:this.higherOrderStatusModel}),this.$store.dispatch("newToast",{header:"Successfully updated status",message:"Status has been updated",extra_classes:"bg-success",unique_type:"update_status"}),document.getElementById("objectStatusModalClose").click()})).catch((t=>{this.$store.dispatch("newToast",{header:"Error updating status",message:`Sorry, but we could not update your status. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"update_status"})}))},newStatus(){this.$store.dispatch("newToast",{header:"Creating New Status",message:"Please wait whilst we create new status",extra_classes:"bg-warning text-dark",delay:0,unique_type:"create_status"});const t=new FormData;t.set("status",this.localStatusModel),t.set("higher_order_status",this.higherOrderStatusModel),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/create/`,t).then((t=>{this.$store.dispatch("newToast",{header:"Created New Status",message:"New Status has been created successfully",extra_classes:"bg-success",unique_type:"create_status"}),this.$emit("add_status",t.data),document.getElementById("objectStatusModalClose").click(),this.localStatusModel="",this.higherOrderStatusModel="Normal"})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Creating New Status",message:`Sorry, we could not create the status. Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"create_status"})}))},saveChanges(){0===parseInt(this.statusId)?this.newStatus():this.editStatus()}}},R=(0,O.A)(P,[["render",function(t,s,e,l,o,d){const i=(0,a.g2)("n-select");return(0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("div",j,[(0,a.Lk)("div",N,[s[7]||(s[7]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"}," Add/Edit Status "),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"objectStatusModalClose"})],-1)),(0,a.Lk)("div",T,[(0,a.Lk)("div",U,[(0,a.Lk)("label",null,[s[3]||(s[3]=(0,a.eW)(" Status ")),o.isDuplicate?((0,a.uX)(),(0,a.CE)("span",A," Sorry, there is a status of that name already ")):(0,a.Q3)("v-if",!0)]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.localStatusModel=t),type:"text",class:"form-control"},null,512),[[$.vModelText,o.localStatusModel]])]),s[5]||(s[5]=(0,a.Lk)("div",{class:"spacer"},null,-1)),(0,a.Lk)("div",F,[s[4]||(s[4]=(0,a.Lk)("label",null,"Higher Order Status",-1)),(0,a.bF)(i,{value:o.higherOrderStatusModel,"onUpdate:value":s[1]||(s[1]=t=>o.higherOrderStatusModel=t),options:o.higherOrderStatusList},null,8,["value","options"])])]),(0,a.Lk)("div",B,[s[6]||(s[6]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",disabled:o.isDuplicate,onClick:s[2]||(s[2]=(...t)=>d.saveChanges&&d.saveChanges(...t))}," Save changes ",8,q)])])])])}]]);var X=e(3980),W=e(9581);const Q={name:"ObjectStatusInformation",props:{destination:{type:String,default:""},nearbeachTitle:{type:String,default:"Status Editor"},objectStatusResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},theme:{type:String,default:""}},components:{CarbonCloseOutline:X.wo,draggable:S(),ObjectStatusConfirmDelete:x,ObjectStatusModal:R},data(){return{localStatusList:this.objectStatusResults,statusData:{higherOrderStatus:"Closed",status:""},statusId:0}},methods:{useNBTheme:W.p,addStatus(t){this.localStatusList.push(t[0])},delete_status(){this.localStatusList=this.localStatusList.filter((t=>t.status_id!==this.statusId))},editStatus(t){console.log("Event: ",t);const s=parseInt(t.target.dataset.id);this.updateProps(s),new b.aF(document.getElementById("objectStatusModal")).show()},newStatus(){this.statusData={higherOrderStatus:"Normal",status:""},this.statusId=0,new b.aF(document.getElementById("objectStatusModal")).show()},removeStatus(t){this.updateProps(t),new b.aF(document.getElementById("confirmStatusDeleteModal")).show()},updateProps(t){const s=this.localStatusList.filter((s=>parseInt(s.status_id)===t));0!==s.length&&(this.statusData={higherOrderStatus:s[0].higher_order_status,status:s[0].status},this.statusId=t)},updateSortOrder(){this.$store.dispatch("newToast",{header:"Updating Sort Order",message:"Please wait, as we update the sort order",extra_classes:"bg-warning text-dark",delay:0,unique_type:"sort_order"});const t=new FormData;this.localStatusList.forEach((s=>{t.append("status_id",s.status_id)})),this.axios.post(`${this.rootUrl}object_status_information/${this.destination}/reorder/`,t).then((()=>{this.$store.dispatch("newToast",{header:"Updated Sort Order",message:"Sort Order has been updated",extra_classes:"bg-success",unique_type:"sort_order"})})).catch((t=>{this.$store.dispatch("newToast",{header:"Failed Updating Sort Order",message:`We've encounted an issue updating the sort order: Error -> ${t}`,extra_classes:"bg-danger",delay:0,unique_type:"sort_order"})}))},updateStatus(t){const s=parseInt(t.statusId);if(void 0===s)return void this.$store.dispatch("newToast",{header:"Error updating card",message:"Please reload the page. We have experienced an in page issue",extra_classes:"bg-danger",delay:0});const e=this.localStatusList.findIndex((t=>t.status_id===s));this.localStatusList[e].higher_order_status=t.higherOrderStatus,this.localStatusList[e].status=t.status}},async beforeMount(){await this.$store.dispatch("processThemeUpdate",{theme:this.theme})},mounted(){this.$store.commit({type:"updateDestination",destination:this.destination})}},V=(0,O.A)(Q,[["render",function(t,s,e,g,S,b){const k=(0,a.g2)("carbon-close-outline"),_=(0,a.g2)("draggable"),L=(0,a.g2)("object-status-modal"),y=(0,a.g2)("object-status-confirm-delete"),v=(0,a.g2)("n-config-provider");return(0,a.uX)(),(0,a.Wv)(v,{theme:b.useNBTheme(e.theme)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",o,[(0,a.Lk)("div",d,[(0,a.Lk)("h1",null,(0,l.toDisplayString)(e.nearbeachTitle),1),s[9]||(s[9]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("a",{href:`${this.rootUrl}object_status_list/`}," Go back to object status list ",8,i),s[10]||(s[10]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",u,[s[8]||(s[8]=(0,a.Lk)("div",{class:"col-md-4"},[(0,a.Lk)("strong",null,"Editing Status"),(0,a.Lk)("p",{class:"text-instructions"}," Move the status' around to reorder them. Double click to edit text and settings. ")],-1)),(0,a.Lk)("div",r,[s[5]||(s[5]=(0,a.Lk)("strong",null,"Status List",-1)),0===S.localStatusList.length?((0,a.uX)(),(0,a.CE)("span",n," Please create at least one status ")):(0,a.Q3)("v-if",!0),s[6]||(s[6]=(0,a.Lk)("br",null,null,-1)),(0,a.bF)(_,{modelValue:S.localStatusList,"onUpdate:modelValue":s[1]||(s[1]=t=>S.localStatusList=t),"item-key":"status_id","ghost-class":"ghost",onChange:b.updateSortOrder},{item:(0,a.k6)((({element:t})=>[((0,a.uX)(),(0,a.CE)("div",{class:"sortable",key:t.status_id,"data-id":t.status_id,onDblclick:s[0]||(s[0]=t=>b.editStatus(t))},[((0,a.uX)(),(0,a.CE)("div",{class:"content",key:t.status_id,"data-id":t.status_id},[((0,a.uX)(),(0,a.CE)("strong",{key:t.status_id,"data-id":t.status_id},(0,l.toDisplayString)(t.status),9,p))],8,h)),S.localStatusList.length>1?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"icon",onClick:s=>b.removeStatus(t.status_id)},[(0,a.bF)(k)],8,m)):(0,a.Q3)("v-if",!0)],40,c))])),_:1},8,["modelValue","onChange"]),s[7]||(s[7]=(0,a.Lk)("div",{class:"spacer"},null,-1)),(0,a.Lk)("button",{onClick:s[2]||(s[2]=(...t)=>b.newStatus&&b.newStatus(...t)),class:"btn btn-primary"}," New Status ")])])])]),(0,a.bF)(L,{"status-data":S.statusData,"status-id":S.statusId,"status-list":S.localStatusList,onAdd_status:s[3]||(s[3]=t=>b.addStatus(t)),onUpdate_status:s[4]||(s[4]=t=>b.updateStatus(t))},null,8,["status-data","status-id","status-list"]),(0,a.bF)(y,{"status-data":S.statusData,"status-id":S.statusId,"status-list":S.localStatusList,onDelete_status:b.delete_status},null,8,["status-data","status-id","status-list","onDelete_status"])])),_:1},8,["theme"])}]])},9581:(t,s,e)=>{e.d(s,{p:()=>o});var a=e(953),l=e(7413);function o(t){return"dark"===(0,a.BA)(t)?l.a:null}}}]);