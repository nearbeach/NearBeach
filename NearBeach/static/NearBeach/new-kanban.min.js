"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[3513],{6029:(e,a,r)=>{r.r(a),r.d(a,{default:()=>B});var o=r(641),s=r(3751);const t={class:"card"},n={class:"card-body"},i={class:"row"},l={class:"col-md-8"},d={class:"form-group"},u={key:0,class:"error"},p={key:1,class:"error"},c={class:"row"},m={class:"col-md-4"},h={class:"col-md-4"},g={class:"row submit-row"},b={class:"col-md-12"},k=["disabled"];var y=r(4808),v=r(2190),w=r(9639),L=r(3855),M=r(404),N=r(9581);const f={name:"NewKanban",setup:()=>({v$:(0,w.Ay)()}),components:{GroupPermissions:v.A,KanbanPropertyOrder:y.A,ValidationRendering:M.A},props:{groupResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},theme:{type:String,default:""},userGroupPermissions:{type:Array,default:()=>[]}},data:()=>({checkingKanbanBoardName:!1,columnModel:[{id:0,property:"Normal",title:"Backlog"},{id:1,property:"Blocked",title:"Blocked"},{id:2,property:"Normal",title:"In Progress"},{id:4,property:"Normal",title:"Review and QA"},{id:5,property:"Closed",title:"Completed"}],disableSubmitButton:!1,displayGroupPermissionIssue:!1,groupModel:[],kanbanBoardNameModel:"",levelModel:[{id:0,title:"Sprint 1"},{id:1,title:"Sprint 2"}],searchTimeout:"",uniqueKanbanBoardName:!0}),validations:{columnModel:{required:L.mw},groupModel:{required:L.mw},kanbanBoardNameModel:{required:L.mw},levelModel:{required:L.mw}},watch:{kanbanBoardNameModel(){this.checkingKanbanBoardName=!0,""!==this.searchTimeout&&clearTimeout(this.searchTimeout),void 0===this.kanbanBoardNameModel?this.searchTimeout=setTimeout(this.checkKanbanBoardName,500):this.kanbanBoardNameModel.length>=3&&(this.searchTimeout=setTimeout(this.checkKanbanBoardName,500,this.kanbanBoardNameModel,null))}},methods:{useNBTheme:N.p,addNewKanban(){if(this.v$.$touch(),this.v$.$invalid||!this.uniqueKanbanBoardName||this.checkingKanbanBoardName||this.displayGroupPermissionIssue)return void this.$store.dispatch("newToast",{header:"Please check validation",message:"Sorry, but can you please fix all validation issues.",extra_classes:"bg-warning text-dark",delay:0});this.disableSubmitButton=!0;const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),this.columnModel.forEach((a=>{e.append("column_title",a.title),e.append("column_property",a.property)})),this.levelModel.forEach((a=>{e.append("level_title",a.title)})),this.groupModel.forEach((a=>{e.append("group_list",a)})),this.axios.post(`${this.rootUrl}new_kanban_save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Issue Creating new Kanban board",message:`Issues creating new kanban board -> Error ${e}`,extra_classes:"bg-warning text-dark",delay:0}),this.disableSubmitButton=!1}))},checkKanbanBoardName(){const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),this.axios.post(`${this.rootUrl}kanban_information/check_kanban_board_name/`,e).then((e=>{this.uniqueKanbanBoardName=0===e.data.length,this.checkingKanbanBoardName=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Issue checking Kanban board name",message:`Issues checking kanban board name -> Error ${e}`,extra_classes:"bg-warning text-dark",delay:0})}))},updateGroupModel(e){this.groupModel=e,this.displayGroupPermissionIssue=0===this.userGroupPermissions.filter((e=>{const a=this.groupModel.includes(e.group_id),r=e.object_permission_value>=3;return a&&r})).length},updatePropertyList(e){this[e.source]=e.data}}},B=(0,r(6262).A)(f,[["render",function(e,a,r,y,v,w){const L=(0,o.g2)("validation-rendering"),M=(0,o.g2)("kanban-property-order"),N=(0,o.g2)("group-permissions"),f=(0,o.g2)("n-config-provider");return(0,o.uX)(),(0,o.Wv)(f,{theme:w.useNBTheme(r.theme)},{default:(0,o.k6)((()=>[(0,o.Lk)("div",t,[(0,o.Lk)("div",n,[a[8]||(a[8]=(0,o.Lk)("h1",null,"New Kanban",-1)),a[9]||(a[9]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("div",i,[(0,o.Q3)(" DESCRIPTION "),a[6]||(a[6]=(0,o.Lk)("div",{class:"col-md-4"},[(0,o.Lk)("strong",null,"Please note"),(0,o.Lk)("p",{class:"text-instructions"},"Board names must be unique.")],-1)),(0,o.Q3)(" BOARD NAME "),(0,o.Lk)("div",l,[(0,o.Lk)("div",d,[(0,o.Lk)("label",null,[a[5]||(a[5]=(0,o.eW)("Kanban Board Name ")),(0,o.bF)(L,{"error-list":y.v$.kanbanBoardNameModel.$errors},null,8,["error-list"]),v.uniqueKanbanBoardName?(0,o.Q3)("v-if",!0):((0,o.uX)(),(0,o.CE)("span",u," Please supply a unique name")),v.checkingKanbanBoardName?((0,o.uX)(),(0,o.CE)("span",p," Checking kanban name...")):(0,o.Q3)("v-if",!0)]),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>v.kanbanBoardNameModel=e)},null,512),[[s.vModelText,v.kanbanBoardNameModel]])])])]),a[10]||(a[10]=(0,o.Lk)("hr",null,null,-1)),(0,o.Q3)(" Properties for the drag and drop coloumns/levels "),(0,o.Lk)("div",c,[a[7]||(a[7]=(0,o.Lk)("div",{class:"col-md-4"},[(0,o.Lk)("h2",null,"Columns & Levels"),(0,o.Lk)("p",{class:"text-instructions"}," Drag the cards around to sort out the columns how you want them. ")],-1)),(0,o.Lk)("div",m,[(0,o.bF)(M,{"property-list":v.columnModel,"is-dirty":y.v$.columnModel.$dirty,"property-name":"Column",source:"columnModel",onUpdate_property_list:a[1]||(a[1]=e=>w.updatePropertyList(e))},null,8,["property-list","is-dirty"])]),(0,o.Lk)("div",h,[(0,o.bF)(M,{"property-list":v.levelModel,"is-dirty":y.v$.columnModel.$dirty,"property-name":"Level",source:"levelModel",onUpdate_property_list:a[2]||(a[2]=e=>w.updatePropertyList(e))},null,8,["property-list","is-dirty"])])]),(0,o.Q3)(" Group Permissions "),a[11]||(a[11]=(0,o.Lk)("hr",null,null,-1)),(0,o.bF)(N,{"display-group-permission-issue":v.displayGroupPermissionIssue,"group-results":r.groupResults,"user-group-permissions":r.userGroupPermissions,onUpdate_group_model:a[3]||(a[3]=e=>w.updateGroupModel(e)),"is-dirty":y.v$.groupModel.$dirty,destination:"kanban_board"},null,8,["display-group-permission-issue","group-results","user-group-permissions","is-dirty"]),(0,o.Q3)(" SAVE "),a[12]||(a[12]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("div",g,[(0,o.Lk)("div",b,[(0,o.Lk)("button",{class:"btn btn-primary save-changes",onClick:a[4]||(a[4]=(...e)=>w.addNewKanban&&w.addNewKanban(...e)),disabled:v.disableSubmitButton}," Add Kanban ",8,k)])])])])])),_:1},8,["theme"])}]])},2190:(e,a,r)=>{r.d(a,{A:()=>g});var o=r(641),s=r(33);const t={class:"row"},n={class:"col-md-4"},i={class:"text-instructions"},l={class:"col-md-8"},d={key:0,class:"alert alert-warning"};var u=r(1080),p=r(9639),c=r(3855),m=r(404);const h={name:"GroupPermissions",setup:()=>({v$:(0,p.Ay)()}),components:{NSelect:u.A,ValidationRendering:m.A},emits:["update_group_model"],props:{destination:{type:String,default:""},displayGroupPermissionIssue:{type:Boolean,default:!1},groupResults:{type:Array,default:()=>[]},userGroupPermissions:{type:Array,default:()=>[]}},watch:{groupModel(){this.$emit("update_group_model",this.groupModel)}},data:()=>({groupModel:[]}),validations:{groupModel:{required:c.mw}},mounted(){this.groupModel=this.userGroupPermissions.map((e=>e.group_id))}},g=(0,r(6262).A)(h,[["render",function(e,a,r,u,p,c){const m=(0,o.g2)("validation-rendering"),h=(0,o.g2)("n-select");return(0,o.uX)(),(0,o.CE)("div",t,[(0,o.Lk)("div",n,[a[1]||(a[1]=(0,o.Lk)("h2",null,"Group Permissions",-1)),(0,o.Lk)("p",i," Add or remove groups from this "+(0,s.toDisplayString)(r.destination)+". Adding a group will allow users from that group to access this "+(0,s.toDisplayString)(r.destination)+". ",1),a[2]||(a[2]=(0,o.Lk)("p",{class:"text-instructions"}," If you do not add one of your own group(s), you will only get readonly access. ",-1))]),(0,o.Lk)("div",l,[(0,o.Lk)("label",null,[a[3]||(a[3]=(0,o.eW)("Group List ")),(0,o.bF)(m,{"error-list":u.v$.groupModel.$errors},null,8,["error-list"])]),(0,o.bF)(h,{options:r.groupResults,"label-field":"group_name","value-field":"group_id",label:"group",value:p.groupModel,"onUpdate:value":a[0]||(a[0]=e=>p.groupModel=e),multiple:""},null,8,["options","value"]),(0,o.Q3)(" ALERT FOR WHEN USER GROUPS ARE NOT INCLUDED "),a[4]||(a[4]=(0,o.Lk)("br",null,null,-1)),r.displayGroupPermissionIssue?((0,o.uX)(),(0,o.CE)("div",d," You currently don't have enough permissions to create this object. Please select groups where you have the create ability. ")):(0,o.Q3)("v-if",!0)])])}]])},404:(e,a,r)=>{r.d(a,{A:()=>n});var o=r(641),s=r(33);const t={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},n=(0,r(6262).A)(t,[["render",function(e,a,r,t,n,i){return(0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.errorList,(e=>((0,o.uX)(),(0,o.CE)("span",{class:"error",key:e.$uid},(0,s.toDisplayString)(e.$message),1)))),128)}]])}}]);