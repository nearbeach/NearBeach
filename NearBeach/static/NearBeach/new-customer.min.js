"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[6023],{1107:(e,t,o)=>{o.r(t),o.d(t,{default:()=>L});var s=o(6252);const a={class:"card"},l={class:"card-body"},i=(0,s._)("h1",null,"New Customer",-1),r=(0,s._)("hr",null,null,-1),n=(0,s.Uk)(" New Customer Form "),u=(0,s._)("hr",null,null,-1),c={class:"row"},d=(0,s._)("div",{class:"col-md-4"},[(0,s._)("strong",null,"Customer Organisation"),(0,s._)("p",{class:"text-instructions"}," This field is optional. If this customer does not have any organisations attached, it will treat this customer as a freelancer. ")],-1),m={class:"col-md-8"},h={class:"form-group col-sm-8"},g=(0,s._)("label",null,"Organisation:",-1),p=(0,s._)("hr",null,null,-1),f={class:"row submit-row"},M={class:"col-md-12"};var v=o(9669),_=o.n(v),w=o(5169),E=o(4028),N=o(2587),y=o(3058),k=o(9113),C=o(2443),b=o(9860);const T={name:"NewCustomer",setup:()=>({v$:(0,E.ZP)()}),components:{NewCustomerForm:C.Z,NSelect:b.Z},props:{organisationName:{type:String,default:""},rootUrl:{type:String,default:"/"},titleList:{type:Array,default:function(){return[]}}},mixins:[y.Z,k.Z],data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",flagValidationCheck:!1,organisationFixList:[],organisationModel:"",titleModel:[]}),validations:()=>({customerEmailModel:{required:N.C1,email:N.Do},customerFirstNameModel:{required:N.C1},customerLastNameModel:{required:N.C1},titleModel:{required:N.C1}}),methods:{fetchOptions:function(e,t){this.searchTrigger({return_function:this.getOrganisationData,searchTimeout:this.searchTimeout,search:e,loading:t})},getOrganisationData:function(e,t){const o=new FormData;o.set("search",e),_().post(`${this.rootUrl}search/organisation/data/`,o).then((e=>{var t=e.data;this.organisationFixList=t.map((e=>({value:e.pk,label:e.fields.organisation_name})))})).catch((function(e){document.getElementById("errorModalContent").innerHTML=`<strong>Search Organisation Issue:</strong><br/>${e}`,new w.u_(document.getElementById("errorModal"),{keyboard:!1}).show(),document.getElementById("loader").style.display="none"}))},submitNewCustomer:async function(){if(this.flagValidationCheck=!0,setTimeout((()=>{this.flagValidationCheck=!1}),100),this.v$.$touch(),!await this.v$.$validate())return document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",void new w.u_(document.getElementById("errorModal")).show();const e=new FormData;e.set("customer_title",this.titleModel),e.set("customer_first_name",this.customerFirstNameModel),e.set("customer_last_name",this.customerLastNameModel),e.set("customer_email",this.customerEmailModel),""!==this.organisationModel&&null!==this.organisationModel&&e.set("organisation",this.organisationModel),_().post(`${this.rootUrl}new_customer/save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{this.showErrorModal(e,"customer","")}))},updateCustomerData:function(e){this[e.field]=e.value}},mounted(){setTimeout((()=>{this.getOrganisationData("","")}),200)}},L=(0,o(3744).Z)(T,[["render",function(e,t,o,v,_,w){const E=(0,s.up)("new-customer-form"),N=(0,s.up)("n-select");return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",l,[(0,s.kq)(" HEADER "),i,r,n,(0,s.Wm)(E,{"organisation-name":o.organisationName,"title-list":o.titleList,"flag-validation-check":_.flagValidationCheck,onUpdate_customer_data:t[0]||(t[0]=e=>w.updateCustomerData(e))},null,8,["organisation-name","title-list","flag-validation-check"]),(0,s.kq)(" CUSTOMER ORGANISATION "),u,(0,s._)("div",c,[d,(0,s._)("div",m,[(0,s._)("div",h,[g,(0,s.kq)(' <v-select :options="organisationFixList"\n                          @search="fetchOptions"\n                          v-model="organisationModel"\n                          label="organisation_name"\n                          class="get-stakeholders"\n                        ></v-select> '),(0,s.Wm)(N,{options:_.organisationFixList,filterable:"",placeholder:"Search Organisations",onSearch:w.fetchOptions,value:_.organisationModel,"onUpdate:value":t[1]||(t[1]=e=>_.organisationModel=e),label:"organisation_name",class:"get-stakeholders"},null,8,["options","onSearch","value"])])])]),(0,s.kq)(" REMEMBER TO ADD IN USER PERMISSIONS HERE!! "),(0,s.kq)(" Submit Button "),p,(0,s._)("div",f,[(0,s._)("div",M,[(0,s._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[2]||(t[2]=(...e)=>w.submitNewCustomer&&w.submitNewCustomer(...e))},"Submit Customer")])])])])}]])},2443:(e,t,o)=>{o.d(t,{Z:()=>L});var s=o(6252),a=o(9963);const l={class:"row"},i=(0,s._)("div",{class:"col-md-4"},[(0,s._)("strong",null,"New Customer"),(0,s._)("p",{class:"text-instructions"}," Please fill out the following details. "),(0,s._)("strong",null,"Please Note:"),(0,s._)("p",{class:"text-instructions"}," Customers do not go through a duplication process. Please search for the potential customer first before adding them into NearBeach. ")],-1),r={class:"col-md-8"},n={class:"row"},u={class:"form-group col-sm-3"},c=(0,s.Uk)(" Title: "),d={key:0,class:"error"},m={class:"form-group col-sm-4"},h=(0,s.Uk)(" First Name: "),g={key:0,class:"error"},p={class:"form-group col-sm-5"},f=(0,s.Uk)(" Last Name: "),M={key:0,class:"error"},v=(0,s._)("br",null,null,-1),_={class:"form-group col-sm-8"},w=(0,s.Uk)(" Email: "),E={key:0,class:"error"},N={key:1,class:"error"},y=(0,s._)("br",null,null,-1);o(5169);var k=o(9860),C=o(4028),b=o(2587);o(9669);const T={name:"NewCustomerForm",setup:()=>({v$:(0,C.ZP)()}),components:{NSelect:k.Z},props:["flagValidationCheck","organisationName","titleList"],data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",organisationModel:{},searchTimeout:"",titleFixList:[],titleModel:[]}),validations:{customerEmailModel:{required:b.C1,email:b.Do},customerFirstNameModel:{required:b.C1},customerLastNameModel:{required:b.C1},titleModel:{required:b.C1}},methods:{},watch:{customerEmailModel:function(){this.$emit("update_customer_data",{field:"customerEmailModel",value:this.customerEmailModel})},customerFirstNameModel:function(){this.$emit("update_customer_data",{field:"customerFirstNameModel",value:this.customerFirstNameModel})},customerLastNameModel:function(){this.$emit("update_customer_data",{field:"customerLastNameModel",value:this.customerLastNameModel})},flagValidationCheck:function(){this.flagValidationCheck&&(console.log("GOT HERE!!"),this.v$.$touch(),console.log("V: ",this.v$))},titleModel:function(){this.$emit("update_customer_data",{field:"titleModel",value:this.titleModel})}},mounted(){this.titleFixList=this.titleList.map((e=>({value:e.pk,label:e.fields.title})))}},L=(0,o(3744).Z)(T,[["render",function(e,t,o,k,C,b){const T=(0,s.up)("n-select");return(0,s.wg)(),(0,s.iD)("div",l,[i,(0,s._)("div",r,[(0,s.kq)(" CUSTOMER DETAILS "),(0,s._)("div",n,[(0,s._)("div",u,[(0,s._)("label",null,[c,k.v$.titleModel.$error?((0,s.wg)(),(0,s.iD)("span",d," Please supply ")):(0,s.kq)("v-if",!0)]),(0,s.Wm)(T,{options:C.titleFixList,label:"title",placeholder:"",value:C.titleModel,"onUpdate:value":t[0]||(t[0]=e=>C.titleModel=e)},null,8,["options","value"])]),(0,s._)("div",m,[(0,s._)("label",null,[h,k.v$.customerFirstNameModel.$error?((0,s.wg)(),(0,s.iD)("span",g," Please supply ")):(0,s.kq)("v-if",!0)]),(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>C.customerFirstNameModel=e)},null,512),[[a.vModelText,C.customerFirstNameModel]])]),(0,s._)("div",p,[(0,s._)("label",null,[f,k.v$.customerLastNameModel.$error?((0,s.wg)(),(0,s.iD)("span",M," Please supply ")):(0,s.kq)("v-if",!0)]),(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>C.customerLastNameModel=e)},null,512),[[a.vModelText,C.customerLastNameModel]])])]),v,(0,s.kq)(" Customer Email "),(0,s._)("div",_,[(0,s._)("label",null,[w,k.v$.customerEmailModel.$error?((0,s.wg)(),(0,s.iD)("span",E," Please supply ")):(0,s.kq)("v-if",!0),k.v$.customerEmailModel.$error?((0,s.wg)(),(0,s.iD)("span",N," Please format as Email ")):(0,s.kq)("v-if",!0)]),(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>C.customerEmailModel=e)},null,512),[[a.vModelText,C.customerEmailModel]])]),y])])}]])},3058:(e,t,o)=>{o.d(t,{Z:()=>a});var s=o(5169);const a={methods:{showErrorModal:function(e,t,o){new s.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${t}-${o}<hr>${e}`,new s.u_(document.getElementById("errorModal")).show()},showValidationErrorModal:function(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new s.u_(document.getElementById("errorModal")).show()}}}},9113:(e,t,o)=>{o.d(t,{Z:()=>s});const s={methods:{searchTrigger:function(e){""!=e.searchTimeout&&clearTimeout(e.searchTimeout),void 0===e.search?this.searchUndefined(e):this.searchDefined(e)},searchDefined:function(e){e.search.length>=3&&(e.searchTimeout=setTimeout(e.return_function,500,e.search,e.loading))},searchUndefined:function(e){e.searchTimeout=setTimeout(e.return_function,500)}}}}}]);