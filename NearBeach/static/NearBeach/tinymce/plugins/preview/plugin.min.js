!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");class t{constructor(e,t){this.tag=e,this.value=t}static some(e){return new t(!0,e)}static none(){return t.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?t.some(e(this.value)):t.none()}bind(e){return this.tag?e(this.value):t.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:t.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return null==e?t.none():t.some(e)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}t.singletonNone=new t(!1);const r=e=>()=>e,n=r(!1),s=(e,r)=>((e,r,n)=>{for(let s=0,i=e.length;s<i;s++){const i=e[s];if(r(i,s))return t.some(i);if(n(i,s))break}return t.none()})(e,r,n);"undefined"!=typeof window?window:Function("return this;")();const i=()=>o(0,0),o=(e,t)=>({major:e,minor:t}),a={nu:o,detect:(e,t)=>{const r=String(t).toLowerCase();return 0===e.length?i():((e,t)=>{const r=((e,t)=>{for(let r=0;r<e.length;r++){const n=e[r];if(n.test(t))return n}})(e,t);if(!r)return{major:0,minor:0};const n=e=>Number(t.replace(r,"$"+e));return o(n(1),n(2))})(e,r)},unknown:i},c=(e,t)=>{const r=String(t).toLowerCase();return s(e,(e=>e.search(r)))},u=(e,t,r=0,n)=>{const s=e.indexOf(t,r);return-1!==s&&(!!(e=>void 0===e)(n)||s+t.length<=n)},d=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,l=e=>t=>u(t,e),h=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>u(e,"edge/")&&u(e,"chrome")&&u(e,"safari")&&u(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,d],search:e=>u(e,"chrome")&&!u(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>u(e,"msie")||u(e,"trident")},{name:"Opera",versionRegexes:[d,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:l("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:l("firefox")},{name:"Safari",versionRegexes:[d,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(u(e,"safari")||u(e,"mobile/"))&&u(e,"applewebkit")}],m=[{name:"Windows",search:l("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>u(e,"iphone")||u(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:l("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:l("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:l("linux"),versionRegexes:[]},{name:"Solaris",search:l("sunos"),versionRegexes:[]},{name:"FreeBSD",search:l("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:l("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],v={browsers:r(h),oses:r(m)},g="Edge",p="Chromium",w="Opera",f="Firefox",x="Safari",S=e=>{const t=e.current,r=e.version,n=e=>()=>t===e;return{current:t,version:r,isEdge:n(g),isChromium:n(p),isIE:n("IE"),isOpera:n(w),isFirefox:n(f),isSafari:n(x)}},y=()=>S({current:void 0,version:a.unknown()}),b=S,O=(r(g),r(p),r("IE"),r(w),r(f),r(x),"Windows"),R="Android",C="Linux",A="macOS",k="Solaris",D="FreeBSD",E="ChromeOS",I=e=>{const t=e.current,r=e.version,n=e=>()=>t===e;return{current:t,version:r,isWindows:n(O),isiOS:n("iOS"),isAndroid:n(R),isMacOS:n(A),isLinux:n(C),isSolaris:n(k),isFreeBSD:n(D),isChromeOS:n(E)}},P=()=>I({current:void 0,version:a.unknown()}),T=I,_=(r(O),r("iOS"),r(R),r(C),r(A),r(k),r(D),r(E),(e,n,i)=>{const o=v.browsers(),u=v.oses(),d=n.bind((e=>((e,r)=>((e,r)=>{for(let t=0;t<e.length;t++){const n=r(e[t]);if(n.isSome())return n}return t.none()})(r.brands,(t=>{const r=t.brand.toLowerCase();return s(e,(e=>{var t;return r===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:a.nu(parseInt(t.version,10),0)})))})))(o,e))).orThunk((()=>((e,t)=>c(e,t).map((e=>{const r=a.detect(e.versionRegexes,t);return{current:e.name,version:r}})))(o,e))).fold(y,b),l=((e,t)=>c(e,t).map((e=>{const r=a.detect(e.versionRegexes,t);return{current:e.name,version:r}})))(u,e).fold(P,T),h=((e,t,n,s)=>{const i=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!i,a=e.isiOS()||e.isAndroid(),c=a||s("(pointer:coarse)"),u=i||!o&&a&&s("(min-device-width:768px)"),d=o||a&&!u,l=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),h=!d&&!u&&!l;return{isiPad:r(i),isiPhone:r(o),isTablet:r(u),isPhone:r(d),isTouch:r(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(l),isDesktop:r(h)}})(l,d,e,i);return{browser:d,os:l,deviceType:h}}),B=e=>window.matchMedia(e).matches;let L=(e=>{let t,r=!1;return(...n)=>(r||(r=!0,t=e.apply(null,n)),t)})((()=>_(window.navigator.userAgent,t.from(window.navigator.userAgentData),B)));const N=()=>L();var F=tinymce.util.Tools.resolve("tinymce.util.Tools");const M=e=>t=>t.options.get(e),$=M("content_style"),W=M("content_css_cors"),U=M("body_class"),K=M("body_id");e.add("preview",(e=>{(e=>{e.addCommand("mcePreview",(()=>{(e=>{const t=(e=>{var t;let r="";const n=e.dom.encode,s=null!==(t=$(e))&&void 0!==t?t:"";r+=`<base href="${n(e.documentBaseURI.getURI())}">`;const i=W(e)?' crossorigin="anonymous"':"";F.each(e.contentCSS,(t=>{r+='<link type="text/css" rel="stylesheet" href="'+n(e.documentBaseURI.toAbsolute(t))+'"'+i+">"})),s&&(r+='<style type="text/css">'+s+"</style>");const o=K(e),a=U(e),c=e.getBody().dir,u=c?' dir="'+n(c)+'"':"";return"<!DOCTYPE html><html><head>"+r+'</head><body id="'+n(o)+'" class="mce-content-body '+n(a)+'"'+u+">"+e.getContent()+(()=>{const e=N().os.isMacOS()||N().os.isiOS();return`<script>(${(e=>{document.addEventListener("click",(t=>{for(let r=t.target;r;r=r.parentNode)if("A"===r.nodeName){const n=r.getAttribute("href");if(n&&n.startsWith("#")){t.preventDefault();const e=document.getElementById(n.substring(1));return void(e&&e.scrollIntoView({behavior:"smooth"}))}(e?t.metaKey:t.ctrlKey&&!t.altKey)||t.preventDefault()}}),!1)}).toString()})(${e})<\/script>`})()+"</body></html>"})(e);e.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0,transparent:!1}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:t}}).focus("close")})(e)}))})(e),(e=>{const t=()=>e.execCommand("mcePreview");e.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:t,context:"any"}),e.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:t,context:"any"})})(e)}))}();