"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[9256],{8838:(e,t,o)=>{o.d(t,{A:()=>h});var n,r=o(641),i=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],s=function(e){return-1!==i.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},a=0,c=function(e){var t=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++a+String(t)},l=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},u=function(){return{listeners:[],scriptId:c("tiny-script"),scriptLoaded:!1}},d=(n=u(),{load:function(e,t,o){n.scriptLoaded?o():(n.listeners.push(o),e.getElementById(n.scriptId)||function(e,t,o){var r=t.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=e,r.src=o;var i=function(){r.removeEventListener("load",i),n.listeners.forEach((function(e){return e()})),n.scriptLoaded=!0};r.addEventListener("load",i),t.head&&t.head.appendChild(r)}(n.scriptId,e,t))},reinitialize:function(){n=u()}}),m=function(){var e="undefined"!=typeof window?window:o.g;return e&&e.tinymce?e.tinymce:null},p={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},f=o(953),v=function(){return v=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},v.apply(this,arguments)},g={selector:void 0,target:void 0};const h=(0,r.pM)({props:p,setup:function(e,t){var o=e.init?v(v({},e.init),g):v({},g),n=(0,f.QW)(e),i=n.disabled,a=n.modelValue,u=n.tagName,p=(0,f.KR)(null),h=null,y=e.id||c("tiny-vue"),b=e.init&&e.init.inline||e.inline,C=!!t.attrs["onUpdate:modelValue"],_=!0,k=e.initialValue?e.initialValue:"",L="",S=function(){var n,i,c,u=(n=_,C?function(){return(null==a?void 0:a.value)?a.value:""}:function(){return n?k:L}),d=v(v({},o),{readonly:e.disabled,target:p.value,plugins:(i=o.plugins,c=e.plugins,l(i).concat(l(c))),toolbar:e.toolbar||o.toolbar,inline:b,setup:function(n){h=n,n.on("init",(function(o){return function(e,t,o,n,i,a){n.setContent(a()),o.attrs["onUpdate:modelValue"]&&function(e,t,o,n){var i=e.modelEvents?e.modelEvents:null,s=Array.isArray(i)?i.join(" "):i;(0,r.wB)(n,(function(t,n){o&&"string"==typeof t&&t!==n&&t!==o.getContent({format:e.outputFormat})&&o.setContent(t)})),o.on(s||"change input undo redo",(function(){t.emit("update:modelValue",o.getContent({format:e.outputFormat}))}))}(t,o,n,i),function(e,t,o){Object.keys(t).filter(s).forEach((function(n){var r=t[n];"function"==typeof r&&("onInit"===n?r(e,o):o.on(n.substring(2),(function(e){return r(e,o)})))}))}(e,o.attrs,n)}(o,e,t,n,a,u)})),"function"==typeof o.setup&&o.setup(n)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(p.value)&&(p.value.style.visibility=""),m().init(d),_=!1};return(0,r.wB)(i,(function(e){var t;null!==h&&("function"==typeof(null===(t=h.mode)||void 0===t?void 0:t.set)?h.mode.set(e?"readonly":"design"):h.setMode(e?"readonly":"design"))})),(0,r.wB)(u,(function(e){var t;C||(L=h.getContent()),null===(t=m())||void 0===t||t.remove(h),(0,r.dY)((function(){return S()}))})),(0,r.sV)((function(){if(null!==m())S();else if(p.value&&p.value.ownerDocument){var t=e.cloudChannel?e.cloudChannel:"7",o=e.apiKey?e.apiKey:"no-api-key",n=null==e.tinymceScriptSrc?"https://cdn.tiny.cloud/1/".concat(o,"/tinymce/").concat(t,"/tinymce.min.js"):e.tinymceScriptSrc;d.load(p.value.ownerDocument,n,S)}})),(0,r.xo)((function(){null!==m()&&m().remove(h)})),b||((0,r.n)((function(){_||S()})),(0,r.Y4)((function(){var e;C||(L=h.getContent()),null===(e=m())||void 0===e||e.remove(h)}))),t.expose({rerender:function(e){var t;L=h.getContent(),null===(t=m())||void 0===t||t.remove(h),o=v(v(v({},o),e),g),(0,r.dY)((function(){return S()}))},getEditor:function(){return h}}),function(){return b?function(e,t,o,n){return e(n||"div",{id:t,ref:o})}(r.h,y,p,e.tagName):(0,r.h)("textarea",{id:y,visibility:"hidden",ref:p})}}})},7865:(e,t,o)=>{o.d(t,{A:()=>R});var n=o(641),r=o(33);const i={class:"customer-list"},s=["src"],a={class:"customer-card--details"},c={class:"customer-card--name"},l=["href"],u={class:"customer-card--email"},d={key:0,class:"customer-card--remove"};var m=o(9336),p=o(2321);const f={class:"modal fade",id:"confirmCustomerRemoveModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmCustomerRemove","aria-hidden":"true"},v={class:"modal-dialog"},g={class:"modal-content"},h={class:"modal-body"},y={class:"customer-card--details"},b={class:"customer-card--name"},C=["href"],_={class:"customer-card--email"},k={class:"modal-footer"};var L=o(2124);const S={name:"ConfirmCustomerRemoval",emits:["remove_customer"],props:{customerObject:{type:Object,default:()=>({customer_id:0,customer_email:"",customer_first_name:"",customer_last_name:"",customer_profile_picture:""})}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{closeModal(){document.getElementById("confirmCustomerRemoveButton").click()},removeCustomer(){const e=new FormData;e.set("customer_id",this.customerObject.customer_id);let t=`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_customer/`;"organisation"===this.destination&&(t=`${this.rootUrl}customer_information/${this.locationId}/delete/`),this.axios.post(t,e).then((()=>{this.$emit("remove_customer",this.customerObject.customer_id)})).catch((e=>{this.$store.dispatch("newToast",{header:"Can't remove customer",message:`Sorry, could not remove customer. Error -> ${e}`,extra_classes:"bg-warning text-dark",delay:0})})),this.closeModal()}}};var I=o(6262);const E=(0,I.A)(S,[["render",function(e,t,o,i,s,a){return(0,n.uX)(),(0,n.CE)("div",f,[(0,n.Lk)("div",v,[(0,n.Lk)("div",g,[t[2]||(t[2]=(0,n.Lk)("div",{class:"modal-header"},[(0,n.Lk)("h5",{class:"modal-title",id:"confirmCustomerRemove"}," Please confirm Customer Removal "),(0,n.Q3)(" TASK INFORMATION "),(0,n.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmCustomerRemoveButton"})],-1)),(0,n.Lk)("div",h,[(0,n.Lk)("div",y,[(0,n.Lk)("div",b,[(0,n.Lk)("a",{href:`${e.rootUrl}customer_information/${o.customerObject.customer_id}/`,target:"_blank",rel:"noopener noreferrer"},(0,r.toDisplayString)(o.customerObject.customer_first_name)+" "+(0,r.toDisplayString)(o.customerObject.customer_last_name),9,C)]),(0,n.Lk)("div",_,(0,r.toDisplayString)(o.customerObject.customer_email),1)])]),(0,n.Lk)("div",k,[(0,n.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>a.closeModal&&a.closeModal(...e))}," No "),(0,n.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>a.removeCustomer&&a.removeCustomer(...e))}," Yes ")])])])])}]]);var D=o(2243);const w={name:"CustomersListModule",components:{ConfirmCustomerRemoval:E,Icon:p.In},props:{customerResults:{type:Array,default:()=>[]}},computed:{...(0,L.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"}),defaultCustomerImage(){return`${this.staticUrl}/NearBeach/images/placeholder/people_tax.svg`}},mixins:[D.A],data:()=>({customerObject:{customer_id:0,customer_email:"",customer_first_name:"",customer_last_name:"",customer_profile_picture:""}}),emits:["remove_customer"],methods:{confirmRemoveCustomer(e){const t=this.customerResults.filter((t=>parseInt(t.pk)===parseInt(e)));1===t.length?(this.customerObject=t.map((e=>({customer_id:e.pk,customer_email:e.fields.customer_email,customer_first_name:e.fields.customer_first_name,customer_last_name:e.fields.customer_last_name,customer_profile_picture:e.fields.customer_profile_picture})))[0],new m.aF(document.getElementById("confirmCustomerRemoveModal")).show()):this.$store.dispatch("newToast",{header:"Error Deleting Customer",message:"Could not select the correct ID of the customer. Something went wrong",extra_classes:"bg-danger",delay:0})},getCustomerImage(e){const t=e.fields.customer_profile_picture;return""===t||null===t?this.defaultCustomerImage:`${this.rootUrl}private/${t}`},removeCustomer(e){this.$emit("remove_customer",e)}}},R=(0,I.A)(w,[["render",function(e,t,o,m,p,f){const v=(0,n.g2)("Icon"),g=(0,n.g2)("confirm-customer-removal");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",i,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.customerResults,(t=>((0,n.uX)(),(0,n.CE)("div",{key:t.pk,class:"customer-card"},[(0,n.Q3)(" CUSOMER PROFILE "),(0,n.Lk)("img",{src:f.getCustomerImage(t),alt:"default profile picture"},null,8,s),(0,n.Q3)(" CUSTOMER DETAILS "),(0,n.Lk)("div",a,[(0,n.Lk)("div",c,[(0,n.Lk)("a",{href:`${e.rootUrl}customer_information/${t.pk}/`},(0,r.toDisplayString)(t.fields.customer_first_name)+" "+(0,r.toDisplayString)(t.fields.customer_last_name),9,l)]),(0,n.Lk)("div",u,[(0,n.bF)(v,{icon:e.icons.mailIcon},null,8,["icon"]),(0,n.eW)(" "+(0,r.toDisplayString)(t.fields.customer_email),1)])]),e.userLevel>=2?((0,n.uX)(),(0,n.CE)("div",d,[(0,n.bF)(v,{icon:e.icons.trashCan,onClick:e=>f.confirmRemoveCustomer(t.pk)},null,8,["icon","onClick"])])):(0,n.Q3)("v-if",!0)])))),128))]),(0,n.bF)(g,{"customer-object":p.customerObject,onRemove_customer:t[0]||(t[0]=e=>f.removeCustomer(e))},null,8,["customer-object"])],64)}]])},8045:(e,t,o)=>{o.d(t,{A:()=>v});var n=o(641),r=o(33);const i={class:"text-instructions"},s={key:0},a={class:"row submit-row"},c={class:"col-md-12"};var l=o(9336),u=o(2243),d=o(2321),m=o(559),p=o(2124);const f={name:"NotesModule",components:{Icon:d.In,ListNotes:m.A},mixins:[u.A],computed:{...(0,p.L8)({destination:"getDestination",locationId:"getLocationId",userLevel:"getUserLevel",rootUrl:"getRootUrl"}),...(0,p.L8)(["getUserExtraPermission"]),hasNotePermission(){return this.getUserExtraPermission(`${this.destination}_note`)}},methods:{createNewNote(){new l.aF(document.getElementById("newNoteModal")).show()},getNoteHistoryResults(){let e="note_list";"organisation"===this.destination&&(e="organisation_note_list"),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/${e}/`).then((e=>{this.$store.commit({type:"initNoteList",noteList:e.data})})).catch((e=>{this.$store.dispatch("newToast",{header:"Error Getting Note History",message:`Can not retrieve the note history. Error -> ${e}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.$nextTick((()=>{this.getNoteHistoryResults()}))}},v=(0,o(6262).A)(f,[["render",function(e,t,o,l,u,d){const m=(0,n.g2)("Icon"),p=(0,n.g2)("list-notes");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("h2",null,[(0,n.bF)(m,{icon:e.icons.noteAdd},null,8,["icon"]),t[1]||(t[1]=(0,n.eW)(" Note History "))]),(0,n.Lk)("p",i," The following are saved notes against this "+(0,r.toDisplayString)(e.destination)+". Add notes by clicking on the button below. ",1),(0,n.bF)(p,{destination:e.destination},null,8,["destination"]),(0,n.Q3)(" ADD NOTE HISTORY "),e.userLevel>1||d.hasNotePermission?((0,n.uX)(),(0,n.CE)("hr",s)):(0,n.Q3)("v-if",!0),(0,n.Lk)("div",a,[(0,n.Lk)("div",c,[e.userLevel>1||d.hasNotePermission?((0,n.uX)(),(0,n.CE)("button",{key:0,class:"btn btn-primary save-changes",onClick:t[0]||(t[0]=(...e)=>d.createNewNote&&d.createNewNote(...e))}," Add Note to "+(0,r.toDisplayString)(e.destination),1)):(0,n.Q3)("v-if",!0)])])])}]])},469:(e,t,o)=>{o.d(t,{A:()=>h});var n=o(641),r=o(33);const i={class:"object-card-list"},s={class:"object-card--detail"},a=["href"],c={class:"object-card--detail--link"},l={class:"object-card--detail--description"},u={class:"object-card--status"},d=["href"],m={class:"object-card--status--status"},p={class:"small-text"};var f=o(8083),v=o(2124);const g={name:"RenderObjectCard",props:{destination:{type:String,default:""},importVariables:{type:Object,default:()=>({header:"",prefix:"",id:0,title:"",status:""})},searchResults:{type:Array,default:()=>[]}},mixins:[f.A],computed:{...(0,v.L8)({rootUrl:"getRootUrl"})}},h=(0,o(6262).A)(g,[["render",function(e,t,o,f,v,g){return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("h2",null,(0,r.toDisplayString)(o.importVariables.header),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.searchResults,(t=>((0,n.uX)(),(0,n.CE)("div",{class:"object-card",key:t.pk},[(0,n.Lk)("div",s,[(0,n.Lk)("a",{href:`${e.rootUrl}${o.destination}_information/${t[o.importVariables.id]}/`},[(0,n.Lk)("div",c,(0,r.toDisplayString)(o.importVariables.prefix)+(0,r.toDisplayString)(t[o.importVariables.id]),1),(0,n.Lk)("div",l,(0,r.toDisplayString)(t[o.importVariables.title]),1)],8,a)]),(0,n.Lk)("div",u,[(0,n.Lk)("a",{href:`${e.rootUrl}${o.destination}_information/${t[o.importVariables.id]}/`},[(0,n.Lk)("div",m,(0,r.toDisplayString)(t[o.importVariables.status]),1),(0,n.Lk)("p",p,(0,r.toDisplayString)(e.getNiceDatetime(t[o.importVariables.end_date])),1)],8,d)])])))),128))])}]])}}]);